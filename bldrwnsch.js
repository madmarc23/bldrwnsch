!function(){"use strict";window.ol&&!ol.ext&&(ol.ext={});var t=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t};function e(t,e){return t>e?1:t<e?-1:0}function i(t,e,i){var n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;var o=void 0;if(i>0){for(o=1;o<n;++o)if(t[o]<e)return o-1}else if(i<0){for(o=1;o<n;++o)if(t[o]<=e)return o}else for(o=1;o<n;++o){if(t[o]==e)return o;if(t[o]<e)return t[o-1]-e<e-t[o]?o-1:o}return n-1}function n(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function o(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,o=0;o<n;o++)t[t.length]=i[o]}function r(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function s(){return!0}function a(){return!1}function l(){}window.ol&&(ol.inherits||(ol.inherits=t)),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.Element&&!Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});var h="postrender",u="movestart",c="moveend";function p(){return function(){throw new Error("Unimplemented abstract method.")}()}var f=0;function d(t){return t.ol_uid||(t.ol_uid=String(++f))}var g="6.1.0",_="propertychange",v="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1,o=arguments.length;n<o;++n){var r=arguments[n];if(null!=r)for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])}return i};function y(t){for(var e in t)delete t[e]}var m="function"==typeof Object.values?Object.values:function(t){var e=[];for(var i in t)e.push(t[i]);return e};function x(t,e,i,n,o){if(n&&n!==t&&(i=i.bind(n)),o){var r=i;i=function(){t.removeEventListener(e,i),r.apply(this,arguments)}}var s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function E(t,e,i,n){return x(t,e,i,n,!0)}function T(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),y(t))}var w,C=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}(),S=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),O=(w=function(t,e){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),b=function(t){function e(e){var i=t.call(this)||this;return i.eventTarget_=e,i.pendingRemovals_={},i.dispatching_={},i.listeners_={},i}return O(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new S(t):t,i=e.type;e.target||(e.target=this.eventTarget_||this);var n,o=this.listeners_[i];if(o){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var r=0,s=o.length;r<s;++r)if(!1===o[r].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,l);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){y(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);-1!==n&&(t in this.pendingRemovals_?(i[n]=l,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},e}(C),P={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",WHEEL:"wheel"},I=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),R=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return I(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(P.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=x(this,t[o],e);return n}return x(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=E(this,t[o],e);return n}return E(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)},e}(b);var L=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),M=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.key=i,o.oldValue=n,o}return L(e,t),e}(S),F=function(t){function e(e){var i=t.call(this)||this;return d(i),i.values_={},void 0!==e&&i.setProperties(e),i}return L(e,t),e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return v({},this.values_)},e.prototype.notify=function(t,e){var i;i=D(t),this.dispatchEvent(new M(i,t,e)),i=_,this.dispatchEvent(new M(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(R),A={};function D(t){return A.hasOwnProperty(t)?A[t]:A[t]="change:"+t}function k(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function N(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function G(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function j(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function X(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function Y(t){for(;t.lastChild;)t.removeChild(t.lastChild)}var z=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),B=function(t){function e(e){var i=t.call(this)||this;return i.element=e.element?e.element:null,i.target_=null,i.map_=null,i.listenerKeys=[],i.render=e.render?e.render:l,e.target&&i.setTarget(e.target),i}return z(e,t),e.prototype.disposeInternal=function(){X(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&X(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)T(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==l&&this.listenerKeys.push(x(t,h,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(F),K={create:function(t,e){var i;if(e=e||{},"TEXT"===t)i=document.createTextNode(e.html||""),e.parent&&e.parent.appendChild(i);else for(var n in i=document.createElement(t),/button/i.test(t)&&i.setAttribute("type","button"),e)switch(n){case"className":e.className&&e.className.trim&&i.setAttribute("class",e.className.trim());break;case"html":e.html instanceof Element?i.appendChild(e.html):void 0!==e.html&&(i.innerHTML=e.html);break;case"parent":e.parent.appendChild(i);break;case"style":this.setStyle(i,e.style);break;case"change":case"click":K.addListener(i,n,e[n]);break;case"on":for(var o in e.on)K.addListener(i,o,e.on[o]);break;case"checked":i.checked=!!e.checked;break;default:i.setAttribute(n,e[n])}return i},setHTML:function(t,e){e instanceof Element?t.appendChild(e):void 0!==e&&(t.innerHTML=e)},appendText:function(t,e){t.appendChild(document.createTextNode(e||""))},addListener:function(t,e,i){"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){t.addEventListener(e,i)}))},removeListener:function(t,e,i){"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){t.removeEventListener(e,i)}))},show:function(t){t.style.display=""},hide:function(t){t.style.display="none"},hidden:function(t){return"none"===K.getStyle(t,"display")},toggle:function(t){t.style.display="none"===t.style.display?"":"none"},setStyle:function(t,e){for(var i in e)switch(i){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":"number"==typeof e[i]?t.style[i]=e[i]+"px":t.style[i]=e[i];break;default:t.style[i]=e[i]}},getStyle:function(t,e){var i,n=(t.ownerDocument||document).defaultView;if(n&&n.getComputedStyle)e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),i=n.getComputedStyle(t,null).getPropertyValue(e);else if(t.currentStyle&&(e=e.replace(/-(\w)/g,(function(t,e){return e.toUpperCase()})),i=t.currentStyle[e],/^\d+(em|pt|%|ex)?$/i.test(i)))return function(e){var i=t.style.left,n=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft+"px",t.style.left=i,t.runtimeStyle.left=n,e}(i);return/px$/.test(i)?parseInt(i):i},outerHeight:function(t){return t.offsetHeight+K.getStyle(t,"marginBottom")},outerWidth:function(t){return t.offsetWidth+K.getStyle(t,"marginLeft")},offsetRect:function(t){var e=t.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:e.height||e.bottom-e.top,width:e.widtth||e.right-e.left}},scrollDiv:function(t,e){var i,n=!1,o=0,r=0,s="function"==typeof e.onmove?e.onmove:function(){},a=e.vertical?"pageY":"pageX",l=e.vertical?"scrollTop":"scrollLeft";t.querySelectorAll("img").forEach((function(t){t.ondragstart=function(){return!1}})),K.addListener(t,["mousedown"],(function(e){n=e[a],r=new Date,t.classList.add("ol-move")})),K.addListener(window,["mousemove"],(function(e){if(!1!==n){var h=n-e[a];t[l]+=h,(i=new Date)-r&&(o=(o+h/(i-r))/2),n=e[a],r=i,h&&s(!0)}else s(!1)})),K.addListener(window,["mouseup"],(function(e){t.classList.remove("ol-move"),(r=new Date-r)>100?o=0:r>0&&(o=((o||0)+(n-e[a])/r)/2),t[l]+=100*o,n=!1,o=0,r=0})),e.mousewheel&&!t.classList.contains("ol-touch")&&K.addListener(t,["mousewheel","DOMMouseScroll","onmousewheel"],(function(e){var i=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));return t.classList.add("ol-move"),t[l]-=30*i,!1}))}},W=function(t){var e=this;t||(t={}),null==t.typing&&(t.typing=300),this._classname=t.className||"search";var i=(t.className||"")+" ol-search"+(t.target?"":" ol-unselectable ol-control ol-collapsed"),n=K.create("DIV",{className:i+" ol-collapsed"});if(t.target||(this.button=document.createElement("BUTTON"),this.button.setAttribute("type","button"),this.button.setAttribute("title",t.label||"search"),this.button.addEventListener("click",(function(){if(n.classList.toggle("ol-collapsed"),!n.classList.contains("ol-collapsed")){n.querySelector("input.search").focus();for(var t=n.querySelectorAll("li"),i=0;i<t.length;i++)t[i].classList.remove("select");a.value||e.drawList_()}})),n.appendChild(this.button)),t.inputLabel){var o=document.createElement("LABEL");o.innerText=t.inputLabel,n.appendChild(o)}var r,s="",a=this._input=document.createElement("INPUT");a.setAttribute("type","search"),a.setAttribute("class","search"),a.setAttribute("autocomplete","off"),a.setAttribute("placeholder",t.placeholder||"Search..."),a.addEventListener("change",(function(t){e.dispatchEvent({type:"change:input",input:t,value:a.value})}));var l=function(i){var o=n.querySelector("ul.autocomplete li.select"),l=a.value;"ArrowDown"==i.key||"ArrowUp"==i.key||"Down"==i.key||"Up"==i.key?o?(o.classList.remove("select"),(o=/Down/.test(i.key)?o.nextElementSibling:o.previousElementSibling)&&o.classList.add("select")):n.querySelector("ul.autocomplete li").classList.add("select"):"input"!=i.type||l?!o||"search"!=i.type&&"Enter"!=i.key?"search"==i.type||"Enter"==i.key||s!=l&&t.typing>=0?(s=l)?(r&&clearTimeout(r),r=setTimeout((function(){if(s.length>=e.get("minLength")){var t=e.autocomplete(s,(function(t){e.drawList_(t)}));t&&e.drawList_(t)}else e.drawList_()}),t.typing)):e.drawList_():(o=n.querySelector("ul.autocomplete li"))&&o.classList.remove("select"):(n.classList.contains("ol-control")&&a.blur(),o.classList.remove("select"),s=l,e._handleSelect(e._list[o.getAttribute("data-search")])):setTimeout((function(){e.drawList_()}),200)};if(a.addEventListener("keyup",l),a.addEventListener("search",l),a.addEventListener("cut",l),a.addEventListener("paste",l),a.addEventListener("input",l),t.noCollapse||(a.addEventListener("blur",function(){setTimeout(function(){a!==document.activeElement&&(n.classList.add("ol-collapsed"),this.set("reverse",!1),n.classList.remove("ol-revers"))}.bind(this),200)}.bind(this)),a.addEventListener("focus",function(){this.get("reverse")||(n.classList.remove("ol-collapsed"),n.classList.remove("ol-revers"))}.bind(this))),n.appendChild(a),t.reverse){var h=K.create("BUTTON",{tyoe:"button",class:"ol-revers",title:"click on the map",click:function(){this.get("reverse")?this.set("reverse",!1):(this.set("reverse",!this.get("reverse")),a.focus(),n.classList.add("ol-revers"))}.bind(this)});n.appendChild(h)}var u=document.createElement("UL");u.classList.add("autocomplete"),n.appendChild(u),B.call(this,{element:n,target:t.target}),"function"==typeof t.getTitle&&(this.getTitle=t.getTitle),"function"==typeof t.autocomplete&&(this.autocomplete=t.autocomplete),this.set("copy",t.copy),this.set("minLength",t.minLength||1),this.set("maxItems",t.maxItems||10),this.set("maxHistory",t.maxHistory||t.maxItems||10),this.restoreHistory(),this.drawList_()};function Z(t,e,i){return Math.min(Math.max(t,e),i)}t(W,B),W.prototype.setMap=function(t){this._listener&&function(t){if(Array.isArray(t))for(var e=0,i=t.length;e<i;++e)T(t[e]);else T(t)}(this._listener),this._listener=null,B.prototype.setMap.call(this,t),t&&(this._listener=t.on("click",this._handleClick.bind(this)))},W.prototype.getInputField=function(){return this._input},W.prototype.getTitle=function(t){return t.name||"No title"},W.prototype.search=function(){var t=this.element.querySelector("input.search");this._triggerCustomEvent("search",t)},W.prototype._handleClick=function(t){this.get("reverse")&&(document.activeElement.blur(),this.reverseGeocode(t.coordinate))},W.prototype.reverseGeocode=function(){},W.prototype._triggerCustomEvent=function(t,e){var i;window.CustomEvent?i=new CustomEvent(t):(i=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,{}),e.dispatchEvent(i)},W.prototype.setInput=function(t,e){var i=this.element.querySelector("input.search");i.value=t,e&&this._triggerCustomEvent("keyup",i)},W.prototype.select=function(t,e){this.dispatchEvent({type:"select",search:t,reverse:!!e})},W.prototype._handleSelect=function(t,e){if(t){var i,n=this.get("history");try{var o=JSON.stringify(t);for(i=n.length-1;i>=0;i--)n[i]&&JSON.stringify(n[i])!==o||n.splice(i,1)}catch(e){for(i=n.length-1;i>=0;i--)n[i]===t&&n.splice(i,1)}for(n.unshift(t);n.length>(this.get("maxHistory")||10);)n.pop();this.saveHistory(),this.select(t,e)}},W.prototype._history={},W.prototype.saveHistory=function(){if(this.get("maxHistory")>=0)try{localStorage["ol@search-"+this._classname]=JSON.stringify(this.get("history"))}catch(t){}else localStorage.removeItem("ol@search-"+this._classname)},W.prototype.restoreHistory=function(){if(this._history[this._classname])this.set("history",this._history[this._classname]);else try{this._history[this._classname]=JSON.parse(localStorage["ol@search-"+this._classname]),this.set("history",this._history[this._classname])}catch(t){this.set("history",[])}},W.prototype.clearHistory=function(){this.set("history",[]),this.saveHistory(),this.drawList_()},W.prototype.getHistory=function(){return this.get("history")},W.prototype.autocomplete=function(t,e){return e([]),!1},W.prototype.drawList_=function(t){var e=this,i=this.element.querySelector("ul.autocomplete");if(i.innerHTML="",this._list=[],t)i.setAttribute("class","autocomplete");else{if(this.element.querySelector("input.search").value)return;t=this.get("history"),i.setAttribute("class","autocomplete history")}for(var n,o=Math.min(e.get("maxItems"),t.length),r=0;r<o;r++)if(t[r]&&(!r||!e.equalFeatures(t[r],t[r-1]))){(n=document.createElement("LI")).setAttribute("data-search",this._list.length),this._list.push(t[r]),n.addEventListener("click",(function(t){e._handleSelect(e._list[t.currentTarget.getAttribute("data-search")])}));var s=e.getTitle(t[r]);s instanceof Element?n.appendChild(s):n.innerHTML=s,i.appendChild(n)}o&&this.get("copy")&&((n=document.createElement("LI")).classList.add("copy"),n.innerHTML=this.get("copy"),i.appendChild(n))},W.prototype.equalFeatures=function(){return!1};var V="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function U(t,e,i,n,o,r){var s=o-i,a=r-n;if(0!==s||0!==a){var l=((t-i)*s+(e-n)*a)/(s*s+a*a);l>1?(i=o,n=r):l>0&&(i+=s*l,n+=a*l)}return H(t,e,i,n)}function H(t,e,i,n){var o=i-t,r=n-e;return o*o+r*r}function q(t){return t*Math.PI/180}function J(t,e){var i=t%e;return i*e<0?i+e:i}function Q(t,e,i){return t+i*(e-t)}var $={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},tt=6371008.8;
/**
   * @license
   * Latitude/longitude spherical geodesy formulae taken from
   * http://www.movable-type.co.uk/scripts/latlong.html
   * Licensed under CC-BY-3.0.
   */function et(t,e,i){var n=i||tt,o=q(t[1]),r=q(e[1]),s=(r-o)/2,a=q(e[0]-t[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(o)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}var it=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),nt=function(t){function e(e){var i=this,n="Assertion failed. See https://openlayers.org/en/"+("v"+g.split("-")[0])+"/doc/errors/#"+e+" for details.";return(i=t.call(this,n)||this).code=e,i.name="AssertionError",i.message=n,i}return it(e,t),e}(Error);function ot(t,e){if(!t)throw new nt(e)}var rt={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},st={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function at(t){for(var e=gt(),i=0,n=t.length;i<n;++i)wt(e,t[i]);return e}function lt(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function ht(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function ut(t,e,i){var n,o;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(o=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*o}function ct(t,e){return ft(t,e[0],e[1])}function pt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function ft(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function dt(t,e){var i=t[0],n=t[1],o=t[2],r=t[3],s=e[0],a=e[1],l=st.UNKNOWN;return s<i?l|=st.LEFT:s>o&&(l|=st.RIGHT),a<n?l|=st.BELOW:a>r&&(l|=st.ABOVE),l===st.UNKNOWN&&(l=st.INTERSECTING),l}function gt(){return[1/0,1/0,-1/0,-1/0]}function _t(t,e,i,n,o){return o?(o[0]=t,o[1]=e,o[2]=i,o[3]=n,o):[t,e,i,n]}function vt(t){return _t(1/0,1/0,-1/0,-1/0,t)}function yt(t,e){var i=t[0],n=t[1];return _t(i,n,i,n,e)}function mt(t,e){return function(t,e){for(var i=0,n=e.length;i<n;++i)wt(t,e[i]);return t}(vt(e),t)}function xt(t,e,i,n,o){return Ct(vt(o),t,e,i,n)}function Et(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Tt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function wt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Ct(t,e,i,n,o){for(;i<n;i+=o)St(t,e[i],e[i+1]);return t}function St(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function Ot(t){var e=0;return Gt(t)||(e=kt(t)*Mt(t)),e}function bt(t){return[t[0],t[1]]}function Pt(t){return[t[2],t[1]]}function It(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Rt(t,e){var i;return e===rt.BOTTOM_LEFT?i=bt(t):e===rt.BOTTOM_RIGHT?i=Pt(t):e===rt.TOP_LEFT?i=At(t):e===rt.TOP_RIGHT?i=Dt(t):ot(!1,13),i}function Lt(t,e,i,n,o){var r=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),l=Math.sin(i),h=r*a,u=r*l,c=s*a,p=s*l,f=t[0],d=t[1],g=f-h+p,_=f-h-p,v=f+h-p,y=f+h+p,m=d-u-c,x=d-u+c,E=d+u+c,T=d+u-c;return _t(Math.min(g,_,v,y),Math.min(m,x,E,T),Math.max(g,_,v,y),Math.max(m,x,E,T),o)}function Mt(t){return t[3]-t[1]}function Ft(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return Nt(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):vt(n),n}function At(t){return[t[0],t[3]]}function Dt(t){return[t[2],t[3]]}function kt(t){return t[2]-t[0]}function Nt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Gt(t){return t[2]<t[0]||t[3]<t[1]}function jt(t,e,i){var n=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(n,n,2),function(t,e,i){return _t(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}([n[0],n[2],n[4],n[6]],[n[1],n[3],n[5],n[7]],i)}var Xt={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Yt={};Yt[Xt.DEGREES]=2*Math.PI*6370997/360,Yt[Xt.FEET]=.3048,Yt[Xt.METERS]=1,Yt[Xt.USFEET]=1200/3937;var zt=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Yt[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}(),Bt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Kt=6378137,Wt=Math.PI*Kt,Zt=[-Wt,-Wt,Wt,Wt],Vt=[-180,-85,180,85],Ut=function(t){function e(e){return t.call(this,{code:e,units:Xt.METERS,extent:Zt,global:!0,worldExtent:Vt,getPointResolution:function(t,e){return t/V(e[1]/Kt)}})||this}return Bt(e,t),e}(zt),Ht=[new Ut("EPSG:3857"),new Ut("EPSG:102100"),new Ut("EPSG:102113"),new Ut("EPSG:900913"),new Ut("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Ut("urn:ogc:def:crs:EPSG::3857"),new Ut("http://www.opengis.net/gml/srs/epsg.xml#3857")];function qt(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var s=Wt,a=0;a<n;a+=o){r[a]=s*t[a]/180;var l=Kt*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));l>s?l=s:l<-s&&(l=-s),r[a+1]=l}return r}function Jt(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var s=0;s<n;s+=o)r[s]=180*t[s]/Wt,r[s+1]=360*Math.atan(Math.exp(t[s+1]/Kt))/Math.PI-90;return r}var Qt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$t=[-180,-90,180,90],te=6378137*Math.PI/180,ee=function(t){function e(e,i){return t.call(this,{code:e,units:Xt.DEGREES,extent:$t,axisOrientation:i,global:!0,metersPerUnit:te,worldExtent:$t})||this}return Qt(e,t),e}(zt),ie=[new ee("CRS:84"),new ee("EPSG:4326","neu"),new ee("urn:ogc:def:crs:EPSG::4326","neu"),new ee("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new ee("urn:ogc:def:crs:OGC:1.3:CRS84"),new ee("urn:ogc:def:crs:OGC:2:84"),new ee("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ee("urn:x-ogc:def:crs:EPSG:4326","neu")],ne={};function oe(t,e,i){var n=t.getCode(),o=e.getCode();n in ne||(ne[n]={}),ne[n][o]=i}var re={};function se(t,e,i){var n;if(void 0!==e){for(var o=0,r=t.length;o<r;++o)e[o]=t[o];n=e}else n=t.slice();return n}function ae(t,e,i){if(void 0!==e&&t!==e){for(var n=0,o=t.length;n<o;++n)e[n]=t[n];t=e}return t}function le(t){!function(t,e){re[t]=e}(t.getCode(),t),oe(t,t,se)}function he(t){return"string"==typeof t?re[t]||null:t||null}function ue(t,e,i,n){var o,r=(t=he(t)).getPointResolutionFunc();if(r)o=r(e,i),n&&n!==t.getUnits()&&(s=t.getMetersPerUnit())&&(o=o*s/Yt[n]);else if(t.getUnits()==Xt.DEGREES&&!n||n==Xt.DEGREES)o=e;else{var s,a=ge(t,he("EPSG:4326")),l=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];o=(et((l=a(l,l,2)).slice(0,2),l.slice(2,4))+et(l.slice(4,6),l.slice(6,8)))/2,void 0!==(s=n?Yt[n]:t.getMetersPerUnit())&&(o/=s)}return o}function ce(t){!function(t){t.forEach(le)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&oe(e,t,se)}))}))}function pe(t,e){return t?"string"==typeof t?he(t):t:he(e)}function fe(t,e){var i=ve(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=i[0];return(n<-180||n>180)&&(i[0]=J(n+180,360)-180),i}function de(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?i:ge(t,e)===se&&i}function ge(t,e){var i=function(t,e){var i;return t in ne&&e in ne[t]&&(i=ne[t][e]),i}(t.getCode(),e.getCode());return i||(i=ae),i}function _e(t,e){return ge(he(t),he(e))}function ve(t,e,i){return _e(e,i)(t,void 0,t.length)}function ye(t,e,i){return jt(t,_e(e,i))}var me,xe,Ee,Te=null;function we(){return Te}function Ce(t,e){return Te?ve(t,e,Te):t}function Se(t,e){return Te?ve(t,Te,e):t}function Oe(t,e){return Te?ye(t,Te,e):t}ce(Ht),ce(ie),me=Ht,xe=qt,Ee=Jt,ie.forEach((function(t){me.forEach((function(e){oe(t,e,xe),oe(e,t,Ee)}))}));var be=function(t){t=t||{},F.call(this),this._auth=t.auth,this.set("dataType",t.dataType||"JSON")};t(be,F),be.get=function(t){var e=new be(t);t.success&&e.on("success",(function(e){t.success(e.response,e)})),t.error&&e.on("error",(function(e){t.error(e)})),e.send(t.url,t.data,t.options)},be.prototype.send=function(t,e,i){var n=this,o=!1!==(i=i||{}).encode;o&&(t=encodeURI(t));var r="";for(var s in e)e.hasOwnProperty(s)&&void 0!==e[s]&&(r+=(r?"&":"?")+s+"="+(o?encodeURIComponent(e[s]):e[s]));this._request&&!1!==i.abort&&this._request.abort();var a=this._request=new XMLHttpRequest;a.open("GET",t+r,!0),this._auth&&a.setRequestHeader("Authorization","Basic "+this._auth),this.dispatchEvent({type:"loadstart"}),a.onload=function(){if(n._request=null,n.dispatchEvent({type:"loadend"}),this.status>=200&&this.status<400){var t;try{switch(n.get("dataType")){case"JSON":t=JSON.parse(this.response);break;default:t=this.response}}catch(t){return void n.dispatchEvent({type:"error",status:0,statusText:"parsererror",error:t,options:i,jqXHR:this})}n.dispatchEvent({type:"success",response:t,status:this.status,statusText:this.statusText,options:i,jqXHR:this})}else n.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:i,jqXHR:this})},a.onerror=function(){n._request=null,n.dispatchEvent({type:"loadend"}),n.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:i,jqXHR:this})},a.send()};var Pe=function(t){(t=t||{}).className=t.className||"JSON",delete t.autocomplete,t.minLength=t.minLength||3,t.typing=t.typing||800,W.call(this,t);var e=t.url||"";if("https:"===window.location.protocol){var i=document.createElement("a");i.href=e,i.protocol=window.location.protocol,e=i.href}this.set("url",e),this._ajax=new be({dataType:"JSON",auth:t.authentication}),this._ajax.on("success",function(t){t.status>=200&&t.status<400?"function"==typeof this._callback&&this._callback(t.response):console.log("AJAX ERROR",arguments)}.bind(this)),this._ajax.on("error",function(){console.log("AJAX ERROR",arguments)}.bind(this)),this._ajax.on("loadstart",function(){this.element.classList.add("searching")}.bind(this)),this._ajax.on("loadend",function(){this.element.classList.remove("searching")}.bind(this)),"function"==typeof t.handleResponse&&(this.handleResponse=t.handleResponse)};t(Pe,W),Pe.prototype.ajax=function(t,e,i,n){n=n||{},this._callback=i,this._ajax.set("dataType",n.dataType||"JSON"),this._ajax.send(t,e,n)},Pe.prototype.autocomplete=function(t,e){var i=this.requestData(t),n=encodeURI(this.get("url"));this.ajax(n,i,(function(t){"function"==typeof e&&e(this.handleResponse(t))}))},Pe.prototype.requestData=function(t){return{q:t}},Pe.prototype.handleResponse=function(t){return t};var Ie=function(t){(t=t||{}).className=t.className||"nominatim",t.typing=t.typing||500,t.url=t.url||"https://nominatim.openstreetmap.org/search",t.copy='<a href="http://www.openstreetmap.org/copyright" target="new">&copy; OpenStreetMap contributors</a>',Pe.call(this,t),this.set("polygon",t.polygon),this.set("viewbox",t.viewbox),this.set("bounded",t.bounded)};t(Ie,Pe),Ie.prototype.getTitle=function(t){var e=[];t.class&&e.push(t.class),t.type&&e.push(t.type);var i=t.display_name+(e.length?"<i>"+e.join(" - ")+"</i>":"");return t.icon&&(i="<img src='"+t.icon+"' />"+i),i},Ie.prototype.requestData=function(t){var e={format:"json",addressdetails:1,q:t,polygon_geojson:this.get("polygon")?1:0,bounded:this.get("bounded")?1:0,limit:this.get("maxItems")};return this.get("viewbox")&&(e.viewbox=this.get("viewbox")),e},Ie.prototype.select=function(t){var e=[Number(t.lon),Number(t.lat)];try{e=ve(e,"EPSG:4326",this.getMap().getView().getProjection())}catch(t){}this.dispatchEvent({type:"select",search:t,coordinate:e})},Ie.prototype.reverseGeocode=function(t,e){var i=ve(t,this.getMap().getView().getProjection(),"EPSG:4326");this.ajax(this.get("url").replace("search","reverse"),{lon:i[0],lat:i[1],format:"json"},function(t){e?e.call(this,[t]):this._handleSelect(t,!0)}.bind(this))};var Re={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"},Le="ol-hidden",Me="ol-selectable",Fe="ol-unselectable",Ae="ol-control",De="ol-collapsed",ke=function(){var t,e={};return function(i){if(t||(t=document.createElement("div").style),!(i in e)){t.font=i;var n=t.fontFamily,o=t.fontWeight,r=t.fontStyle;if(t.font="",!n)return null;var s=n.split(/,\s?/);e[i]={families:s,weight:o,style:r}}return e[i]}}(),Ne=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ge={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},je=function(t){function e(e){var i=t.call(this)||this;return i.options=e,i.id=e.id,i.insertFirst=void 0===e.insertFirst||e.insertFirst,i.stopEvent=void 0===e.stopEvent||e.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==e.className?e.className:"ol-overlay-container "+Me,i.element.style.position="absolute",i.autoPan=void 0!==e.autoPan&&e.autoPan,i.autoPanAnimation=e.autoPanAnimation||{},i.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,i.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},i.mapPostrenderListenerKey=null,i.addEventListener(D(Ge.ELEMENT),i.handleElementChanged),i.addEventListener(D(Ge.MAP),i.handleMapChanged),i.addEventListener(D(Ge.OFFSET),i.handleOffsetChanged),i.addEventListener(D(Ge.POSITION),i.handlePositionChanged),i.addEventListener(D(Ge.POSITIONING),i.handlePositioningChanged),void 0!==e.element&&i.setElement(e.element),i.setOffset(void 0!==e.offset?e.offset:[0,0]),i.setPositioning(void 0!==e.positioning?e.positioning:Re.TOP_LEFT),void 0!==e.position&&i.setPosition(e.position),i}return Ne(e,t),e.prototype.getElement=function(){return this.get(Ge.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(Ge.MAP)},e.prototype.getOffset=function(){return this.get(Ge.OFFSET)},e.prototype.getPosition=function(){return this.get(Ge.POSITION)},e.prototype.getPositioning=function(){return this.get(Ge.POSITIONING)},e.prototype.handleElementChanged=function(){Y(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(X(this.element),T(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=x(t,h,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(Ge.POSITION)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(Ge.ELEMENT,t)},e.prototype.setMap=function(t){this.set(Ge.MAP,t)},e.prototype.setOffset=function(t){this.set(Ge.OFFSET,t)},e.prototype.setPosition=function(t){this.set(Ge.POSITION,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[N(i),G(i)]),o=this.autoPanMargin;if(!pt(e,n)){var r=n[0]-e[0],s=e[2]-n[2],a=n[1]-e[1],l=e[3]-n[3],h=[0,0];if(r<0?h[0]=r-o:s<0&&(h[0]=Math.abs(s)+o),a<0?h[1]=a-o:l<0&&(h[1]=Math.abs(l)+o),0!==h[0]||0!==h[1]){var u=t.getView().getCenterInternal(),c=t.getPixelFromCoordinateInternal(u),p=[c[0]+h[0],c[1]+h[1]];t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(p),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,o=i.top+window.pageYOffset;return[n,o,n+e[0],o+e[1]]},e.prototype.setPositioning=function(t){this.set(Ge.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),o=this.getPositioning();this.setVisible(!0);var r=n[0],s=n[1];if(o==Re.BOTTOM_RIGHT||o==Re.CENTER_RIGHT||o==Re.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var a=Math.round(e[0]-t[0]-r)+"px";this.rendered.right_!=a&&(this.rendered.right_=i.right=a)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),o!=Re.BOTTOM_CENTER&&o!=Re.CENTER_CENTER&&o!=Re.TOP_CENTER||(r-=this.element.offsetWidth/2);var l=Math.round(t[0]+r)+"px";this.rendered.left_!=l&&(this.rendered.left_=i.left=l)}if(o==Re.BOTTOM_LEFT||o==Re.BOTTOM_CENTER||o==Re.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var h=Math.round(e[1]-t[1]-s)+"px";this.rendered.bottom_!=h&&(this.rendered.bottom_=i.bottom=h)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),o!=Re.CENTER_LEFT&&o!=Re.CENTER_CENTER&&o!=Re.CENTER_RIGHT||(s-=this.element.offsetHeight/2);var u=Math.round(t[1]+s)+"px";this.rendered.top_!=u&&(this.rendered.top_=i.top=u)}},e.prototype.getOptions=function(){return this.options},e}(F),Xe=function(t){var e=this;"number"==typeof(t=t||{}).offsetBox?this.offsetBox=[t.offsetBox,t.offsetBox,t.offsetBox,t.offsetBox]:this.offsetBox=t.offsetBox;var i=document.createElement("div");t.element=i;var n=document.createElement("div");n.classList.add("anchor"),i.appendChild(n),this.content=K.create("div",{html:t.html||"",className:"ol-popup-content",parent:i}),this.closeBox=t.closeBox,this.onclose=t.onclose,this.onshow=t.onshow;var o=document.createElement("button");o.classList.add("closeBox"),t.closeBox&&o.classList.add("hasclosebox"),o.setAttribute("type","button"),i.insertBefore(o,n),o.addEventListener("click",(function(){e.hide()})),t.stopEvent&&(i.addEventListener("mousedown",(function(t){t.stopPropagation()})),i.addEventListener("touchstart",(function(t){t.stopPropagation()}))),je.call(this,t),this._elt=this.element,this.setPositioning(t.positioning||"auto"),this.setPopupClass(t.popupClass||t.className||"default"),t.position&&setTimeout(function(){this.show(t.position)}.bind(this))};t(Xe,je),Xe.prototype.getClassPositioning=function(){var t="",e=this.getPositioning();return/bottom/.test(e)&&(t+="ol-popup-bottom "),/top/.test(e)&&(t+="ol-popup-top "),/left/.test(e)&&(t+="ol-popup-left "),/right/.test(e)&&(t+="ol-popup-right "),/^center/.test(e)&&(t+="ol-popup-middle "),/center$/.test(e)&&(t+="ol-popup-center "),t},Xe.prototype.setClosebox=function(t){this.closeBox=t,t?this._elt.classList.add("hasclosebox"):this._elt.classList.remove("hasclosebox")},Xe.prototype.setPopupClass=function(t){this._elt.className="";var e=this.getClassPositioning().split(" ").filter((function(t){return t.length>0})),i=["ol-popup"];t?t.split(" ").filter((function(t){return t.length>0})).forEach((function(t){i.push(t)})):i.push("default"),e.forEach((function(t){i.push(t)})),this.closeBox&&i.push("hasclosebox"),this._elt.classList.add.apply(this._elt.classList,i)},Xe.prototype.addPopupClass=function(t){this._elt.classList.add(t)},Xe.prototype.removePopupClass=function(t){this._elt.classList.remove(t)},Xe.prototype.setPositioning=function(t){void 0!==t&&(/auto/.test(t)?(this.autoPositioning=t.split("-"),1==this.autoPositioning.length&&(this.autoPositioning[1]="auto")):this.autoPositioning=!1,"center"==(t=t.replace(/auto/g,"center"))&&(t="bottom-center"),this.setPositioning_(t))},Xe.prototype.setPositioning_=function(t){if(this._elt){je.prototype.setPositioning.call(this,t),this._elt.classList.remove("ol-popup-top","ol-popup-bottom","ol-popup-left","ol-popup-right","ol-popup-center","ol-popup-middle");var e=this.getClassPositioning().split(" ").filter((function(t){return t.length>0}));this._elt.classList.add.apply(this._elt.classList,e)}},Xe.prototype.getVisible=function(){return this._elt.classList.contains("visible")},Xe.prototype.show=function(t,e){e||"string"!=typeof t||(e=t,t=null),!0===t&&(t=this.getPosition());var i=this,n=this.getMap();if(n&&(e&&e!==this.prevHTML&&(this.prevHTML=e,this.content.innerHTML="",e instanceof Element?this.content.appendChild(e):this.content.insertAdjacentHTML("beforeend",e),Array.prototype.slice.call(this.content.querySelectorAll("img")).forEach((function(t){t.addEventListener("load",(function(){n.renderSync()}))}))),t)){if(this.autoPositioning){var o=n.getPixelFromCoordinate(t),r=n.getSize(),s=[];"auto"==this.autoPositioning[0]?s[0]=o[1]<r[1]/3?"top":"bottom":s[0]=this.autoPositioning[0],s[1]=o[0]<2*r[0]/3?"left":"right",this.setPositioning_(s[0]+"-"+s[1]),this.offsetBox&&this.setOffset([this.offsetBox["left"==s[1]?2:0],this.offsetBox["top"==s[0]?3:1]])}else this.offsetBox&&this.setOffset(this.offsetBox);this.setPosition(t),this._elt.parentElement.style.display="","function"==typeof this.onshow&&this.onshow(),this._tout=setTimeout((function(){i._elt.classList.add("visible")}),0)}},Xe.prototype.hide=function(){null!=this.getPosition()&&("function"==typeof this.onclose&&this.onclose(),this.setPosition(void 0),this._tout&&clearTimeout(this._tout),this._elt.classList.remove("visible"))};var Ye={ADD:"add",REMOVE:"remove"},ze=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Be="length",Ke=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.element=i,o.index=n,o}return ze(e,t),e}(S),We=function(t){function e(e,i){var n=t.call(this)||this,o=i||{};if(n.unique_=!!o.unique,n.array_=e||[],n.unique_)for(var r=0,s=n.array_.length;r<s;++r)n.assertUnique_(n.array_[r],r);return n.updateLength_(),n}return ze(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Be)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ke(Ye.ADD,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ke(Ye.REMOVE,e,t)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ke(Ye.REMOVE,n,t)),this.dispatchEvent(new Ke(Ye.ADD,e,t))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Be,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new nt(58)},e}(F),Ze=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ve=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.map=i,o.frameState=void 0!==n?n:null,o}return Ze(e,t),e}(S),Ue=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),He=function(t){function e(e,i,n,o,r){var s=t.call(this,e,i,r)||this;return s.originalEvent=n,s.pixel_=null,s.coordinate_=null,s.dragging=void 0!==o&&o,s}return Ue(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Ve);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;!function(t,e){t(e={exports:{}},e.exports)}((function(t,e){
/*!
   * PEP v0.5.3 | https://github.com/jquery/PEP
   * Copyright jQuery Foundation and other contributors | http://jquery.org/license
   */
t.exports=function(){var t=["bubbles","cancelable","view","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],e=[!1,!1,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function i(i,n){n=n||Object.create(null);var o=document.createEvent("Event");o.initEvent(i,n.bubbles||!1,n.cancelable||!1);for(var r,s=2;s<t.length;s++)o[r=t[s]]=n[r]||e[s];o.buttons=n.buttons||0;var a=0;return a=void 0!==n.pressure&&o.buttons?n.pressure:o.buttons?.5:0,o.x=o.clientX,o.y=o.clientY,o.pointerId=n.pointerId||0,o.width=n.width||1,o.height=n.height||1,o.pressure=a,o.tiltX=n.tiltX||0,o.tiltY=n.tiltY||0,o.twist=n.twist||0,o.tangentialPressure=n.tangentialPressure||0,o.pointerType=n.pointerType||"",o.hwTimestamp=n.hwTimestamp||0,o.isPrimary=n.isPrimary||!1,o.detail=0,o}var n=window.Map&&window.Map.prototype.forEach?Map:o;function o(){this.array=[],this.size=0}o.prototype={set:function(t,e){if(void 0===e)return this.delete(t);this.has(t)||this.size++,this.array[t]=e},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach((function(i,n){t.call(e,i,n,this)}),this)}};var r=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],s=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],a={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},l="undefined"!=typeof SVGElementInstance,h={pointermap:new n,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(t,e){var i=e,n=i.events;n&&(n.forEach((function(t){i[t]&&(this.eventMap[t]=i[t].bind(i))}),this),this.eventSources[t]=i,this.eventSourceList.push(i))},register:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.register.call(e,t)},unregister:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.unregister.call(e,t)},contains:function(t,e){try{return t.contains(e)}catch(t){return!1}},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.propagate(t,this.leave,!1)},enterOver:function(t){this.over(t),this.propagate(t,this.enter,!0)},eventHandler:function(t){if(!t._handledByPE){var e=t.type,i=this.eventMap&&this.eventMap[e];i&&i(t),t._handledByPE=!0}},listen:function(t,e){e.forEach((function(e){this.addEvent(t,e)}),this)},unlisten:function(t,e){e.forEach((function(e){this.removeEvent(t,e)}),this)},addEvent:function(t,e){t.addEventListener(e,this.boundHandler)},removeEvent:function(t,e){t.removeEventListener(e,this.boundHandler)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var n=new i(t,e);return e.preventDefault&&(n.preventDefault=e.preventDefault),n._target=n._target||e.target,n},fireEvent:function(t,e){var i=this.makeEvent(t,e);return this.dispatchEvent(i)},cloneEvent:function(t){for(var e,i=Object.create(null),n=0;n<r.length;n++)i[e=r[n]]=t[e]||s[n],!l||"target"!==e&&"relatedTarget"!==e||i[e]instanceof SVGElementInstance&&(i[e]=i[e].correspondingUseElement);return t.preventDefault&&(i.preventDefault=function(){t.preventDefault()}),i},getTarget:function(t){var e=this.captureInfo[t.pointerId];return e?t._target!==e&&t.type in a?void 0:e:t._target},propagate:function(t,e,i){for(var n=t.target,o=[];null!=n&&n!==document&&!n.contains(t.relatedTarget);)if(o.push(n),!(n=n.parentNode))return;i&&o.reverse(),o.forEach((function(i){t.target=i,e.call(this,t)}),this)},setCapture:function(t,e,n){this.captureInfo[t]&&this.releaseCapture(t,n),this.captureInfo[t]=e,this.implicitRelease=this.releaseCapture.bind(this,t,n),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var o=new i("gotpointercapture",{bubbles:!0});o.pointerId=t,o._target=e,n||this.asyncDispatchEvent(o)},releaseCapture:function(t,e){var n=this.captureInfo[t];if(n){this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var o=new i("lostpointercapture",{bubbles:!0});o.pointerId=t,o._target=n,e||this.asyncDispatchEvent(o)}},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return e.dispatchEvent(t)},asyncDispatchEvent:function(t){requestAnimationFrame(this.dispatchEvent.bind(this,t))}};h.boundHandler=h.eventHandler.bind(h);var u={shadow:function(t){if(t)return t.shadowRoot||t.webkitShadowRoot},canTarget:function(t){return t&&Boolean(t.elementFromPoint)},targetingShadow:function(t){var e=this.shadow(t);if(this.canTarget(e))return e},olderShadow:function(t){var e=t.olderShadowRoot;if(!e){var i=t.querySelector("shadow");i&&(e=i.olderShadowRoot)}return e},allShadows:function(t){for(var e=[],i=this.shadow(t);i;)e.push(i),i=this.olderShadow(i);return e},searchRoot:function(t,e,i){if(t){var n,o,r=t.elementFromPoint(e,i);for(o=this.targetingShadow(r);o;){if(n=o.elementFromPoint(e,i)){var s=this.targetingShadow(n);return this.searchRoot(s,e,i)||n}o=this.olderShadow(o)}return r}},owner:function(t){for(var e=t;e.parentNode;)e=e.parentNode;return e.nodeType!==Node.DOCUMENT_NODE&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(e=document),e},findTarget:function(t){var e=t.clientX,i=t.clientY,n=this.owner(t.target);return n.elementFromPoint(e,i)||(n=document),this.searchRoot(n,e,i)}},c=Array.prototype.forEach.call.bind(Array.prototype.forEach),p=Array.prototype.map.call.bind(Array.prototype.map),f=Array.prototype.slice.call.bind(Array.prototype.slice),d=Array.prototype.filter.call.bind(Array.prototype.filter),g=window.MutationObserver||window.WebKitMutationObserver,_={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function v(t,e,i,n){this.addCallback=t.bind(n),this.removeCallback=e.bind(n),this.changedCallback=i.bind(n),g&&(this.observer=new g(this.mutationWatcher.bind(this)))}function y(t){return"{ -ms-touch-action: "+t+"; touch-action: "+t+"; }"}v.prototype={watchSubtree:function(t){this.observer&&u.canTarget(t)&&this.observer.observe(t,_)},enableOnSubtree:function(t){this.watchSubtree(t),t===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(t)},installNewSubtree:function(t){c(this.findElements(t),this.addElement,this)},findElements:function(t){return t.querySelectorAll?t.querySelectorAll("[touch-action]"):[]},removeElement:function(t){this.removeCallback(t)},addElement:function(t){this.addCallback(t)},elementChanged:function(t,e){this.changedCallback(t,e)},concatLists:function(t,e){return t.concat(f(e))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(t){return t.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(t){var e=p(t,this.findElements,this);return e.push(d(t,this.isElement)),e.reduce(this.concatLists,[])},mutationWatcher:function(t){t.forEach(this.mutationHandler,this)},mutationHandler:function(t){"childList"===t.type?(this.flattenMutationTree(t.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(t.removedNodes).forEach(this.removeElement,this)):"attributes"===t.type&&this.elementChanged(t.target,t.oldValue)}};var m=[{selector:'[touch-action="none"]',value:"none"},{selector:'[touch-action="auto"]',value:"auto"},{selector:'[touch-action~="pan-x"]',value:"pan-x"},{selector:'[touch-action~="pan-y"]',value:"pan-y"},{selector:'[touch-action~="pan-up"]',value:"pan-up"},{selector:'[touch-action~="pan-down"]',value:"pan-down"},{selector:'[touch-action~="pan-left"]',value:"pan-left"},{selector:'[touch-action~="pan-right"]',value:"pan-right"}],x="",E=window.PointerEvent||window.MSPointerEvent,T=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,w=h.pointermap,C=[1,4,2,8,16],S=!1;try{S=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}var O,b={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout"],register:function(t){h.listen(t,this.events)},unregister:function(t){h.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,i=this.lastTouches,n=t.clientX,o=t.clientY,r=0,s=i.length;r<s&&(e=i[r]);r++){var a=Math.abs(n-e.x),l=Math.abs(o-e.y);if(a<=25&&l<=25)return!0}},prepareEvent:function(t){var e=h.cloneEvent(t),i=e.preventDefault;return e.preventDefault=function(){t.preventDefault(),i()},e.pointerId=this.POINTER_ID,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,"webkitForce"in t&&(e.pressure=t.webkitForce-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN),e},prepareButtonsForMove:function(t,e){var i=w.get(this.POINTER_ID);0!==e.which&&i?t.buttons=i.buttons:t.buttons=0,e.buttons=t.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=w.get(this.POINTER_ID),i=this.prepareEvent(t);S||(i.buttons=C[i.button],e&&(i.buttons|=e.buttons),t.buttons=i.buttons),w.set(this.POINTER_ID,t),e&&0!==e.buttons?h.move(i):h.down(i)}},webkitmouseforcechanged:function(t){this.mousemove(t)},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);S||this.prepareButtonsForMove(e,t),e.button=-1,w.set(this.POINTER_ID,t),h.move(e)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=w.get(this.POINTER_ID),i=this.prepareEvent(t);if(!S){var n=C[i.button];i.buttons=e?e.buttons&~n:0,t.buttons=i.buttons}w.set(this.POINTER_ID,t),i.buttons&=~C[i.button],0===i.buttons?h.up(i):h.move(i)}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);S||this.prepareButtonsForMove(e,t),e.button=-1,w.set(this.POINTER_ID,t),h.enterOver(e)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);S||this.prepareButtonsForMove(e,t),e.button=-1,h.leaveOut(e)}},cancel:function(t){var e=this.prepareEvent(t);h.cancel(e),this.deactivateMouse()},deactivateMouse:function(){w.delete(this.POINTER_ID)}},P=h.captureInfo,I=u.findTarget.bind(u),R=u.allShadows.bind(u),L=h.pointermap,M={events:["touchstart","touchmove","touchforcechange","touchend","touchcancel"],register:function(t){O.enableOnSubtree(t)},unregister:function(){},elementAdded:function(t){var e=t.getAttribute("touch-action"),i=this.touchActionToScrollType(e);"number"==typeof i&&(t._scrollType=i,h.listen(t,this.events),R(t).forEach((function(t){t._scrollType=i,h.listen(t,this.events)}),this))},elementRemoved:function(t){if(L.size>0){var e=this.events;t.addEventListener("touchend",(function(){t._scrollType=void 0,h.unlisten(t,e)}))}else t._scrollType=void 0,h.unlisten(t,this.events);R(t).forEach((function(t){t._scrollType=void 0,h.unlisten(t,this.events)}),this)},elementChanged:function(t,e){var i=t.getAttribute("touch-action"),n=this.touchActionToScrollType(i),o=this.touchActionToScrollType(e);"number"==typeof n&&"number"==typeof o?(t._scrollType=n,R(t).forEach((function(t){t._scrollType=n}),this)):"number"==typeof o?this.elementRemoved(t):"number"==typeof n&&this.elementAdded(t)},scrollTypes:{UP:function(t){return t.includes("pan-y")||t.includes("pan-up")?1:0},DOWN:function(t){return t.includes("pan-y")||t.includes("pan-down")?2:0},LEFT:function(t){return t.includes("pan-x")||t.includes("pan-left")?4:0},RIGHT:function(t){return t.includes("pan-x")||t.includes("pan-right")?8:0}},touchActionToScrollType:function(t){if(t){if("auto"===t)return 15;if("none"===t)return 0;var e=t.split(" "),i=this.scrollTypes;return i.UP(e)|i.DOWN(e)|i.LEFT(e)|i.RIGHT(e)}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===L.size||1===L.size&&L.has(1))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=!1)},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstXY=null)},typeToButtons:function(t){var e=0;return"touchstart"!==t&&"touchmove"!==t&&"touchforcechange"!==t||(e=1),e},touchToPointer:function(t){var e=this.currentTouchEvent,i=h.cloneEvent(t),n=i.pointerId=t.identifier+2;if(i.target=P[n]||I(i),i.bubbles=!0,i.cancelable=!0,i.button=0,i.buttons=this.typeToButtons(e.type),i.width=2*(t.radiusX||t.webkitRadiusX||0),i.height=2*(t.radiusY||t.webkitRadiusY||0),i.pressure=void 0!==t.force?t.force:void 0!==t.webkitForce?t.webkitForce:void 0,i.isPrimary=this.isPrimaryTouch(t),t.altitudeAngle){var o=Math.tan(t.altitudeAngle),r=180/Math.PI;i.tiltX=Math.atan(Math.cos(t.azimuthAngle)/o)*r,i.tiltY=Math.atan(Math.sin(t.azimuthAngle)/o)*r}else i.tiltX=0,i.tiltY=0;"stylus"===t.touchType?i.pointerType="pen":i.pointerType=this.POINTER_TYPE,i.altKey=e.altKey,i.ctrlKey=e.ctrlKey,i.metaKey=e.metaKey,i.shiftKey=e.shiftKey;var s=this;return i.preventDefault=function(){s.scrolling=!1,s.firstXY=null,e.preventDefault()},i},processTouches:function(t,e){var i=t.changedTouches;this.currentTouchEvent=t;for(var n,o=0;o<i.length;o++)n=i[o],e.call(this,this.touchToPointer(n))},shouldScroll:function(t){if(this.firstXY){var e,i=t.currentTarget._scrollType;if(0===i)e=!1;else if(15===i)e=!0;else{var n=t.changedTouches[0],o=n.clientY-this.firstXY.Y,r=Math.abs(o),s=n.clientX-this.firstXY.X,a=Math.abs(s),l=1&i,h=2&i,u=4&i,c=8&i;u&&c?e=a>r:u?e=a>r&&s>0:c&&(e=a>r&&s<0),e||(l&&h?e=a<r:l?e=a<r&&o>0:h&&(e=a<r&&o<0))}return this.firstXY=null,e}},findTouch:function(t,e){for(var i,n=0,o=t.length;n<o&&(i=t[n]);n++)if(i.identifier===e)return!0},vacuumTouches:function(t){var e=t.touches;if(L.size>=e.length){var i=[];L.forEach((function(t,n){if(1!==n&&!this.findTouch(e,n-2)){var o=t.out;i.push(o)}}),this),i.forEach(this.cancelOut,this)}},touchstart:function(t){this.vacuumTouches(t),this.setPrimaryTouch(t.changedTouches[0]),this.dedupSynthMouse(t),this.scrolling||this.processTouches(t,this.overDown)},overDown:function(t){L.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),h.enterOver(t),h.down(t)},touchforcechange:function(t){this.touchmove(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):("touchforcechange"!==t.type&&t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=t,i=L.get(e.pointerId);if(i){var n=i.out,o=i.outTarget;h.move(e),n&&o!==e.target&&(n.relatedTarget=e.target,e.relatedTarget=o,n.target=o,e.target?(h.leaveOut(n),h.enterOver(e)):(e.target=o,e.relatedTarget=null,this.cancelOut(e))),i.out=e,i.outTarget=e.target}},touchend:function(t){this.dedupSynthMouse(t),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(h.up(t),h.leaveOut(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){h.cancel(t),h.leaveOut(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){L.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=b.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch(i)){var n={x:i.clientX,y:i.clientY};e.push(n);var o=function(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}.bind(null,e,n);setTimeout(o,2500)}}};O=new v(M.elementAdded,M.elementRemoved,M.elementChanged,M);var F,A,D,k=h.pointermap,N=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,G={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){h.listen(t,this.events)},unregister:function(t){h.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var e=t;return N&&((e=h.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},cleanup:function(t){k.delete(t)},MSPointerDown:function(t){k.set(t.pointerId,t);var e=this.prepareEvent(t);h.down(e)},MSPointerMove:function(t){var e=this.prepareEvent(t);h.move(e)},MSPointerUp:function(t){var e=this.prepareEvent(t);h.up(e),this.cleanup(t.pointerId)},MSPointerOut:function(t){var e=this.prepareEvent(t);h.leaveOut(e)},MSPointerOver:function(t){var e=this.prepareEvent(t);h.enterOver(e)},MSPointerCancel:function(t){var e=this.prepareEvent(t);h.cancel(e),this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var e=h.makeEvent("lostpointercapture",t);h.dispatchEvent(e)},MSGotPointerCapture:function(t){var e=h.makeEvent("gotpointercapture",t);h.dispatchEvent(e)}};function j(t){if(!h.pointermap.has(t)){var e=new Error("NotFoundError");throw e.name="NotFoundError",e}}function X(t){for(var e=t.parentNode;e&&e!==t.ownerDocument;)e=e.parentNode;if(!e){var i=new Error("InvalidStateError");throw i.name="InvalidStateError",i}}function Y(t){return 0!==h.pointermap.get(t).buttons}return window.navigator.msPointerEnabled?(F=function(t){j(t),X(this),Y(t)&&(h.setCapture(t,this,!0),this.msSetPointerCapture(t))},A=function(t){j(t),h.releaseCapture(t,!0),this.msReleasePointerCapture(t)}):(F=function(t){j(t),X(this),Y(t)&&h.setCapture(t,this)},A=function(t){j(t),h.releaseCapture(t)}),D=function(t){return!!h.captureInfo[t]},function(){if(E){m.forEach((function(t){x+=t.selector+y(t.value)+"\n",T&&(x+=function(t){return"body /shadow-deep/ "+t}(t.selector)+y(t.value)+"\n")}));var t=document.createElement("style");t.textContent=x,document.head.appendChild(t)}}(),function(){if(!window.PointerEvent){if(window.PointerEvent=i,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),h.registerSource("ms",G)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),h.registerSource("mouse",b),void 0!==window.ontouchstart&&h.registerSource("touch",M);h.register(document)}}(),window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:F},releasePointerCapture:{value:A},hasPointerCapture:{value:D}}),{dispatcher:h,Installer:v,PointerEvent:i,PointerMap:n,targetFinding:u}}()}));var qe="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Je=-1!==qe.indexOf("firefox"),Qe=(-1!==qe.indexOf("safari")&&qe.indexOf("chrom"),-1!==qe.indexOf("webkit")&&-1==qe.indexOf("edge")),$e=-1!==qe.indexOf("macintosh"),ti=window.devicePixelRatio||1,ei="undefined"!=typeof Image&&Image.prototype.decode,ii={SINGLECLICK:"singleclick",CLICK:P.CLICK,DBLCLICK:P.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ni=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oi=function(t){function e(e,i,n,o,r){var s=t.call(this,e,i,n,o,r)||this;return s.pointerEvent=n,s}return ni(e,t),e}(He),ri={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},si=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ai=function(t){function e(e,i){var n=t.call(this,e)||this;n.map_=e,n.clickTimeoutId_,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=i?i*ti:ti,n.down_=null;var o=n.map_.getViewport();return n.activePointers_=0,n.trackedTouches_={},n.element_=o,n.pointerdownListenerKey_=x(o,ri.POINTERDOWN,n.handlePointerDown_,n),n.relayedListenerKey_=x(o,ri.POINTERMOVE,n.relayEvent_,n),n}return si(e,t),e.prototype.emulateClick_=function(t){var e=new oi(ii.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new oi(ii.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new oi(ii.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==ii.POINTERUP||e.type==ii.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==ii.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new oi(ii.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(T),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new oi(ii.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(x(document,ii.POINTERMOVE,this.handlePointerMove_,this),x(document,ii.POINTERUP,this.handlePointerUp_,this),x(this.element_,ii.POINTERCANCEL,this.handlePointerUp_,this))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new oi(ii.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new oi(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(T(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(T(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(T),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},e}(b),li={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},hi="prerender",ui="postrender",ci="precompose",pi="postcompose",fi="rendercomplete",di={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5},gi=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,y(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},t.prototype.enqueue=function(t){ot(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,o=e[t],r=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),h=l<n&&i[l]<i[a]?l:a;e[t]=e[h],i[t]=i[h],t=h}e[t]=o,i[t]=r,this.siftDown_(s,t)},t.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,o=i[e],r=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>r))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=o,n[e]=r},t.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,o=this.elements_,r=this.priorities_,s=0,a=o.length;for(e=0;e<a;++e)(i=n(t=o[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(r[s]=i,o[s++]=t);o.length=s,r.length=s,this.heapify_()},t}(),_i=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vi=function(t){function e(e,i){var n=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return n.boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=i,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return _i(e,t),e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);i&&e[0].addEventListener(P.CHANGE,this.boundHandleTileChange_);return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(e.hifi&&i===di.LOADED||i===di.ERROR||i===di.EMPTY||i===di.ABORT){e.removeEventListener(P.CHANGE,this.boundHandleTileChange_);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,o,r=0,s=!1;this.tilesLoading_<t&&r<e&&this.getCount()>0;)o=(n=this.dequeue()[0]).getKey(),(i=n.getState())===di.ABORT?s=!0:i!==di.IDLE||o in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++r,n.load());0===r&&s&&this.tileChangeCallback_()},e}(gi),yi=42,mi=256;function xi(t,e,i){return function(n,o,r,s){if(n){var a=e?0:r[0]*o,l=e?0:r[1]*o,h=t[0]+a/2,u=t[2]-a/2,c=t[1]+l/2,p=t[3]-l/2;h>u&&(h=u=(u+h)/2),c>p&&(c=p=(p+c)/2);var f=Z(n[0],h,u),d=Z(n[1],c,p),g=30*o;return s&&i&&(f+=-g*Math.log(1+Math.max(0,h-n[0])/g)+g*Math.log(1+Math.max(0,n[0]-u)/g),d+=-g*Math.log(1+Math.max(0,c-n[1])/g)+g*Math.log(1+Math.max(0,n[1]-p)/g)),[f,d]}}}function Ei(t){return t}function Ti(t,e,i){var n=kt(e)/i[0],o=Mt(e)/i[1];return Math.min(t,Math.min(n,o))}function wi(t,e,i){var n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),Z(n,i/2,2*e)}function Ci(t,e,i,n){return function(o,r,s,a){if(void 0!==o){var l=n?Ti(t,n,s):t;return(void 0===i||i)&&a?wi(o,l,e):Z(o,e,l)}}}function Si(t){return void 0!==t?0:void 0}function Oi(t){return void 0!==t?t:void 0}var bi=0,Pi=1,Ii="center",Ri="resolution",Li="rotation";function Mi(t,e,i){return t?e.replace("{x}",t[0].toFixed(i)).replace("{y}",t[1].toFixed(i)):""}function Fi(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function Ai(t,e){var i=Math.cos(e),n=Math.sin(e),o=t[0]*i-t[1]*n,r=t[1]*i+t[0]*n;return t[0]=o,t[1]=r,t}function Di(t){return Math.pow(t,3)}function ki(t){return 1-Di(1-t)}function Ni(t){return 3*t*t-2*t*t*t}function Gi(t){return t}var ji={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};function Xi(t,e,i,n,o,r){for(var s=r||[],a=0,l=e;l<i;l+=n){var h=t[l],u=t[l+1];s[a++]=o[0]*h+o[2]*u+o[4],s[a++]=o[1]*h+o[3]*u+o[5]}return r&&s.length!=a&&(s.length=a),s}var Yi=new Array(6);function zi(t){return Ki(t,1,0,0,1,0,0)}function Bi(t,e){var i=t[0],n=t[1],o=t[2],r=t[3],s=t[4],a=t[5],l=e[0],h=e[1],u=e[2],c=e[3],p=e[4],f=e[5];return t[0]=i*l+o*h,t[1]=n*l+r*h,t[2]=i*u+o*c,t[3]=n*u+r*c,t[4]=i*p+o*f+s,t[5]=n*p+r*f+a,t}function Ki(t,e,i,n,o,r,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=o,t[4]=r,t[5]=s,t}function Wi(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function Zi(t,e,i){return Bi(t,Ki(Yi,e,0,0,i,0,0))}function Vi(t,e,i,n,o,r,s,a){var l=Math.sin(r),h=Math.cos(r);return t[0]=n*h,t[1]=o*l,t[2]=-n*l,t[3]=o*h,t[4]=s*n*h-a*n*l+e,t[5]=s*o*l+a*o*h+i,t}function Ui(t,e){var i,n=(i=e)[0]*i[3]-i[1]*i[2];ot(0!==n,32);var o=e[0],r=e[1],s=e[2],a=e[3],l=e[4],h=e[5];return t[0]=a/n,t[1]=-r/n,t[2]=-s/n,t[3]=o/n,t[4]=(s*h-a*l)/n,t[5]=-(o*h-r*l)/n,t}function Hi(t){return"matrix("+t.join(", ")+")"}var qi=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ji=[1,0,0,1,0,0],Qi=function(t){function e(){var e,i,n,o,s,a=t.call(this)||this;return a.extent_=[1/0,1/0,-1/0,-1/0],a.extentRevision_=-1,a.simplifiedGeometryMaxMinSquaredTolerance=0,a.simplifiedGeometryRevision=0,a.simplifyTransformedInternal=(e=function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)},s=!1,function(){var t=Array.prototype.slice.call(arguments);return s&&this===o&&r(t,n)||(s=!0,o=this,n=t,i=e.apply(this,arguments)),i}),a}return qi(e,t),e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},e.prototype.clone=function(){return p()},e.prototype.closestPointXY=function(t,e,i,n){return p()},e.prototype.containsXY=function(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return p()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){p()},e.prototype.scale=function(t,e,i){p()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return p()},e.prototype.getType=function(){return p()},e.prototype.applyTransform=function(t){p()},e.prototype.intersectsExtent=function(t){return p()},e.prototype.translate=function(t,e){p()},e.prototype.transform=function(t,e){var i=he(t),n=i.getUnits()==Xt.TILE_PIXELS?function(t,n,o){var r=i.getExtent(),s=i.getWorldExtent(),a=Mt(s)/Mt(r);return Vi(Ji,s[0],s[3],a,-a,0,0,0),Xi(t,0,t.length,o,Ji,n),_e(i,e)(t,n,o)}:_e(i,e);return this.applyTransform(n),this},e}(F),$i=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),tn=function(t){function e(){var e=t.call(this)||this;return e.layout=ji.XY,e.stride=2,e.flatCoordinates=null,e}return $i(e,t),e.prototype.computeExtent=function(t){return xt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return p()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=en(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){p()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=en(t);else{for(var o=0;o<i;++o){if(0===e.length)return this.layout=ji.XY,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=ji.XY:3==t?e=ji.XYZ:4==t&&(e=ji.XYZM);return(e)}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,o,r,s){for(var a=s||[],l=Math.cos(o),h=Math.sin(o),u=r[0],c=r[1],p=0,f=e;f<i;f+=n){var d=t[f]-u,g=t[f+1]-c;a[p++]=u+d*l-g*h,a[p++]=c+d*h+g*l;for(var _=f+2;_<f+n;++_)a[p++]=t[_]}s&&a.length!=p&&(a.length=p)}(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var o=i;o||(o=It(this.getExtent()));var r=this.getFlatCoordinates();if(r){var s=this.getStride();!function(t,e,i,n,o,r,s,a){for(var l=a||[],h=s[0],u=s[1],c=0,p=e;p<i;p+=n){var f=t[p]-h,d=t[p+1]-u;l[c++]=h+o*f,l[c++]=u+r*d;for(var g=p+2;g<p+n;++g)l[c++]=t[g]}a&&l.length!=c&&(l.length=c)}(r,0,r.length,s,t,n,o,r),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,o,r,s){for(var a=s||[],l=0,h=e;h<i;h+=n){a[l++]=t[h]+o,a[l++]=t[h+1]+r;for(var u=h+2;u<h+n;++u)a[l++]=t[u]}s&&a.length!=l&&(a.length=l)}(i,0,i.length,n,t,e,i),this.changed()}},e}(Qi);function en(t){var e;return t==ji.XY?e=2:t==ji.XYZ||t==ji.XYM?e=3:t==ji.XYZM&&(e=4),e}function nn(t,e,i,n){for(var o=0,r=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];o+=s*a-r*l,r=a,s=l}return o/2}function on(t,e,i,n){for(var o=0,r=0,s=i.length;r<s;++r){var a=i[r];o+=nn(t,e,a,n),e=a}return o}function rn(t,e,i,n,o,r,s){var a,l=t[e],h=t[e+1],u=t[i]-l,c=t[i+1]-h;if(0===u&&0===c)a=e;else{var p=((o-l)*u+(r-h)*c)/(u*u+c*c);if(p>1)a=i;else{if(p>0){for(var f=0;f<n;++f)s[f]=Q(t[e+f],t[i+f],p);return void(s.length=n)}a=e}}for(f=0;f<n;++f)s[f]=t[a+f];s.length=n}function sn(t,e,i,n,o){var r=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],l=t[e+1],h=H(r,s,a,l);h>o&&(o=h),r=a,s=l}return o}function an(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];o=sn(t,e,a,n,o),e=a}return o}function ln(t,e,i,n,o,r,s,a,l,h,u){if(e==i)return h;var c,p;if(0===o){if((p=H(s,a,t[e],t[e+1]))<h){for(c=0;c<n;++c)l[c]=t[e+c];return l.length=n,p}return h}for(var f=u||[NaN,NaN],d=e+n;d<i;)if(rn(t,d-n,d,n,s,a,f),(p=H(s,a,f[0],f[1]))<h){for(h=p,c=0;c<n;++c)l[c]=f[c];l.length=n,d+=n}else d+=n*Math.max((Math.sqrt(p)-Math.sqrt(h))/o|0,1);if(r&&(rn(t,i-n,e,n,s,a,f),(p=H(s,a,f[0],f[1]))<h)){for(h=p,c=0;c<n;++c)l[c]=f[c];l.length=n}return h}function hn(t,e,i,n,o,r,s,a,l,h,u){for(var c=u||[NaN,NaN],p=0,f=i.length;p<f;++p){var d=i[p];h=ln(t,e,d,n,o,r,s,a,l,h,c),e=d}return h}function un(t,e,i,n){for(var o=0,r=i.length;o<r;++o)for(var s=i[o],a=0;a<n;++a)t[e++]=s[a];return e}function cn(t,e,i,n,o){for(var r=o||[],s=0,a=0,l=i.length;a<l;++a){var h=un(t,e,i[a],n);r[s++]=h,e=h}return r.length=s,r}function pn(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=e;a<i;a+=n)r[s++]=t.slice(a,a+n);return r.length=s,r}function fn(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=0,l=i.length;a<l;++a){var h=i[a];r[s++]=pn(t,e,h,n,r[s]),e=h}return r.length=s,r}function dn(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=0,l=i.length;a<l;++a){var h=i[a];r[s++]=fn(t,e,h,n,r[s]),e=h[h.length-1]}return r.length=s,r}function gn(t,e,i,n,o,r,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)r[s++]=t[e],r[s++]=t[e+1];return s}var l=new Array(a);l[0]=1,l[a-1]=1;for(var h=[e,i-n],u=0;h.length>0;){for(var c=h.pop(),p=h.pop(),f=0,d=t[p],g=t[p+1],_=t[c],v=t[c+1],y=p+n;y<c;y+=n){var m=U(t[y],t[y+1],d,g,_,v);m>f&&(u=y,f=m)}f>o&&(l[(u-e)/n]=1,p+n<u&&h.push(p,u),u+n<c&&h.push(u,c))}for(y=0;y<a;++y)l[y]&&(r[s++]=t[e+y*n],r[s++]=t[e+y*n+1]);return s}function _n(t,e){return e*Math.round(t/e)}function vn(t,e,i,n,o,r,s){if(e==i)return s;var a,l,h=_n(t[e],o),u=_n(t[e+1],o);e+=n,r[s++]=h,r[s++]=u;do{if(a=_n(t[e],o),l=_n(t[e+1],o),(e+=n)==i)return r[s++]=a,r[s++]=l,s}while(a==h&&l==u);for(;e<i;){var c=_n(t[e],o),p=_n(t[e+1],o);if(e+=n,c!=a||p!=l){var f=a-h,d=l-u,g=c-h,_=p-u;f*_==d*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(d<0&&_<d||d==_||d>0&&_>d)?(a=c,l=p):(r[s++]=a,r[s++]=l,h=a,u=l,a=c,l=p)}}return r[s++]=a,r[s++]=l,s}function yn(t,e,i,n,o,r,s,a){for(var l=0,h=i.length;l<h;++l){var u=i[l];s=vn(t,e,u,n,o,r,s),a.push(s),e=u}return s}var mn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),xn=function(t){function e(e,i){var n=t.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return mn(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<ut(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return nn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=gn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,ji.XY)},e.prototype.getType=function(){return $.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=un(this.flatCoordinates,0,t,this.stride),this.changed()},e}(tn),En=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Tn=function(t){function e(e,i){var n=t.call(this)||this;return n.setCoordinates(e,i),n}return En(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var o=this.flatCoordinates,r=H(t,e,o[0],o[1]);if(r<n){for(var s=this.stride,a=0;a<s;++a)i[a]=o[a];return i.length=s,r}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return yt(this.flatCoordinates,t)},e.prototype.getType=function(){return $.POINT},e.prototype.intersectsExtent=function(t){return ft(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,n){for(var o=0,r=i.length;o<r;++o)t[e++]=i[o];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},e}(tn);function wn(t,e,i,n,o){return!function(t,e){var i;return(i=e(bt(t)))?i:(i=e(Pt(t)))?i:(i=e(Dt(t)))?i:(i=e(At(t)))||!1}(o,(function(o){return!Cn(t,e,i,n,o[0],o[1])}))}function Cn(t,e,i,n,o,r){for(var s=0,a=t[i-n],l=t[i-n+1];e<i;e+=n){var h=t[e],u=t[e+1];l<=r?u>r&&(h-a)*(r-l)-(o-a)*(u-l)>0&&s++:u<=r&&(h-a)*(r-l)-(o-a)*(u-l)<0&&s--,a=h,l=u}return 0!==s}function Sn(t,e,i,n,o,r){if(0===i.length)return!1;if(!Cn(t,e,i[0],n,o,r))return!1;for(var s=1,a=i.length;s<a;++s)if(Cn(t,i[s-1],i[s],n,o,r))return!1;return!0}function On(t,i,n,o,r,s,a){for(var l,h,u,c,p,f,d,g=r[s+1],_=[],v=0,y=n.length;v<y;++v){var m=n[v];for(c=t[m-o],f=t[m-o+1],l=i;l<m;l+=o)p=t[l],d=t[l+1],(g<=f&&d<=g||f<=g&&g<=d)&&(u=(g-f)/(d-f)*(p-c)+c,_.push(u)),c=p,f=d}var x=NaN,E=-1/0;for(_.sort(e),c=_[0],l=1,h=_.length;l<h;++l){p=_[l];var T=Math.abs(p-c);T>E&&Sn(t,i,n,o,u=(c+p)/2,g)&&(x=u,E=T),c=p}return isNaN(x)&&(x=r[s]),a?(a.push(x,g,E),a):[x,g,E]}function bn(t,e,i,n,o){for(var r=[],s=0,a=i.length;s<a;++s){var l=i[s];r=On(t,e,l,n,o,2*s,r),e=l[l.length-1]}return r}function Pn(t,e,i,n,o){for(var r,s=[t[e],t[e+1]],a=[];e+n<i;e+=n){if(a[0]=t[e+n],a[1]=t[e+n+1],r=o(s,a))return r;s[0]=a[0],s[1]=a[1]}return!1}function In(t,e,i,n,o){var r=Ct([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!Nt(o,r)&&(!!pt(o,r)||(r[0]>=o[0]&&r[2]<=o[2]||(r[1]>=o[1]&&r[3]<=o[3]||Pn(t,e,i,n,(function(t,e){return function(t,e,i){var n=!1,o=dt(t,e),r=dt(t,i);if(o===st.INTERSECTING||r===st.INTERSECTING)n=!0;else{var s=t[0],a=t[1],l=t[2],h=t[3],u=e[0],c=e[1],p=i[0],f=i[1],d=(f-c)/(p-u),g=void 0,_=void 0;r&st.ABOVE&&!(o&st.ABOVE)&&(n=(g=p-(f-h)/d)>=s&&g<=l),n||!(r&st.RIGHT)||o&st.RIGHT||(n=(_=f-(p-l)*d)>=a&&_<=h),n||!(r&st.BELOW)||o&st.BELOW||(n=(g=p-(f-a)/d)>=s&&g<=l),n||!(r&st.LEFT)||o&st.LEFT||(n=(_=f-(p-s)*d)>=a&&_<=h)}return n}(o,t,e)})))))}function Rn(t,e,i,n,o){if(!function(t,e,i,n,o){return!!In(t,e,i,n,o)||(!!Cn(t,e,i,n,o[0],o[1])||(!!Cn(t,e,i,n,o[0],o[3])||(!!Cn(t,e,i,n,o[2],o[1])||!!Cn(t,e,i,n,o[2],o[3]))))}(t,e,i[0],n,o))return!1;if(1===i.length)return!0;for(var r=1,s=i.length;r<s;++r)if(wn(t,i[r-1],i[r],n,o)&&!In(t,i[r-1],i[r],n,o))return!1;return!0}function Ln(t,e,i,n){for(;e<i-n;){for(var o=0;o<n;++o){var r=t[e+o];t[e+o]=t[i-n+o],t[i-n+o]=r}e+=n,i-=n}}function Mn(t,e,i,n){for(var o=0,r=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];o+=(a-r)*(l+s),r=a,s=l}return o>0}function Fn(t,e,i,n,o){for(var r=void 0!==o&&o,s=0,a=i.length;s<a;++s){var l=i[s],h=Mn(t,e,l,n);if(0===s){if(r&&h||!r&&!h)return!1}else if(r&&!h||!r&&h)return!1;e=l}return!0}function An(t,e,i,n,o){for(var r=void 0!==o&&o,s=0,a=i.length;s<a;++s){var l=i[s],h=Mn(t,e,l,n);(0===s?r&&h||!r&&!h:r&&!h||!r&&h)&&Ln(t,e,l,n),e=l}return e}function Dn(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r)e=An(t,e,i[r],n,o);return e}var kn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Nn=function(t){function e(e,i,n){var o=t.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==i&&n?(o.setFlatCoordinates(i,e),o.ends_=n):o.setCoordinates(e,i),o}return kn(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?o(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<ut(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(an(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return Sn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return on(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?An(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,fn(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=It(this.getExtent());this.flatInteriorPoint_=On(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new Tn(this.getFlatInteriorPoint(),ji.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new xn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],o=0,r=0,s=i.length;r<s;++r){var a=i[r],l=new xn(e.slice(o,a),t);n.push(l),o=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Fn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=An(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=yn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,ji.XY,n)},e.prototype.getType=function(){return $.POLYGON},e.prototype.intersectsExtent=function(t){return Rn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=cn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(tn);function Gn(t){var e=t[0],i=t[1],n=t[2],o=t[3],r=[e,i,e,o,n,o,n,i,e,i];return new Nn(r,ji.XY,[r.length])}var jn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xn=0,Yn=function(t){function e(e){var i=t.call(this)||this,n=v({},e);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=pe(n.projection,"EPSG:3857"),i.targetCenter_=null,i.targetResolution_,i.targetRotation_,n.center&&(n.center=Se(n.center,i.projection_)),n.extent&&(n.extent=Oe(n.extent,i.projection_)),i.applyOptions_(n),i}return jn(e,t),e.prototype.applyOptions_=function(t){var e=function(t){var e,n,o,r=void 0!==t.minZoom?t.minZoom:Xn,s=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,l=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=pe(t.projection,"EPSG:3857"),c=u.getExtent(),p=t.constrainOnlyCenter,f=t.extent;l||f||!u.isGlobal()||(p=!1,f=c);if(void 0!==t.resolutions){var d=t.resolutions;n=d[r],o=void 0!==d[s]?d[s]:d[d.length-1],e=t.constrainResolution?function(t,e,n){return function(o,r,s,a){if(void 0!==o){var l=t[0],h=t[t.length-1],u=n?Ti(l,n,s):l;if(a)return void 0===e||e?wi(o,u,h):Z(o,h,u);var c=Math.min(u,o),p=Math.floor(i(t,c,r));return t[p]>u&&p<t.length-1?t[p+1]:t[p]}}}(d,h,!p&&f):Ci(n,o,h,!p&&f)}else{var g=(c?Math.max(kt(c),Mt(c)):360*Yt[Xt.DEGREES]/u.getMetersPerUnit())/mi/Math.pow(2,Xn),_=g/Math.pow(2,28-Xn);void 0!==(n=t.maxResolution)?r=0:n=g/Math.pow(a,r),void 0===(o=t.minResolution)&&(o=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,s):g/Math.pow(a,s):_),s=r+Math.floor(Math.log(n/o)/Math.log(a)),o=n/Math.pow(a,s-r),e=t.constrainResolution?function(t,e,i,n,o){return function(r,s,a,l){if(void 0!==r){var h=o?Ti(e,o,a):e,u=void 0!==i?i:0;if(l)return void 0===n||n?wi(r,h,u):Z(r,u,h);var c=Math.ceil(Math.log(e/h)/Math.log(t)-1e-9),p=-s*(.5-1e-9)+.5,f=Math.min(h,r),d=Math.floor(Math.log(e/f)/Math.log(t)+p),g=Math.max(c,d);return Z(e/Math.pow(t,g),u,h)}}}(a,n,o,h,!p&&f):Ci(n,o,h,!p&&f)}return{constraint:e,maxResolution:n,minResolution:o,minZoom:r,zoomFactor:a}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;var n=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return xi(t.extent,t.constrainOnlyCenter,e)}var i=pe(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&i.isGlobal()){var n=i.getExtent().slice();return n[0]=-1/0,n[2]=1/0,xi(n,!1,!1)}return Ei}(t),o=e.constraint,r=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(r=o||q(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=r?0:t:void 0}):!1===e?Oi:"number"==typeof e?(i=e,n=2*Math.PI/i,function(t,e){return e?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0}):Oi}return Si;var i,n;var o,r}(t);this.constraints_={center:n,resolution:o,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.resolveConstraints(0),this.setProperties({}),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=v({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),v({},e,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),i=0;i<e.length;++i){var n=arguments[i];n.center&&((n=v({},n)).center=Se(n.center,this.getProjection())),n.anchor&&((n=v({},n)).anchor=Se(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)},e.prototype.animateInternal=function(t){var e,i=arguments.length;if(i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i),!this.isDef()){var n=arguments[i-1];return n.center&&this.setCenterInternal(n.center),void 0!==n.zoom&&this.setZoom(n.zoom),void 0!==n.rotation&&this.setRotation(n.rotation),void(e&&zn(e,!0))}for(var o=Date.now(),r=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_,l=[],h=0;h<i;++h){var u=arguments[h],c={start:o,complete:!1,anchor:u.anchor,duration:void 0!==u.duration?u.duration:1e3,easing:u.easing||Ni,callback:e};if(u.center&&(c.sourceCenter=r,c.targetCenter=u.center.slice(),r=c.targetCenter),void 0!==u.zoom?(c.sourceResolution=s,c.targetResolution=this.getResolutionForZoom(u.zoom),s=c.targetResolution):u.resolution&&(c.sourceResolution=s,c.targetResolution=u.resolution,s=c.targetResolution),void 0!==u.rotation){c.sourceRotation=a;var p=J(u.rotation-a+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=a+p,a=c.targetRotation}Bn(c)?c.complete=!0:o+=c.duration,l.push(c)}this.animations_.push(l),this.setHint(bi,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[bi]>0},e.prototype.getInteracting=function(){return this.hints_[Pi]>0},e.prototype.cancelAnimations=function(){this.setHint(bi,-this.hints_[bi]);for(var t=0,e=this.animations_.length;t<e;++t){var i=this.animations_[t];i[0].callback&&zn(i[0].callback,!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],o=!0,r=0,s=n.length;r<s;++r){var a=n[r];if(!a.complete){var l=t-a.start,h=a.duration>0?l/a.duration:1;h>=1?(a.complete=!0,h=1):o=!1;var u=a.easing(h);if(a.sourceCenter){var c=a.sourceCenter[0],p=a.sourceCenter[1],f=c+u*(a.targetCenter[0]-c),d=p+u*(a.targetCenter[1]-p);this.targetCenter_=[f,d]}if(a.sourceResolution&&a.targetResolution){var g=1===u?a.targetResolution:a.sourceResolution+u*(a.targetResolution-a.sourceResolution);if(a.anchor){var _=this.getSizeFromViewport_(this.getRotation()),v=this.constraints_.resolution(g,0,_,!0);this.targetCenter_=this.calculateCenterZoom(v,a.anchor)}this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var y=1===u?J(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+u*(a.targetRotation-a.sourceRotation);if(a.anchor){var m=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(m,a.anchor)}this.targetRotation_=y}if(this.applyTargetState_(!0),e=!0,!a.complete)break}}if(o){this.animations_[i]=null,this.setHint(bi,-1);var x=n[0].callback;x&&zn(x,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,e){var i,n,o,r=this.getCenterInternal();return void 0!==r&&(Ai(i=[r[0]-e[0],r[1]-e[1]],t-this.getRotation()),o=e,(n=i)[0]+=+o[0],n[1]+=+o[1]),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenterInternal(),o=this.getResolution();void 0!==n&&void 0!==o&&(i=[e[0]-t*(e[0]-n[0])/o,e[1]-t*(e[1]-n[1])/o]);return i},e.prototype.getSizeFromViewport_=function(t){var e=[100,100],i='.ol-viewport[data-view="'+d(this)+'"]',n=document.querySelector(i);if(n){var o=getComputedStyle(n);e[0]=parseInt(o.width,10),e[1]=parseInt(o.height,10)}if(t){var r=e[0],s=e[1];e[0]=Math.abs(r*Math.cos(t))+Math.abs(s*Math.sin(t)),e[1]=Math.abs(r*Math.sin(t))+Math.abs(s*Math.cos(t))}return e},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t?Ce(t,this.getProjection()):t},e.prototype.getCenterInternal=function(){return this.get(Ii)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){return function(t,e){return Te?ye(t,e,Te):t}(this.calculateExtentInternal(t),this.getProjection())},e.prototype.calculateExtentInternal=function(t){var e=t||this.getSizeFromViewport_(),i=this.getCenterInternal();ot(i,1);var n=this.getResolution();ot(void 0!==n,2);var o=this.getRotation();return ot(void 0!==o,3),Lt(i,n,o,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Ri)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(Oe(t,this.getProjection()),e)},e.prototype.getResolutionForExtentInternal=function(t,e){var i=e||this.getSizeFromViewport_(),n=kt(t)/i[0],o=Mt(t)/i[1];return Math.max(n,o)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,o=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*o)}},e.prototype.getRotation=function(){return this.get(Li)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,o=Math.log(i/n)/Math.log(e);return function(t){return Math.log(i/t)/Math.log(e)/o}},e.prototype.getState=function(){var t=this.getCenterInternal(),e=this.getProjection(),i=this.getResolution(),n=this.getRotation();return{center:t.slice(0),projection:void 0!==e?e:null,resolution:i,rotation:n,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,n,o=this.minZoom_||0;if(this.resolutions_){var r=i(this.resolutions_,t,1);o=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return o+Math.log(e/t)/Math.log(n)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=Z(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,Z(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,e){var i,n=v({size:this.getSizeFromViewport_()},e||{});if(ot(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))ot(!Gt(t),25),i=Gn(o=Oe(t,this.getProjection()));else if(t.getType()===$.CIRCLE){var o;(i=Gn(o=Oe(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),It(o))}else{var r=we();i=r?i.clone().transform(r,this.getProjection()):t}this.fitInternal(i,n)},e.prototype.fitInternal=function(t,e){var i=e||{},n=i.size;n||(n=this.getSizeFromViewport_());var o,r=void 0!==i.padding?i.padding:[0,0,0,0],s=void 0!==i.nearest&&i.nearest;o=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0;for(var a=t.getFlatCoordinates(),h=this.getRotation(),u=Math.cos(-h),c=Math.sin(-h),p=1/0,f=1/0,d=-1/0,g=-1/0,_=t.getStride(),v=0,y=a.length;v<y;v+=_){var m=a[v]*u-a[v+1]*c,x=a[v]*c+a[v+1]*u;p=Math.min(p,m),f=Math.min(f,x),d=Math.max(d,m),g=Math.max(g,x)}var E=this.getResolutionForExtentInternal([p,f,d,g],[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);E=isNaN(E)?o:Math.max(E,o),E=this.getConstrainedResolution(E,s?0:1),c=-c;var T=(p+d)/2,w=(f+g)/2,C=[(T+=(r[1]-r[3])/2*E)*u-(w+=(r[0]-r[2])/2*E)*c,w*u+T*c],S=i.callback?i.callback:l;void 0!==i.duration?this.animateInternal({resolution:E,center:this.getConstrainedCenter(C,E),duration:i.duration,easing:i.easing},S):(this.targetResolution_=E,this.targetCenter_=C,this.applyTargetState_(!1,!0),zn(S,!0))},e.prototype.centerOn=function(t,e,i){this.centerOnInternal(Se(t,this.getProjection()),e,i)},e.prototype.centerOnInternal=function(t,e,i){var n=this.getRotation(),o=Math.cos(-n),r=Math.sin(-n),s=t[0]*o-t[1]*r,a=t[1]*o+t[0]*r,l=this.getResolution(),h=(s+=(e[0]/2-i[0])*l)*o-(a+=(i[1]-e[1]/2)*l)*(r=-r),u=a*o+s*r;this.setCenterInternal([h,u])},e.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},e.prototype.adjustCenter=function(t){var e=Ce(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustResolution=function(t,e){var i=e&&Se(e,this.getProjection());this.adjustResolutionInternal(t,i)},e.prototype.adjustResolutionInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.getSizeFromViewport_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,n,i);void 0!==e&&(this.targetCenter_=this.calculateCenterZoom(o,e)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},e.prototype.adjustRotation=function(t,e){e&&(e=Se(e,this.getProjection())),this.adjustRotationInternal(t,e)},e.prototype.adjustRotationInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);void 0!==e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(Se(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,e){var i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),o=this.getSizeFromViewport_(n),r=this.constraints_.resolution(this.targetResolution_,0,o,i),s=this.constraints_.center(this.targetCenter_,r,o,i);this.get(Li)!==n&&this.set(Li,n),this.get(Ri)!==r&&this.set(Ri,r),this.get(Ii)&&Fi(this.get(Ii),s)||this.set(Ii,s),this.getAnimating()&&!t&&this.cancelAnimations()},e.prototype.resolveConstraints=function(t,e,i){var n=void 0!==t?t:200,o=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getSizeFromViewport_(r),a=this.constraints_.resolution(this.targetResolution_,o,s),l=this.constraints_.center(this.targetCenter_,a,s);if(0===n)return this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=l,void this.applyTargetState_();this.getResolution()===a&&this.getRotation()===r&&this.getCenterInternal()&&Fi(this.getCenterInternal(),l)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:l,resolution:a,duration:n,easing:ki,anchor:i}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Pi,1)},e.prototype.endInteraction=function(t,e,i){var n=i&&Se(i,this.getProjection());this.endInteractionInternal(t,e,n)},e.prototype.endInteractionInternal=function(t,e,i){this.setHint(Pi,-1),this.resolveConstraints(t,e,i)},e.prototype.getConstrainedCenter=function(t,e){var i=this.getSizeFromViewport_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)},e.prototype.getConstrainedZoom=function(t,e){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))},e.prototype.getConstrainedResolution=function(t,e){var i=e||0,n=this.getSizeFromViewport_(this.getRotation());return this.constraints_.resolution(t,i,n)},e}(F);function zn(t,e){setTimeout((function(){t(e)}),0)}function Bn(t){return!(t.sourceCenter&&t.targetCenter&&!Fi(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}var Kn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"},Wn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zn=function(t){function e(e){var i=t.call(this)||this,n=v({},e);return n[Kn.OPACITY]=void 0!==e.opacity?e.opacity:1,ot("number"==typeof n[Kn.OPACITY],64),n[Kn.VISIBLE]=void 0===e.visible||e.visible,n[Kn.Z_INDEX]=e.zIndex,n[Kn.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,n[Kn.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,n[Kn.MIN_ZOOM]=void 0!==e.minZoom?e.minZoom:-1/0,n[Kn.MAX_ZOOM]=void 0!==e.maxZoom?e.maxZoom:1/0,i.className_=void 0!==n.className?e.className:"ol-layer",delete n.className,i.setProperties(n),i.state_=null,i}return Wn(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t,hasOverlay:!1};return e.opacity=Z(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=this.getZIndex()||(!1===e.managed?1/0:0),e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return p()},e.prototype.getLayerStatesArray=function(t){return p()},e.prototype.getExtent=function(){return this.get(Kn.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(Kn.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(Kn.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(Kn.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(Kn.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(Kn.OPACITY)},e.prototype.getSourceState=function(){return p()},e.prototype.getVisible=function(){return this.get(Kn.VISIBLE)},e.prototype.getZIndex=function(){return this.get(Kn.Z_INDEX)},e.prototype.setExtent=function(t){this.set(Kn.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(Kn.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(Kn.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(Kn.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(Kn.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){ot("number"==typeof t,64),this.set(Kn.OPACITY,t)},e.prototype.setVisible=function(t){this.set(Kn.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(Kn.Z_INDEX,t)},e}(F),Vn={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},Un=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hn={LAYERS:"layers"},qn=function(t){function e(e){var i=this,n=e||{},o=v({},n);delete o.layers;var r=n.layers;return(i=t.call(this,o)||this).layersListenerKeys_=[],i.listenerKeys_={},i.addEventListener(D(Hn.LAYERS),i.handleLayersChanged_),r?Array.isArray(r)?r=new We(r.slice(),{unique:!0}):ot("function"==typeof r.getArray,43):r=new We(void 0,{unique:!0}),i.setLayers(r),i}return Un(e,t),e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(T),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(x(t,Ye.ADD,this.handleLayersAdd_,this),x(t,Ye.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(T);y(this.listenerKeys_);for(var i=t.getArray(),n=0,o=i.length;n<o;n++){var r=i[n];this.listenerKeys_[d(r)]=[x(r,_,this.handleLayerChange_,this),x(r,P.CHANGE,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[d(e)]=[x(e,_,this.handleLayerChange_,this),x(e,P.CHANGE,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=d(t.element);this.listenerKeys_[e].forEach(T),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(Hn.LAYERS)},e.prototype.setLayers=function(t){this.set(Hn.LAYERS,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var n=this.getLayerState(),o=i,r=e.length;o<r;o++){var s=e[o];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),s.minZoom=Math.max(s.minZoom,n.minZoom),s.maxZoom=Math.min(s.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==s.extent?s.extent=Ft(s.extent,n.extent):s.extent=n.extent)}return e},e.prototype.getSourceState=function(){return Vn.READY},e}(Zn);function Jn(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}var Qn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function $n(t,e){t.style.msTouchAction=e,t.style.touchAction=e,t.setAttribute("touch-action",e)}var to=function(t){function e(e){var i=t.call(this)||this,n=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,o,r={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new qn({layers:t.layers});r[li.LAYERGROUP]=s,r[li.TARGET]=t.target,r[li.VIEW]=void 0!==t.view?t.view:new Yn,void 0!==t.controls&&(Array.isArray(t.controls)?i=new We(t.controls.slice()):(ot("function"==typeof t.controls.getArray,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new We(t.interactions.slice()):(ot("function"==typeof t.interactions.getArray,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?o=new We(t.overlays.slice()):(ot("function"==typeof t.overlays.getArray,49),o=t.overlays):o=new We;return{controls:i,interactions:n,keyboardEventTarget:e,overlays:o,values:r}}(e);i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(i),i.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,i.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:ti,i.postRenderTimeoutHandle_,i.animationDelayKey_,i.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(i),i.coordinateToPixelTransform_=[1,0,0,1,0,0],i.pixelToCoordinateTransform_=[1,0,0,1,0,0],i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.viewport_=document.createElement("div"),i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.viewport_.style.position="relative",i.viewport_.style.overflow="hidden",i.viewport_.style.width="100%",i.viewport_.style.height="100%",i.overlayContainer_=document.createElement("div"),i.overlayContainer_.style.position="absolute",i.overlayContainer_.style.zIndex="0",i.overlayContainer_.style.width="100%",i.overlayContainer_.style.height="100%",i.overlayContainer_.className="ol-overlaycontainer",i.viewport_.appendChild(i.overlayContainer_),i.overlayContainerStopEvent_=document.createElement("div"),i.overlayContainerStopEvent_.style.position="absolute",i.overlayContainerStopEvent_.style.zIndex="0",i.overlayContainerStopEvent_.style.width="100%",i.overlayContainerStopEvent_.style.height="100%",i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",i.viewport_.appendChild(i.overlayContainerStopEvent_),i.mapBrowserEventHandler_=new ai(i,e.moveTolerance);var o=i.handleMapBrowserEvent.bind(i);for(var r in ii)i.mapBrowserEventHandler_.addEventListener(ii[r],o);i.keyboardEventTarget_=n.keyboardEventTarget,i.keyHandlerKeys_=null,i.focusHandlerKeys_=null;var s=i.handleBrowserEvent.bind(i);return i.viewport_.addEventListener(P.CONTEXTMENU,s,!1),i.viewport_.addEventListener(P.WHEEL,s,!1),i.controls=n.controls||new We,i.interactions=n.interactions||new We,i.overlays_=n.overlays,i.overlayIdIndex_={},i.renderer_=null,i.handleResize_,i.postRenderFunctions_=[],i.tileQueue_=new vi(i.getTilePriority.bind(i),i.handleTileChange_.bind(i)),i.addEventListener(D(li.LAYERGROUP),i.handleLayerGroupChanged_),i.addEventListener(D(li.VIEW),i.handleViewChanged_),i.addEventListener(D(li.SIZE),i.handleSizeChanged_),i.addEventListener(D(li.TARGET),i.handleTargetChanged_),i.setProperties(n.values),i.controls.forEach(function(t){t.setMap(this)}.bind(i)),i.controls.addEventListener(Ye.ADD,function(t){t.element.setMap(this)}.bind(i)),i.controls.addEventListener(Ye.REMOVE,function(t){t.element.setMap(null)}.bind(i)),i.interactions.forEach(function(t){t.setMap(this)}.bind(i)),i.interactions.addEventListener(Ye.ADD,function(t){t.element.setMap(this)}.bind(i)),i.interactions.addEventListener(Ye.REMOVE,function(t){t.element.setMap(null)}.bind(i)),i.overlays_.forEach(i.addOverlayInternal_.bind(i)),i.overlays_.addEventListener(Ye.ADD,function(t){this.addOverlayInternal_(t.element)}.bind(i)),i.overlays_.addEventListener(Ye.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(i)),i}return Qn(e,t),e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener(P.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(P.WHEEL,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(P.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixelInternal(t),o=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,r=void 0!==i.layerFilter?i.layerFilter:s,a=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,o,a,e,null,r,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},o=void 0!==n.hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,r=n.layerFilter||s;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,o,e,r)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:s,o=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0,r=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,o,r,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(li.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return Ce(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?Wi(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(li.LAYERGROUP)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e].layer.getSource();if(n&&n.loading)return!0}return!1},e.prototype.getPixelFromCoordinate=function(t){var e=Se(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},e.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?Wi(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(li.SIZE)},e.prototype.getView=function(){return this.get(li.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,n){var o=this.frameState_;if(!(o&&e in o.wantedTiles))return 1/0;if(!o.wantedTiles[e][t.getKey()])return 1/0;var r=o.viewState.center,s=i[0]-r[0],a=i[1]-r[1];return 65536*Math.log(n)+Math.sqrt(s*s+a*a)/n},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new He(i,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){for(var e=t.originalEvent.target;e instanceof HTMLElement;){if(e.parentElement===this.overlayContainerStopEvent_)return;e=e.parentElement}t.frameState=this.frameState_;var i=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var n=i.length-1;n>=0;n--){var o=i[n];if(o.getActive())if(!o.handleEvent(t))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var o=t.viewHints;if(o[bi]||o[Pi]){var r=!ei&&Date.now()-t.time>8;i=r?0:8,n=r?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}!t||!this.hasListener(fi)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(fi,t);for(var s=this.postRenderFunctions_,a=0,l=s.length;a<l;++a)s[a](this,t);s.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.focusHandlerKeys_){for(var e=0,i=this.focusHandlerKeys_.length;e<i;++e)T(this.focusHandlerKeys_[e]);this.focusHandlerKeys_=null}if(this.keyHandlerKeys_){for(e=0,i=this.keyHandlerKeys_.length;e<i;++e)T(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var n=!0;t.hasAttribute("tabindex")&&(n=document.activeElement===t,this.focusHandlerKeys_=[x(t,P.FOCUS,$n.bind(this,this.viewport_,"none")),x(t,P.BLUR,$n.bind(this,this.viewport_,"auto"))]),$n(this.viewport_,n?"none":"auto");var o=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[x(o,P.KEYDOWN,this.handleBrowserEvent,this),x(o,P.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(P.RESIZE,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),X(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(P.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(T(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(T(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",d(t)),this.viewPropertyListenerKey_=x(t,_,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=x(t,P.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(T),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[x(t,_,this.render,this),x(t,P.CHANGE,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e=this.getSize(),i=this.getView(),n=this.frameState_,o=null;if(void 0!==e&&function(t){return t[0]>0&&t[1]>0}(e)&&i&&i.isDef()){var r=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:n?n.declutterItems:[],extent:Lt(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:r,wantedTiles:{}}}if(this.frameState_=o,this.renderer_.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),n)(!this.previousExtent_||!Gt(this.previousExtent_)&&!Et(o.extent,this.previousExtent_))&&(this.dispatchEvent(new Ve(u,this,n)),this.previousExtent_=vt(this.previousExtent_));this.previousExtent_&&!o.viewHints[bi]&&!o.viewHints[Pi]&&!Et(o.extent,this.previousExtent_)&&(this.dispatchEvent(new Ve(c,this,o)),ht(o.extent,this.previousExtent_))}this.dispatchEvent(new Ve(h,this,o)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(li.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(li.SIZE,t)},e.prototype.setTarget=function(t){this.set(li.TARGET,t)},e.prototype.setView=function(t){this.set(li.VIEW,t)},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},e}(F);var eo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),io=function(t){function e(e){var i=this,n=v({},e);delete n.source,(i=t.call(this,n)||this).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,e.render&&(i.render=e.render),e.map&&i.setMap(e.map),i.addEventListener(D(Kn.SOURCE),i.handleSourcePropertyChange_);var o=e.source?e.source:null;return i.setSource(o),i}return eo(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Kn.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Vn.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(T(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=x(t,P.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},e.prototype.render=function(t,e){var i=this.getRenderer();if(i.prepareFrame(t))return i.renderFrame(t,e)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(T(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(T(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=x(t,ci,(function(t){t.frameState.layerStatesArray.push(this.getLayerState(!1))}),this),this.mapRenderKey_=x(this,P.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Kn.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e}(Zn);function no(t,e){if(!t.visible)return!1;var i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}var oo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ro=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{element:document.createElement("div"),render:n.render||so,target:n.target})||this).ulElement_=document.createElement("ul"),i.collapsed_=void 0===n.collapsed||n.collapsed,i.overrideCollapsible_=void 0!==n.collapsible,i.collapsible_=void 0===n.collapsible||n.collapsible,i.collapsible_||(i.collapsed_=!1);var o=void 0!==n.className?n.className:"ol-attribution",r=void 0!==n.tipLabel?n.tipLabel:"Attributions",s=void 0!==n.collapseLabel?n.collapseLabel:"";"string"==typeof s?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=s):i.collapseLabel_=s;var a=void 0!==n.label?n.label:"i";"string"==typeof a?(i.label_=document.createElement("span"),i.label_.textContent=a):i.label_=a;var l=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,h=document.createElement("button");h.setAttribute("type","button"),h.title=r,h.appendChild(l),h.addEventListener(P.CLICK,i.handleClick_.bind(i),!1);var u=o+" "+Fe+" "+Ae+(i.collapsed_&&i.collapsible_?" "+De:"")+(i.collapsible_?"":" ol-uncollapsible"),c=i.element;return c.className=u,c.appendChild(i.ulElement_),c.appendChild(h),i.renderedAttributions_=[],i.renderedVisible_=!0,i}return oo(e,t),e.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,o=0,r=n.length;o<r;++o){var s=n[o];if(no(s,t.viewState)){var a=s.layer.getSource();if(a){var l=a.getAttributions();if(l){var h=l(t);if(h)if(this.overrideCollapsible_||!1!==a.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(h))for(var u=0,c=h.length;u<c;++u)h[u]in e||(i.push(h[u]),e[h[u]]=!0);else h in e||(i.push(h),e[h]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!r(e,this.renderedAttributions_)){Y(this.ulElement_);for(var n=0,o=e.length;n<o;++n){var s=document.createElement("li");s.innerHTML=e[n],this.ulElement_.appendChild(s)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(De),this.collapsed_?j(this.collapseLabel_,this.label_):j(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(B);function so(t){this.updateElement_(t.frameState)}var ao=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),lo=function(t){function e(e){var i=this,n=e||{};i=t.call(this,{element:document.createElement("div"),render:n.render||ho,target:n.target})||this;var o=void 0!==n.className?n.className:"ol-rotate",r=void 0!==n.label?n.label:"";i.label_=null,"string"==typeof r?(i.label_=document.createElement("span"),i.label_.className="ol-compass",i.label_.textContent=r):(i.label_=r,i.label_.classList.add("ol-compass"));var s=n.tipLabel?n.tipLabel:"Reset rotation",a=document.createElement("button");a.className=o+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(i.label_),a.addEventListener(P.CLICK,i.handleClick_.bind(i),!1);var l=o+" "+Fe+" "+Ae,h=i.element;return h.className=l,h.appendChild(a),i.callResetNorth_=n.resetNorth?n.resetNorth:void 0,i.duration_=void 0!==n.duration?n.duration:250,i.autoHide_=void 0===n.autoHide||n.autoHide,i.rotation_=void 0,i.autoHide_&&i.element.classList.add(Le),i}return ao(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:ki}):t.setRotation(0))},e}(B);function ho(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var o=this.element.classList.contains(Le);o||0!==i?o&&0!==i&&this.element.classList.remove(Le):this.element.classList.add(Le)}this.label_.style.transform=n}this.rotation_=i}}var uo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),co=function(t){function e(e){var i=this,n=e||{};i=t.call(this,{element:document.createElement("div"),target:n.target})||this;var o=void 0!==n.className?n.className:"ol-zoom",r=void 0!==n.delta?n.delta:1,s=void 0!==n.zoomInLabel?n.zoomInLabel:"+",a=void 0!==n.zoomOutLabel?n.zoomOutLabel:"",l=void 0!==n.zoomInTipLabel?n.zoomInTipLabel:"Zoom in",h=void 0!==n.zoomOutTipLabel?n.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=o+"-in",u.setAttribute("type","button"),u.title=l,u.appendChild("string"==typeof s?document.createTextNode(s):s),u.addEventListener(P.CLICK,i.handleClick_.bind(i,r),!1);var c=document.createElement("button");c.className=o+"-out",c.setAttribute("type","button"),c.title=h,c.appendChild("string"==typeof a?document.createTextNode(a):a),c.addEventListener(P.CLICK,i.handleClick_.bind(i,-r),!1);var p=o+" "+Fe+" "+Ae,f=i.element;return f.className=p,f.appendChild(u),f.appendChild(c),i.duration_=void 0!==n.duration?n.duration:250,i}return uo(e,t),e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getZoom();if(void 0!==i){var n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:ki})):e.setZoom(n)}}},e}(B),po=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fo=function(t){function e(e,i,n,o){var r=t.call(this,e)||this;return r.inversePixelTransform=i,r.frameState=n,r.context=o,r}return po(e,t),e}(S),go=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,_o=/^([a-z]*)$|^hsla?\(.*\)$/i;var vo=function(){var t={},e=0;return function(i){var n;if(t.hasOwnProperty(i))n=t[i];else{if(e>=1024){var o=0;for(var r in t)0==(3&o++)&&(delete t[r],--e)}n=function(t){var e,i,n,o,r;_o.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}(t));if(go.exec(t)){var s=t.length-1,a=void 0;a=s<=4?1:2;var l=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),i=parseInt(t.substr(1+1*a,a),16),n=parseInt(t.substr(1+2*a,a),16),o=l?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,l&&(o=(o<<4)+o)),r=[e,i,n,o/255]}else 0==t.indexOf("rgba(")?mo(r=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((r=t.slice(4,-1).split(",").map(Number)).push(1),mo(r)):ot(!1,14);return r}(i),t[i]=n,++e}return n}}();function yo(t){return Array.isArray(t)?t:vo(t)}function mo(t){return t[0]=Z(t[0]+.5|0,0,255),t[1]=Z(t[1]+.5|0,0,255),t[2]=Z(t[2]+.5|0,0,255),t[3]=Z(t[3],0,1),t}function xo(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function Eo(t,e,i){return e+":"+t+":"+(i?function(t){return"string"==typeof t?t:xo(t)}(i):"null")}var To=new(function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},t.prototype.get=function(t,e,i){var n=Eo(t,e,i);return n in this.cache_?this.cache_[n]:null},t.prototype.set=function(t,e,i,n){var o=Eo(t,e,i);this.cache_[o]=n,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}());function wo(t){return Array.isArray(t)?xo(t):t}var Co,So=function(){function t(){}return t.prototype.drawCustom=function(t,e,i){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,e){},t.prototype.drawFeature=function(t,e){},t.prototype.drawGeometryCollection=function(t,e){},t.prototype.drawLineString=function(t,e){},t.prototype.drawMultiLineString=function(t,e){},t.prototype.drawMultiPoint=function(t,e){},t.prototype.drawMultiPolygon=function(t,e){},t.prototype.drawPoint=function(t,e){},t.prototype.drawPolygon=function(t,e){},t.prototype.drawText=function(t,e){},t.prototype.setFillStrokeStyle=function(t,e){},t.prototype.setImageStyle=function(t,e){},t.prototype.setTextStyle=function(t,e){},t}(),Oo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),bo=function(t){function e(e){var i=t.call(this)||this;return i.highWaterMark=void 0!==e?e:2048,i.count_=0,i.entries_={},i.oldest_=null,i.newest_=null,i}return Oo(e,t),e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(P.CLEAR)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},e.prototype.get=function(t,e){var i=this.entries_[t];return ot(void 0!==i,15),i===this.newest_?i.value_:(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i,i.value_)},e.prototype.remove=function(t){var e=this.entries_[t];return ot(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){ot(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e}(b),Po=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Io=function(t){function e(e){var i=t.call(this,e)||this;return i.consumers={},i}return Po(e,t),e.prototype.clear=function(){this.consumers={},t.prototype.clear.call(this)},e.prototype.get=function(e,i){var n=t.prototype.get.call(this,e),o=d(i);return o in this.consumers||(this.consumers[o]={}),this.consumers[o][e]=!0,n},e.prototype.prune=function(){t:for(;this.canExpireCache();){var t=this.peekLastKey();for(var e in this.consumers)if(t in this.consumers[e])break t;var i=this.pop();for(var e in i.width=i.height=0,this.consumers)delete this.consumers[e][t]}},e.prototype.release=function(t){delete this.consumers[d(t)]},e}(bo),Ro=[],Lo=[0,0,0,0],Mo=new Io,Fo={},Ao=null,Do={},ko=function(){var t,e,i=100,n=Fo,o="32px ",r=["monospace","serif"],s=r.length,a="wmytzilWMYTZIL@#/&?$%10";function l(t,i,n){for(var l=No(),h=!0,u=0;u<s;++u){var c=r[u];if(l.font=t+" "+i+" "+o+c,e=l.measureText(a).width,n!=c){l.font=t+" "+i+" "+o+n+","+c;var p=l.measureText(a).width;h=h&&p!=e}}return!!h}function h(){var e=!0;for(var o in n)n[o]<i&&(l.apply(this,o.split("\n"))?(n[o]=i,y(Do),Ao=null,Co=void 0,Mo.getCount()&&Mo.clear()):(++n[o],e=!1));e&&(clearInterval(t),t=void 0)}return function(e){var o=ke(e);if(o)for(var r=o.families,s=0,a=r.length;s<a;++s){var u=r[s],c=o.style+"\n"+o.weight+"\n"+u;c in n||(n[c]=i,l(o.style,o.weight,u)||(n[c]=0,void 0===t&&(t=setInterval(h,32))))}}}();function No(){return Ao||(Ao=k(1,1)),Ao}var Go,jo,Xo=(jo=Do,function(t){var e=jo[t];return null==e&&(Go||((Go=document.createElement("div")).innerHTML="M",Go.style.margin=Go.style.padding="0 !important",Go.style.position="absolute !important",Go.style.left="-99999px !important"),Go.style.font=t,document.body.appendChild(Go),e=jo[t]=Go.offsetHeight,document.body.removeChild(Go)),e});function Yo(t,e){var i=No();return t!=Co&&(i.font=Co=t),i.measureText(e).width}function zo(t,e,i){return e in i?i[e]:i[e]=Yo(t,e)}function Bo(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))}var Ko=[1,0,0,1,0,0];function Wo(t,e,i,n,o,r,s,a,l,h,u){var c;1!=i&&(c=t.globalAlpha,t.globalAlpha=c*i),e&&t.setTransform.apply(t,e),t.drawImage(n,o,r,s,a,l,h,s*u,a*u),1!=i&&(t.globalAlpha=c),e&&t.setTransform.apply(t,Ko)}var Zo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vo=function(t){function e(e,i,n,o,r,s,a){var l=t.call(this)||this;return l.context_=e,l.pixelRatio_=i,l.extent_=n,l.transform_=o,l.viewRotation_=r,l.squaredTolerance_=s,l.userTransform_=a,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=0,l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=0,l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=[1,0,0,1,0,0],l}return Zo(e,t),e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var o=Xi(t,e,i,2,this.transform_,this.pixelCoordinates_),r=this.context_,s=this.tmpLocalTransform_,a=r.globalAlpha;1!=this.imageOpacity_&&(r.globalAlpha=a*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var h=0,u=o.length;h<u;h+=2){var c=o[h]-this.imageAnchorX_,p=o[h+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var f=c+this.imageAnchorX_,d=p+this.imageAnchorY_;Vi(s,f,d,this.imageScale_,this.imageScale_,l,-f,-d),r.setTransform.apply(r,s)}r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,p,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||r.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(r.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var o=Xi(t,e,i,n,this.transform_,this.pixelCoordinates_),r=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a=o[e]+this.textOffsetX_,l=o[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_){var h=Vi(this.tmpLocalTransform_,a,l,this.textScale_,this.textScale_,s,-a,-l);r.setTransform.apply(r,h)}this.textStrokeState_&&r.strokeText(this.text_,a,l),this.textFillState_&&r.fillText(this.text_,a,l)}0===s&&1==this.textScale_||r.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,n,o){var r=this.context_,s=Xi(t,e,i,n,this.transform_,this.pixelCoordinates_);r.moveTo(s[0],s[1]);var a=s.length;o&&(a-=2);for(var l=2;l<a;l+=2)r.lineTo(s[l],s[l+1]);return o&&r.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var o=0,r=i.length;o<r;++o)e=this.moveToLineTo_(t,e,i[o],n,!0);return e},e.prototype.drawCircle=function(t){if(Nt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var o=t.getStride();return Xi(n,0,n.length,o,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],o=Math.sqrt(i*i+n*n),r=this.context_;r.beginPath(),r.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case $.POINT:this.drawPoint(t);break;case $.LINE_STRING:this.drawLineString(t);break;case $.POLYGON:this.drawPolygon(t);break;case $.MULTI_POINT:this.drawMultiPoint(t);break;case $.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case $.MULTI_POLYGON:this.drawMultiPolygon(t);break;case $.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case $.CIRCLE:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&Nt(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Nt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(Nt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),o=0,r=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,l=r.length;a<l;++a)o=this.moveToLineTo_(n,o,r[a],s,!1);i.stroke()}if(""!==this.text_){var h=t.getFlatMidpoints();this.drawText_(h,0,h.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Nt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Nt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,o=t.getEndss(),r=t.getStride();e.beginPath();for(var s=0,a=o.length;s<a;++s){var l=o[s];n=this.drawRings_(i,n,l,r)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=e.lineCap=t.lineCap),e.setLineDash&&(r(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:"center";i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=n&&(i.textAlign=e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:wo(i||"#000")}}else this.fillState_=null;if(e){var n=e.getColor(),o=e.getLineCap(),r=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit();this.strokeState_={lineCap:void 0!==o?o:"round",lineDash:r||Ro,lineDashOffset:s||0,lineJoin:void 0!==a?a:"round",lineWidth:this.pixelRatio_*(void 0!==l?l:1),miterLimit:void 0!==h?h:10,strokeStyle:wo(n||"#000")}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),n=t.getOrigin(),o=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=o[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=o[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:wo(i||"#000")}}else this.textFillState_=null;var n=t.getStroke();if(n){var o=n.getColor(),r=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),l=n.getLineJoin(),h=n.getWidth(),u=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==r?r:"round",lineDash:s||Ro,lineDashOffset:a||0,lineJoin:void 0!==l?l:"round",lineWidth:void 0!==h?h:1,miterLimit:void 0!==u?u:10,strokeStyle:wo(o||"#000")}}else this.textStrokeState_=null;var c=t.getFont(),p=t.getOffsetX(),f=t.getOffsetY(),d=t.getRotateWithView(),g=t.getRotation(),_=t.getScale(),v=t.getText(),y=t.getTextAlign(),m=t.getTextBaseline();this.textState_={font:void 0!==c?c:"10px sans-serif",textAlign:void 0!==y?y:"center",textBaseline:void 0!==m?m:"middle"},this.text_=void 0!==v?v:"",this.textOffsetX_=void 0!==p?this.pixelRatio_*p:0,this.textOffsetY_=void 0!==f?this.pixelRatio_*f:0,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0!==g?g:0,this.textScale_=this.pixelRatio_*(void 0!==_?_:1)}else this.text_=""},e}(So),Uo={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Ho={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"},qo=.5,Jo={Point:function(t,e,i,n){var o=i.getImage();if(o){if(o.getImageState()!=Uo.LOADED)return;var r=t.getBuilder(i.getZIndex(),Ho.IMAGE);r.setImageStyle(o,t.addDeclutter(!1)),r.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Ho.TEXT);a.setTextStyle(s,t.addDeclutter(!!o)),a.drawText(e,n)}},LineString:function(t,e,i,n){var o=i.getStroke();if(o){var r=t.getBuilder(i.getZIndex(),Ho.LINE_STRING);r.setFillStrokeStyle(null,o),r.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Ho.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(o||r){var s=t.getBuilder(i.getZIndex(),Ho.POLYGON);s.setFillStrokeStyle(o,r),s.drawPolygon(e,n)}var a=i.getText();if(a){var l=t.getBuilder(i.getZIndex(),Ho.TEXT);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},MultiPoint:function(t,e,i,n){var o=i.getImage();if(o){if(o.getImageState()!=Uo.LOADED)return;var r=t.getBuilder(i.getZIndex(),Ho.IMAGE);r.setImageStyle(o,t.addDeclutter(!1)),r.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Ho.TEXT);a.setTextStyle(s,t.addDeclutter(!!o)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var o=i.getStroke();if(o){var r=t.getBuilder(i.getZIndex(),Ho.LINE_STRING);r.setFillStrokeStyle(null,o),r.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),Ho.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(r||o){var s=t.getBuilder(i.getZIndex(),Ho.POLYGON);s.setFillStrokeStyle(o,r),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var l=t.getBuilder(i.getZIndex(),Ho.TEXT);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var o,r,s=e.getGeometriesArray();for(o=0,r=s.length;o<r;++o){(0,Jo[s[o].getType()])(t,s[o],i,n)}},Circle:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(o||r){var s=t.getBuilder(i.getZIndex(),Ho.CIRCLE);s.setFillStrokeStyle(o,r),s.drawCircle(e,n)}var a=i.getText();if(a){var l=t.getBuilder(i.getZIndex(),Ho.TEXT);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}}};function Qo(t,e){var i=function(t,e){return qo*t/e}(t,e);return i*i}function $o(t,e,i,n,o,r){var s=!1,a=i.getImage();if(a){var l=a.getImageState();l==Uo.LOADED||l==Uo.ERROR?a.unlistenImageChange(o):(l==Uo.IDLE&&a.load(),l=a.getImageState(),a.listenImageChange(o),s=!0)}return function(t,e,i,n,o){var r=i.getGeometryFunction()(e);if(!r)return;var s=r.simplifyTransformed(n,o);if(i.getRenderer())!function t(e,i,n,o){if(i.getType()==$.GEOMETRY_COLLECTION){for(var r=i.getGeometries(),s=0,a=r.length;s<a;++s)t(e,r[s],n,o);return}var l=e.getBuilder(n.getZIndex(),Ho.DEFAULT);l.drawCustom(i,o,n.getRenderer())}(t,s,i,e);else{(0,Jo[s.getType()])(t,s,i,e)}}(t,e,i,n,r),s}var tr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),er=function(t){function e(e){var i=t.call(this)||this;return i.map_=e,i.declutterTree_=null,i}return tr(e,t),e.prototype.dispatchRenderEvent=function(t,e){p()},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;Vi(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Ui(n,i)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o,r,s,a){var l,h=e.viewState;function u(t,e,i){return o.call(r,e,t?i:null)}var c=h.projection,p=t,f=[[0,0]];if(c.canWrapX()){var d=c.getExtent(),g=kt(d),_=t[0];if(_<d[0]||_>d[2])p=[_+g*Math.ceil((d[0]-_)/g),t[1]];n&&f.push([-g,0],[g,0])}var v,y=e.layerStatesArray,m=y.length;this.declutterTree_&&(v=this.declutterTree_.all().map((function(t){return t.value})));for(var x=[],E=0;E<f.length;E++)for(var T=m-1;T>=0;--T){var w=y[T],C=w.layer;if(C.hasRenderer()&&no(w,h)&&s.call(a,C)){var S=C.getRenderer(),O=C.getSource(),b=O.getWrapX()?p:t;if(S&&O){var P=u.bind(null,w.managed);x[0]=b[0]+f[E][0],x[1]=b[1]+f[E][1],l=S.forEachFeatureAtCoordinate(x,e,i,P,v)}if(l)return l}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,o){return p()},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,o,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,s,this,o,r)},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){this.declutterTree_=function(t,e){e&&e.clear();for(var i=t.declutterItems,n=i.length-1;n>=0;--n)for(var o=i[n],r=o.items,s=0,a=r.length;s<a;s+=3)e=r[s].renderDeclutter(r[s+1],r[s+2],o.opacity,e);return i.length=0,e}(t,this.declutterTree_)},e.prototype.scheduleExpireIconCache=function(t){To.canExpireCache()&&t.postRenderFunctions.push(ir)},e}(C);function ir(t,e){To.expire()}var nr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),or=function(t){function e(e){var i=t.call(this,e)||this;i.labelCacheKey_=x(Mo,P.CLEAR,e.redrawText.bind(e)),i.element_=document.createElement("div");var n=i.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",i.element_.className=Fe+" ol-layers";var o=e.getViewport();return o.insertBefore(i.element_,o.firstChild||null),i.children_=[],i.renderedVisible_=!0,i}return nr(e,t),e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap();if(i.hasListener(t)){var n=new fo(t,void 0,e);i.dispatchEvent(n)}},e.prototype.disposeInternal=function(){T(this.labelCacheKey_),t.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(e){if(e){this.calculateMatrices2D(e),this.dispatchRenderEvent(ci,e);var i=e.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),n=e.viewState;this.children_.length=0;for(var o=!1,r=null,s=0,a=i.length;s<a;++s){var l=i[s];if(o=o||l.hasOverlay,e.layerIndex=s,no(l,n)&&(l.sourceState==Vn.READY||l.sourceState==Vn.UNDEFINED)){var h=l.layer.render(e,r);if(h){var u=h.childElementCount;h===r&&s!=a-1||2!==u||o||h.removeChild(h.lastElementChild),h!==r&&(this.children_.push(h),o=2===u,r=h)}}}t.prototype.renderFrame.call(this,e),function(t,e){for(var i=t.childNodes,n=0;;++n){var o=i[n],r=e[n];if(!o&&!r)break;o!==r&&(o?r?t.insertBefore(r,o):(t.removeChild(o),--n):t.appendChild(r))}}(this.element_,this.children_),this.dispatchRenderEvent(pi,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,i,n,o){for(var r=e.viewState,s=e.layerStatesArray,a=s.length-1;a>=0;--a){var l=s[a],h=l.layer;if(h.hasRenderer()&&no(l,r)&&o(h)){var u=h.getRenderer().getDataAtPixel(t,e,i);if(u){var c=n(h,u);if(c)return c}}}},e}(er);var rr=function(){function t(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var o=this.points_[e]-this.points_[i],r=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(r,o),this.initialVelocity_=Math.sqrt(o*o+r*r)/n,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}(),sr="active",ar=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),lr=function(t){function e(e){var i=t.call(this)||this;return e.handleEvent&&(i.handleEvent=e.handleEvent),i.map_=null,i.setActive(!0),i}return ar(e,t),e.prototype.getActive=function(){return this.get(sr)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(sr,t)},e.prototype.setMap=function(t){this.map_=t},e}(F);function hr(t,e,i,n){var o=t.getZoom();if(void 0!==o){var r=t.getConstrainedZoom(o+e),s=t.getResolutionForZoom(r);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:i,duration:void 0!==n?n:250,easing:ki})}}var ur=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cr=function(t){function e(e){var i=t.call(this,{handleEvent:pr})||this,n=e||{};return i.delta_=n.delta?n.delta:1,i.duration_=void 0!==n.duration?n.duration:250,i}return ur(e,t),e}(lr);function pr(t){var e=!1;if(t.type==ii.DBLCLICK){var i=t.originalEvent,n=t.map,o=t.coordinate,r=i.shiftKey?-this.delta_:this.delta_;hr(n.getView(),r,o,this.duration_),t.preventDefault(),e=!0}return!e}var fr=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},dr=function(t){return t.target.getTargetElement()===document.activeElement},gr=s,_r=function(t){var e=t.originalEvent;return 0==e.button&&!(Qe&&$e&&e.ctrlKey)},vr=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},yr=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},mr=function(t){var e=t.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},xr=function(t){var e=t.pointerEvent;return ot(void 0!==e,56),"mouse"==e.pointerType},Er=function(t){var e=t.pointerEvent;return ot(void 0!==e,56),e.isPrimary&&0===e.button},Tr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wr=function(t){function e(e){var i=this,n=e||{};return i=t.call(this,n)||this,n.handleDownEvent&&(i.handleDownEvent=n.handleDownEvent),n.handleDragEvent&&(i.handleDragEvent=n.handleDragEvent),n.handleMoveEvent&&(i.handleMoveEvent=n.handleMoveEvent),n.handleUpEvent&&(i.handleUpEvent=n.handleUpEvent),n.stopDown&&(i.stopDown=n.stopDown),i.handlingDownUpSequence=!1,i.trackedPointers_={},i.targetPointers=[],i}return Tr(e,t),e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ii.POINTERDRAG)this.handleDragEvent(t);else if(t.type==ii.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==ii.POINTERDOWN){var n=this.handleDownEvent(t);n&&t.preventDefault(),this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==ii.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===ii.POINTERDOWN||e===ii.POINTERDRAG||e===ii.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==ii.POINTERUP?delete this.trackedPointers_[i]:t.type==ii.POINTERDOWN?this.trackedPointers_[i]=e:i in this.trackedPointers_&&(this.trackedPointers_[i]=e),this.targetPointers=m(this.trackedPointers_)}},e}(lr);function Cr(t){for(var e=t.length,i=0,n=0,o=0;o<e;o++)i+=t[o].clientX,n+=t[o].clientY;return[i/e,n/e]}var Sr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Or=function(t){function e(e){var i=t.call(this,{stopDown:a})||this,n=e||{};return i.kinetic_=n.kinetic,i.lastCentroid=null,i.lastPointersCount_,i.panning_=!1,i.condition_=n.condition?n.condition:br,i.noKinetic_=!1,i}return Sr(e,t),e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e=this.targetPointers,i=Cr(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var n=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=t.map.getView();!function(t,e){t[0]*=e,t[1]*=e}(n,o.getResolution()),Ai(n,o.getRotation()),o.adjustCenterInternal(n)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length},e.prototype.handleUpEvent=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),o=this.kinetic_.getAngle(),r=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),a=e.getCoordinateFromPixelInternal([s[0]-n*Math.cos(o),s[1]-n*Math.sin(o)]);i.animateInternal({center:i.getConstrainedCenter(a),duration:500,easing:ki})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(wr);function br(t){return vr(t)&&Er(t)}var Pr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ir=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,{stopDown:a})||this).condition_=n.condition?n.condition:fr,i.lastAngle_=void 0,i.duration_=void 0!==n.duration?n.duration:250,i}return Pr(e,t),e.prototype.handleDragEvent=function(t){if(xr(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==Si){var n=e.getSize(),o=t.pixel,r=Math.atan2(n[1]/2-o[1],o[0]-n[0]/2);if(void 0!==this.lastAngle_){var s=r-this.lastAngle_;i.adjustRotationInternal(-s)}this.lastAngle_=r}}},e.prototype.handleUpEvent=function(t){return!xr(t)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){return!!xr(t)&&(!(!_r(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))},e}(wr),Rr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Lr=function(t){function e(e){var i=t.call(this)||this;return i.geometry_=null,i.element_=document.createElement("div"),i.element_.style.position="absolute",i.element_.className="ol-box "+e,i.map_=null,i.startPixel_=null,i.endPixel_=null,i}return Rr(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Nn([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(C),Mr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Fr="boxstart",Ar="boxdrag",Dr="boxend",kr=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.coordinate=i,o.mapBrowserEvent=n,o}return Mr(e,t),e}(S),Nr=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.box_=new Lr(n.className||"ol-dragbox"),i.minArea_=void 0!==n.minArea?n.minArea:64,i.onBoxEnd_=n.onBoxEnd?n.onBoxEnd:l,i.startPixel_=null,i.condition_=n.condition?n.condition:gr,i.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:i.defaultBoxEndCondition,i}return Mr(e,t),e.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0],o=i[1]-e[1];return n*n+o*o>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){xr(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new kr(Ar,t.coordinate,t)))},e.prototype.handleUpEvent=function(t){return!xr(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new kr(Dr,t.coordinate,t))),!1)},e.prototype.handleDownEvent=function(t){return!!xr(t)&&(!(!_r(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new kr(Fr,t.coordinate,t)),!0))},e}(wr),Gr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jr=function(t){function e(e){var i=this,n=e||{},o=n.condition?n.condition:yr;return(i=t.call(this,{condition:o,className:n.className||"ol-dragzoom",minArea:n.minArea,onBoxEnd:Xr})||this).duration_=void 0!==n.duration?n.duration:200,i.out_=void 0!==n.out&&n.out,i}return Gr(e,t),e}(Nr);function Xr(){var t=this.getMap(),e=t.getView(),i=t.getSize(),n=this.getGeometry().getExtent();if(this.out_){var o=e.calculateExtentInternal(i),r=mt([t.getPixelFromCoordinateInternal(bt(n)),t.getPixelFromCoordinateInternal(Dt(n))]);!function(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}(o,1/e.getResolutionForExtentInternal(r,i)),n=o}var s=e.getConstrainedResolution(e.getResolutionForExtentInternal(n,i)),a=e.getConstrainedCenter(It(n),s);e.animateInternal({resolution:s,center:a,duration:this.duration_,easing:ki})}var Yr={LEFT:37,UP:38,RIGHT:39,DOWN:40},zr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Br=function(t){function e(e){var i=t.call(this,{handleEvent:Kr})||this,n=e||{};return i.defaultCondition_=function(t){return vr(t)&&mr(t)},i.condition_=void 0!==n.condition?n.condition:i.defaultCondition_,i.duration_=void 0!==n.duration?n.duration:100,i.pixelDelta_=void 0!==n.pixelDelta?n.pixelDelta:128,i}return zr(e,t),e}(lr);function Kr(t){var e=!1;if(t.type==P.KEYDOWN){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==Yr.DOWN||i==Yr.LEFT||i==Yr.RIGHT||i==Yr.UP)){var n=t.map.getView(),o=n.getResolution()*this.pixelDelta_,r=0,s=0;i==Yr.DOWN?s=-o:i==Yr.LEFT?r=-o:i==Yr.RIGHT?r=o:s=o;var a=[r,s];Ai(a,n.getRotation()),function(t,e,i){var n=t.getCenterInternal();if(n){var o=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Gi,center:t.getConstrainedCenter(o)})}}(n,a,this.duration_),t.preventDefault(),e=!0}}return!e}var Wr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zr=function(t){function e(e){var i=t.call(this,{handleEvent:Vr})||this,n=e||{};return i.condition_=n.condition?n.condition:mr,i.delta_=n.delta?n.delta:1,i.duration_=void 0!==n.duration?n.duration:100,i}return Wr(e,t),e}(lr);function Vr(t){var e=!1;if(t.type==P.KEYDOWN||t.type==P.KEYPRESS){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=t.map,o=i=="+".charCodeAt(0)?this.delta_:-this.delta_;hr(n.getView(),o,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var Ur=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hr="trackpad",qr="wheel",Jr=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,n)||this).totalDelta_=0,i.lastDelta_=0,i.maxDelta_=void 0!==n.maxDelta?n.maxDelta:1,i.duration_=void 0!==n.duration?n.duration:250,i.timeout_=void 0!==n.timeout?n.timeout:80,i.useAnchor_=void 0===n.useAnchor||n.useAnchor,i.condition_=n.condition?n.condition:gr,i.lastAnchor_=null,i.startTime_=void 0,i.timeoutId_,i.mode_=void 0,i.trackpadEventGap_=400,i.trackpadTimeoutId_,i.trackpadDeltaPerZoom_=300,i}return Ur(e,t),e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,Math.sign(this.lastDelta_),this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==P.WHEEL)return!0;t.preventDefault();var e,i=t.map,n=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==P.WHEEL&&(e=n.deltaY,Je&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=ti),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?Hr:qr),this.mode_===Hr){var r=i.getView();return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):r.beginInteraction(),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.trackpadEventGap_),r.adjustZoom(-e/this.trackpadDeltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1}this.totalDelta_+=e;var s=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),s),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations(),hr(e,-Z(this.totalDelta_,-this.maxDelta_,this.maxDelta_),this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(lr),Qr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$r=function(t){function e(e){var i=this,n=e||{},o=n;return o.stopDown||(o.stopDown=a),(i=t.call(this,o)||this).anchor_=null,i.lastAngle_=void 0,i.rotating_=!1,i.rotationDelta_=0,i.threshold_=void 0!==n.threshold?n.threshold:.3,i.duration_=void 0!==n.duration?n.duration:250,i}return Qr(e,t),e.prototype.handleDragEvent=function(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],o=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var r=o-this.lastAngle_;this.rotationDelta_+=r,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=r}this.lastAngle_=o;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==Si){var l=s.getViewport().getBoundingClientRect(),h=Cr(this.targetPointers);h[0]-=l.left,h[1]-=l.top,this.anchor_=s.getCoordinateFromPixelInternal(h),this.rotating_&&(s.render(),a.adjustRotationInternal(e,this.anchor_))}},e.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(wr),ts=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),es=function(t){function e(e){var i=this,n=e||{},o=n;return o.stopDown||(o.stopDown=a),(i=t.call(this,o)||this).anchor_=null,i.duration_=void 0!==n.duration?n.duration:400,i.lastDistance_=void 0,i.lastScaleDelta_=1,i}return ts(e,t),e.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],o=i.clientX-n.clientX,r=i.clientY-n.clientY,s=Math.sqrt(o*o+r*r);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e);var h=a.getViewport().getBoundingClientRect(),u=Cr(this.targetPointers);u[0]-=h.left,u[1]-=h.top,this.anchor_=a.getCoordinateFromPixelInternal(u),a.render(),l.adjustResolutionInternal(e,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(wr);function is(t,i,n,o,r,s){var a=NaN,l=NaN,h=(n-i)/o;if(1===h)a=t[i],l=t[i+1];else if(2==h)a=(1-r)*t[i]+r*t[i+o],l=(1-r)*t[i+1]+r*t[i+o+1];else if(0!==h){for(var u=t[i],c=t[i+1],p=0,f=[0],d=i+o;d<n;d+=o){var g=t[d],_=t[d+1];p+=Math.sqrt((g-u)*(g-u)+(_-c)*(_-c)),f.push(p),u=g,c=_}var v=r*p,y=function(t,i,n){for(var o,r,s=n||e,a=0,l=t.length,h=!1;a<l;)(r=+s(t[o=a+(l-a>>1)],i))<0?a=o+1:(l=o,h=!r);return h?a:~a}(f,v);if(y<0){var m=(v-f[-y-2])/(f[-y-1]-f[-y-2]),x=i+(-y-2)*o;a=Q(t[x],t[x+o],m),l=Q(t[x+1],t[x+o+1],m)}else a=t[i+y*o],l=t[i+y*o+1]}return s?(s[0]=a,s[1]=l,s):[a,l]}function ns(t,e,i,n,o,r){if(i==e)return null;var s;if(o<t[e+n-1])return r?((s=t.slice(e,e+n))[n-1]=o,s):null;if(t[i-1]<o)return r?((s=t.slice(i-n,i))[n-1]=o,s):null;if(o==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,l=i/n;a<l;){var h=a+l>>1;o<t[(h+1)*n-1]?l=h:a=h+1}var u=t[a*n-1];if(o==u)return t.slice((a-1)*n,(a-1)*n+n);var c=(o-u)/(t[(a+1)*n-1]-u);s=[];for(var p=0;p<n-1;++p)s.push(Q(t[(a-1)*n+p],t[a*n+p],c));return s.push(o),s}function os(t,e,i,n){for(var o=t[e],r=t[e+1],s=0,a=e+n;a<i;a+=n){var l=t[a],h=t[a+1];s+=Math.sqrt((l-o)*(l-o)+(h-r)*(h-r)),o=l,r=h}return s}var rs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ss=function(t){function e(e,i){var n=t.call(this)||this;return n.flatMidpoint_=null,n.flatMidpointRevision_=-1,n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return rs(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?o(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<ut(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return Pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=ji.XYM&&this.layout!=ji.XYZM)return null;var i=void 0!==e&&e;return ns(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return is(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return os(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=gn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,ji.XY)},e.prototype.getType=function(){return $.LINE_STRING},e.prototype.intersectsExtent=function(t){return In(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=un(this.flatCoordinates,0,t,this.stride),this.changed()},e}(tn),as=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ls=function(t){function e(e,i,n){var r=t.call(this)||this;if(r.ends_=[],r.maxDelta_=-1,r.maxDeltaRevision_=-1,Array.isArray(e[0]))r.setCoordinates(e,i);else if(void 0!==i&&n)r.setFlatCoordinates(i,e),r.ends_=n;else{for(var s=r.getLayout(),a=e,l=[],h=[],u=0,c=a.length;u<c;++u){var p=a[u];0===u&&(s=p.getLayout()),o(l,p.getFlatCoordinates()),h.push(l.length)}r.setFlatCoordinates(s,l),r.ends_=h}return r}return as(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?o(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<ut(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(an(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=ji.XYM&&this.layout!=ji.XYZM||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,o=void 0!==i&&i;return function(t,e,i,n,o,r,s){if(s)return ns(t,e,i[i.length-1],n,o,r);var a;if(o<t[n-1])return r?((a=t.slice(0,n))[n-1]=o,a):null;if(t[t.length-1]<o)return r?((a=t.slice(t.length-n))[n-1]=o,a):null;for(var l=0,h=i.length;l<h;++l){var u=i[l];if(e!=u){if(o<t[e+n-1])return null;if(o<=t[u-1])return ns(t,e,u,n,o,!1);e=u}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,o)},e.prototype.getCoordinates=function(){return fn(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new ss(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],o=0,r=0,s=e.length;r<s;++r){var a=e[r],l=new ss(t.slice(o,a),i);n.push(l),o=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,r=this.stride,s=0,a=n.length;s<a;++s){var l=n[s];o(t,is(e,i,l,r,.5)),i=l}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,o,r,s,a){for(var l=0,h=i.length;l<h;++l){var u=i[l];s=gn(t,e,u,n,o,r,s),a.push(s),e=u}return s}(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,ji.XY,n)},e.prototype.getType=function(){return $.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){if(In(t,e,i[r],n,o))return!0;e=i[r]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=cn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(tn),hs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),us=function(t){function e(e,i){var n=t.call(this)||this;return i&&!Array.isArray(e[0])?n.setFlatCoordinates(i,e):n.setCoordinates(e,i),n}return hs(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?o(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){if(n<ut(this.getExtent(),t,e))return n;for(var o=this.flatCoordinates,r=this.stride,s=0,a=o.length;s<a;s+=r){var l=H(t,e,o[s],o[s+1]);if(l<n){n=l;for(var h=0;h<r;++h)i[h]=o[s+h];i.length=r}}return n},e.prototype.getCoordinates=function(){return pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new Tn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],o=0,r=t.length;o<r;o+=i){var s=new Tn(t.slice(o,o+i),e);n.push(s)}return n},e.prototype.getType=function(){return $.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,o=e.length;n<o;n+=i){if(ft(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=un(this.flatCoordinates,0,t,this.stride),this.changed()},e}(tn);function cs(t,e,i,n){for(var o=[],r=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var l=i[s];r=xt(t,e,l[0],n),o.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=l[l.length-1]}return o}var ps=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fs=function(t){function e(e,i,n){var r=t.call(this)||this;if(r.endss_=[],r.flatInteriorPointsRevision_=-1,r.flatInteriorPoints_=null,r.maxDelta_=-1,r.maxDeltaRevision_=-1,r.orientedRevision_=-1,r.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var s=r.getLayout(),a=e,l=[],h=[],u=0,c=a.length;u<c;++u){var p=a[u];0===u&&(s=p.getLayout());for(var f=l.length,d=p.getEnds(),g=0,_=d.length;g<_;++g)d[g]+=f;o(l,p.getFlatCoordinates()),h.push(d)}i=s,e=l,n=h}return void 0!==i&&n?(r.setFlatCoordinates(i,e),r.endss_=n):r.setCoordinates(e,i),r}return ps(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;o(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,r=(e=t.getEnds().slice()).length;n<r;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,n){return n<ut(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];o=an(t,e,a,n,o),e=a[a.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,o,r,s,a,l,h,u){for(var c=u||[NaN,NaN],p=0,f=i.length;p<f;++p){var d=i[p];h=hn(t,e,d,n,o,r,s,a,l,h,c),e=d[d.length-1]}return h}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,o,r){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var l=i[s];if(Sn(t,e,l,n,o,r))return!0;e=l[l.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var o=0,r=0,s=i.length;r<s;++r){var a=i[r];o+=on(t,e,a,n),e=a[a.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Dn(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,dn(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=cs(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=bn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new us(this.getFlatInteriorPoints().slice(),ji.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];if(!Fn(t,e,a,n,o))return!1;a.length&&(e=a[a.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Dn(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,o,r,s,a){for(var l=0,h=i.length;l<h;++l){var u=i[l],c=[];s=yn(t,e,u,n,o,r,s,c),a.push(c),e=u[u.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,ji.XY,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),o=n[n.length-1];if(0!==e)for(var r=0,s=n.length;r<s;++r)n[r]-=e;return new Nn(this.flatCoordinates.slice(e,o),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],o=0,r=0,s=i.length;r<s;++r){var a=i[r].slice(),l=a[a.length-1];if(0!==o)for(var h=0,u=a.length;h<u;++h)a[h]-=o;var c=new Nn(e.slice(o,l),t,a);n.push(c),o=l}return n},e.prototype.getType=function(){return $.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];if(Rn(t,e,a,n,o))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,o){for(var r=o||[],s=0,a=0,l=i.length;a<l;++a){var h=cn(t,e,i[a],n,r[s]);r[s++]=h,e=h[h.length-1]}return r.length=s,r}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(tn),ds=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getAnchor=function(){return p()},t.prototype.getImage=function(t){return p()},t.prototype.getHitDetectionImage=function(t){return p()},t.prototype.getImageState=function(){return p()},t.prototype.getImageSize=function(){return p()},t.prototype.getHitDetectionImageSize=function(){return p()},t.prototype.getOrigin=function(){return p()},t.prototype.getSize=function(){return p()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t){p()},t.prototype.load=function(){p()},t.prototype.unlistenImageChange=function(t){p()},t}(),gs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_s=function(t){function e(e){var i=this,n=void 0!==e.rotateWithView&&e.rotateWithView;return(i=t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1})||this).canvas_=null,i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius_=void 0!==e.radius?e.radius:e.radius1,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.anchor_=null,i.size_=null,i.imageSize_=null,i.hitDetectionImageSize_=null,i.render(),i}return gs(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return Uo.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.render=function(){var t,e="round",i="round",n=0,o=null,r=0,s=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=wo(t),void 0===(s=this.stroke_.getWidth())&&(s=1),o=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),void 0===(i=this.stroke_.getLineJoin())&&(i="round"),void 0===(e=this.stroke_.getLineCap())&&(e="round"),void 0===(n=this.stroke_.getMiterLimit())&&(n=10));var a=2*(this.radius_+s)+1,l={strokeStyle:t,strokeWidth:s,size:a,lineCap:e,lineDash:o,lineDashOffset:r,lineJoin:i,miterLimit:n},h=k(a,a);this.canvas_=h.canvas;var u=a=this.canvas_.width;this.draw_(l,h,0,0),this.createHitDetectionCanvas_(l),this.anchor_=[a/2,a/2],this.size_=[a,a],this.imageSize_=[u,u]},e.prototype.draw_=function(t,e,i,n){var o,r,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(a*=2),o=0;o<=a;o++)r=2*o*Math.PI/a-Math.PI/2+this.angle_,s=o%2==0?this.radius_:l,e.lineTo(t.size/2+s*Math.cos(r),t.size/2+s*Math.sin(r))}if(this.fill_){var h=this.fill_.getColor();null===h&&(h="#000"),e.fillStyle=wo(h),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var e=this.fill_.getColor(),i=0;if("string"==typeof e&&(e=yo(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){var n=k(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n,0,0)}}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var o=this.points_;if(o===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var r=void 0!==this.radius2_?this.radius2_:this.radius_;r!==this.radius_&&(o*=2);var s=void 0,a=void 0,l=void 0;for(s=0;s<=o;s++)l=2*s*Math.PI/o-Math.PI/2+this.angle_,a=s%2==0?this.radius_:r,e.lineTo(t.size/2+a*Math.cos(l),t.size/2+a*Math.sin(l))}e.fillStyle="#000",e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e}(ds),vs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ys=function(t){function e(e){var i=e||{};return t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke})||this}return vs(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(_s),ms=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),xs=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}(),Es=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Cs,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Cs,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();var Ts=null;function ws(t,e){if(!Ts){var i=new ms({color:"rgba(255,255,255,0.4)"}),n=new xs({color:"#3399CC",width:1.25});Ts=[new Es({image:new ys({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return Ts}function Cs(t){return t.getGeometry()}var Ss=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Os="renderOrder",bs=function(t){function e(e){var i=this,n=e||{},o=v({},n);return delete o.style,delete o.renderBuffer,delete o.updateWhileAnimating,delete o.updateWhileInteracting,(i=t.call(this,o)||this).declutter_=void 0!==n.declutter&&n.declutter,i.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(n.style),i.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,i.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,i}return Ss(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Os)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Os,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:ws,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;if(Array.isArray(t))i=t;else ot("function"==typeof t.getZIndex,41),i=[t];e=function(){return i}}return e}(this.style_),this.changed()},e}(io),Ps=0,Is=1,Rs=2,Ls=3,Ms=4,Fs=5,As=6,Ds=7,ks=8,Ns=9,Gs=10,js=11,Xs=12,Ys=[ks],zs=[Xs],Bs=[Is],Ks=[Ls],Ws=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zs=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.tolerance=e,r.maxExtent=i,r.pixelRatio=o,r.maxLineWidth=0,r.resolution=n,r.beginGeometryInstruction1_=null,r.beginGeometryInstruction2_=null,r.bufferedMaxExtent_=null,r.instructions=[],r.coordinates=[],r.tmpCoordinate_=[],r.hitDetectionInstructions=[],r.state={},r}return Ws(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,n,o,r){var s=this.coordinates.length,a=this.getBufferedMaxExtent();r&&(e+=n);var l,h,u,c=t[e],p=t[e+1],f=this.tmpCoordinate_,d=!0;for(l=e+n;l<i;l+=n)f[0]=t[l],f[1]=t[l+1],(u=dt(a,f))!==h?(d&&(this.coordinates[s++]=c,this.coordinates[s++]=p),this.coordinates[s++]=f[0],this.coordinates[s++]=f[1],d=!1):u===st.INTERSECTING?(this.coordinates[s++]=f[0],this.coordinates[s++]=f[1],d=!1):d=!0,c=f[0],p=f[1],h=u;return(o&&d||l===e+n)&&(this.coordinates[s++]=c,this.coordinates[s++]=p),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r],l=this.appendFlatCoordinates(t,e,a,n,!1,!1);o.push(l),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,o,r,s,a,l=t.getType(),h=t.getStride(),u=this.coordinates.length;if(l==$.MULTI_POLYGON){n=(t=t).getOrientedFlatCoordinates(),s=[];var c=t.getEndss();a=0;for(var p=0,f=c.length;p<f;++p){var d=[];a=this.drawCustomCoordinates_(n,a,c[p],h,d),s.push(d)}this.instructions.push([Ms,u,s,t,i,dn])}else l==$.POLYGON||l==$.MULTI_LINE_STRING?(r=[],n=l==$.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),h,r),this.instructions.push([Ms,u,r,t,i,fn])):l==$.LINE_STRING||l==$.MULTI_POINT?(n=t.getFlatCoordinates(),o=this.appendFlatCoordinates(n,0,n.length,h,!1,!1),this.instructions.push([Ms,u,o,t,i,pn])):l==$.POINT&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),o=this.coordinates.length,this.instructions.push([Ms,u,o,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[Ps,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ps,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,o,r=e.length,s=-1;for(t=0;t<r;++t)(o=(i=e[t])[0])==Ds?s=t:o==Ps&&(i[2]=t,n(this.hitDetectionInstructions,s,t),s=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=wo(n||"#000")}else i.fillStyle=void 0;if(e){var o=e.getColor();i.strokeStyle=wo(o||"#000");var r=e.getLineCap();i.lineCap=void 0!==r?r:"round";var s=e.getLineDash();i.lineDash=s?s.slice():Ro;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var l=e.getLineJoin();i.lineJoin=void 0!==l?l:"round";var h=e.getWidth();i.lineWidth=void 0!==h?h:1;var u=e.getMiterLimit();i.miterLimit=void 0!==u?u:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[Gs,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[js,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,o=t.lineDash,s=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||o!=t.currentLineDash&&!r(t.currentLineDash,o)||t.currentLineDashOffset!=s||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=o,t.currentLineDashOffset=s,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=h)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[Ds,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=ht(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;lt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(So),Vs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Us=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.declutterGroups_=null,r.hitDetectionImage_=null,r.image_=null,r.anchorX_=void 0,r.anchorY_=void 0,r.height_=void 0,r.opacity_=void 0,r.originX_=void 0,r.originY_=void 0,r.rotateWithView_=void 0,r.rotation_=void 0,r.scale_=void 0,r.width_=void 0,r}return Vs(e,t),e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([As,o,r,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([As,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([As,o,r,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([As,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),o=t.getHitDetectionImage(1),r=t.getImage(1),s=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroups_=e,this.hitDetectionImage_=o,this.image_=r,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=n[0]},e}(Zs),Hs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qs=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Hs(e,t),e.prototype.drawFlatCoordinates_=function(t,e,i,n){var o=this.coordinates.length,r=this.appendFlatCoordinates(t,e,i,n,!1,!1),s=[Ns,o,r];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([js,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Bs);var r=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(r,0,r.length,s),this.hitDetectionInstructions.push(zs),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([js,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Bs);for(var r=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),l=0,h=0,u=r.length;h<u;++h)l=this.drawFlatCoordinates_(s,l,r[h],a);this.hitDetectionInstructions.push(zs),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(zs),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(zs),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(Bs)},e}(Zs),Js=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Qs=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Js(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var o=this.state,r=void 0!==o.fillStyle,s=void 0!==o.strokeStyle,a=i.length;this.instructions.push(Bs),this.hitDetectionInstructions.push(Bs);for(var l=0;l<a;++l){var h=i[l],u=this.coordinates.length,c=this.appendFlatCoordinates(t,e,h,n,!0,!s),p=[Ns,u,c];this.instructions.push(p),this.hitDetectionInstructions.push(p),s&&(this.instructions.push(Ks),this.hitDetectionInstructions.push(Ks)),e=h}return r&&(this.instructions.push(Ys),this.hitDetectionInstructions.push(Ys)),s&&(this.instructions.push(zs),this.hitDetectionInstructions.push(zs)),e},e.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Gs,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([js,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(r,0,r.length,s,!1,!1);var l=[Rs,a];this.instructions.push(Bs,l),this.hitDetectionInstructions.push(Bs,l),void 0!==i.fillStyle&&(this.instructions.push(Ys),this.hitDetectionInstructions.push(Ys)),void 0!==i.strokeStyle&&(this.instructions.push(zs),this.hitDetectionInstructions.push(zs)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Gs,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([js,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,r,a),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Gs,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([js,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var r=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),l=0,h=0,u=r.length;h<u;++h)l=this.drawFlatCoordinatess_(s,l,r[h],a);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var i=this.coordinates,n=0,o=i.length;n<o;++n)i[n]=_n(i[n],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(Zs);function $s(t,e,i,n,o){var r,s,a,l,h,u,c,p,f,d=i,g=i,_=0,v=0,y=i;for(r=i;r<n;r+=o){var m=e[r],x=e[r+1];void 0!==l&&(p=m-l,f=x-h,a=Math.sqrt(p*p+f*f),void 0!==u&&(v+=s,Math.acos((u*p+c*f)/(s*a))>t&&(v>_&&(_=v,d=y,g=r),v=0,y=r-o)),s=a,u=p,c=f),l=m,h=x}return(v+=a)>_?[y,r]:[d,g]}var ta="line",ea=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ia={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},na={Circle:Qs,Default:Zs,Image:Us,LineString:qs,Polygon:Qs,Text:function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.declutterGroups_,r.labels_=null,r.text_="",r.textOffsetX_=0,r.textOffsetY_=0,r.textRotateWithView_=void 0,r.textRotation_=0,r.textFillState_=null,r.fillStates={},r.textStrokeState_=null,r.strokeStates={},r.textState_={},r.textStates={},r.textKey_="",r.fillKey_="",r.strokeKey_="",Mo.prune(),r}return ea(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,o=this.textState_;if(""!==this.text_&&o&&(i||n)){var r,s,a=this.coordinates.length,l=t.getType(),h=null,u=2,c=2;if(o.placement===ta){if(!Nt(this.getBufferedMaxExtent(),t.getExtent()))return;var p=void 0;if(h=t.getFlatCoordinates(),c=t.getStride(),l==$.LINE_STRING)p=[h.length];else if(l==$.MULTI_LINE_STRING)p=t.getEnds();else if(l==$.POLYGON)p=t.getEnds().slice(0,1);else if(l==$.MULTI_POLYGON){var f=t.getEndss();for(p=[],r=0,s=f.length;r<s;++r)p.push(f[r][0])}this.beginGeometry(t,e);for(var d=o.textAlign,g=0,_=void 0,v=0,y=p.length;v<y;++v){if(null==d){var m=$s(o.maxAngle,h,g,p[v],c);g=m[0],_=m[1]}else _=p[v];for(r=g;r<_;r+=c)this.coordinates.push(h[r],h[r+1]);u=this.coordinates.length,g=p[v];var x=this.declutterGroups_?0===v?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(a,u,x),a=u}this.endGeometry(e)}else{var E=null;switch(o.overflow||(E=[]),l){case $.POINT:case $.MULTI_POINT:u=(h=t.getFlatCoordinates()).length;break;case $.LINE_STRING:h=t.getFlatMidpoint();break;case $.CIRCLE:h=t.getCenter();break;case $.MULTI_LINE_STRING:u=(h=t.getFlatMidpoints()).length;break;case $.POLYGON:h=t.getFlatInteriorPoint(),o.overflow||E.push(h[2]/this.resolution),c=3;break;case $.MULTI_POLYGON:var T=t.getFlatInteriorPoints();for(h=[],r=0,s=T.length;r<s;r+=3)o.overflow||E.push(T[r+2]/this.resolution),h.push(T[r],T[r+1]);if(0==(u=h.length))return}u=this.appendFlatCoordinates(h,0,u,c,!1,!1),this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var w=this.pixelRatio;this.instructions.push([As,a,u,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,o.padding==Lo?Lo:o.padding.map((function(t){return t*w})),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]),this.hitDetectionInstructions.push([As,a,u,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,o.padding,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var o=this.textKey_;o in this.textStates||(this.textStates[o]={font:e.font,textAlign:e.textAlign||"center",textBaseline:e.textBaseline||"middle",scale:e.scale});var r=this.fillKey_;i&&(r in this.fillStates||(this.fillStates[r]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,o=this.textState_,r=this.strokeKey_,s=this.textKey_,a=this.fillKey_;this.saveTextStates_();var l=this.pixelRatio,h=ia[o.textBaseline],u=this.textOffsetY_*l,c=this.text_,p=o.scale,f=n?n.lineWidth*p/2:0;this.instructions.push([Fs,t,e,h,i,o.overflow,a,o.maxAngle,l,u,r,f*l,c,s,1]),this.hitDetectionInstructions.push([Fs,t,e,h,i,o.overflow,a,o.maxAngle,1,u,r,f,c,s,1/l])},e.prototype.setTextStyle=function(t,e){var i,n,o;if(t){this.declutterGroups_=e;var r=t.getFill();r?((n=this.textFillState_)||(n=this.textFillState_={}),n.fillStyle=wo(r.getColor()||"#000")):n=this.textFillState_=null;var s=t.getStroke();if(s){(o=this.textStrokeState_)||(o=this.textStrokeState_={});var a=s.getLineDash(),l=s.getLineDashOffset(),h=s.getWidth(),u=s.getMiterLimit();o.lineCap=s.getLineCap()||"round",o.lineDash=a?a.slice():Ro,o.lineDashOffset=void 0===l?0:l,o.lineJoin=s.getLineJoin()||"round",o.lineWidth=void 0===h?1:h,o.miterLimit=void 0===u?10:u,o.strokeStyle=wo(s.getColor()||"#000")}else o=this.textStrokeState_=null;i=this.textState_;var c=t.getFont()||"10px sans-serif";ko(c);var p=t.getScale();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||"middle",i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Lo,i.scale=void 0===p?1:p;var f=t.getOffsetX(),g=t.getOffsetY(),_=t.getRotateWithView(),v=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===g?0:g,this.textRotateWithView_=void 0!==_&&_,this.textRotation_=void 0===v?0:v,this.strokeKey_=o?("string"==typeof o.strokeStyle?o.strokeStyle:d(o.strokeStyle))+o.lineCap+o.lineDashOffset+"|"+o.lineWidth+o.lineJoin+o.miterLimit+"["+o.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+d(n.fillStyle):""}else this.text_=""},e}(Zs)},oa=function(){function t(t,e,i,n,o){this.declutter_=o,this.declutterGroups_=null,this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}return t.prototype.addDeclutter=function(t){var e=null;return this.declutter_&&(t?(e=this.declutterGroups_)[0][4]++:(e=this.declutterGroups_=[[1/0,1/0,-1/0,-1/0]])[0].push(1)),e},t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var n in i){var o=i[n].finish();t[e][n]=o}}return t},t.prototype.getBuilder=function(t,e){var i=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);var o=n[e];void 0===o&&(o=new(0,na[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=o);return o},t}();function ra(t,e,i,n,o,r,s,a,l,h,u){for(var c,p,f=[],d=t[e]>t[i-n],g=o.length,_=t[e],v=t[e+1],y=t[e+=n],m=t[e+1],x=0,E=Math.sqrt(Math.pow(y-_,2)+Math.pow(m-v,2)),T=!1,w=0;w<g;++w){for(var C=o[c=d?g-w-1:w],S=a*l(h,C,u),O=r+S/2;e<i-n&&x+E<O;)_=y,v=m,y=t[e+=n],m=t[e+1],x+=E,E=Math.sqrt(Math.pow(y-_,2)+Math.pow(m-v,2));var b=O-x,P=Math.atan2(m-v,y-_);if(d&&(P+=P>0?-Math.PI:Math.PI),void 0!==p){var I=P-p;if(T=T||0!==I,I+=I>Math.PI?-2*Math.PI:I<-Math.PI?2*Math.PI:0,Math.abs(I)>s)return null}p=P;var R=b/E,L=Q(_,y,R),M=Q(v,m,R);f[c]=[L,M,S/2,P,C],r+=S}return T?f:[[f[0][0],f[0][1],f[0][2],f[0][3],o]]}function sa(t,e,i,n,o){!function t(e,i,n,o,r){for(;o>n;){if(o-n>600){var s=o-n+1,a=i-n+1,l=Math.log(s),h=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*h*(s-h)/s)*(a-s/2<0?-1:1),c=Math.max(n,Math.floor(i-a*h/s+u)),p=Math.min(o,Math.floor(i+(s-a)*h/s+u));t(e,i,c,p,r)}var f=e[i],d=n,g=o;for(aa(e,n,i),r(e[o],f)>0&&aa(e,n,o);d<g;){for(aa(e,d,g),d++,g--;r(e[d],f)<0;)d++;for(;r(e[g],f)>0;)g--}0===r(e[n],f)?aa(e,n,g):aa(e,++g,o),g<=i&&(n=g+1),i<=g&&(o=g-1)}}(t,e,i||0,n||t.length-1,o||la)}function aa(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function la(t,e){return t<e?-1:t>e?1:0}class ha{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!xa(t,e))return i;const n=this.toBBox,o=[];for(;e;){for(let r=0;r<e.children.length;r++){const s=e.children[r],a=e.leaf?n(s):s;xa(t,a)&&(e.leaf?i.push(s):ma(t,a)?this._all(s,i):o.push(s))}e=o.pop()}return i}collides(t){let e=this.data;if(!xa(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const o=e.children[n],r=e.leaf?this.toBBox(o):o;if(xa(t,r)){if(e.leaf||ma(t,r))return!0;i.push(o)}}e=i.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Ea([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),o=[],r=[];let s,a,l;for(;i||o.length;){if(i||(i=o.pop(),a=o[o.length-1],s=r.pop(),l=!0),i.leaf){const n=ua(t,i.children,e);if(-1!==n)return i.children.splice(n,1),o.push(i),this._condense(o),this}l||i.leaf||!ma(i,n)?a?(s++,i=a.children[s],l=!1):i=null:(o.push(i),r.push(s),s=0,a=i,i=i.children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const o=i-e+1;let r,s=this._maxEntries;if(o<=s)return ca(r=Ea(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,n-1))),(r=Ea([])).leaf=!1,r.height=n;const a=Math.ceil(o/s),l=a*Math.ceil(Math.sqrt(s));Ta(t,e,i,l,this.compareMinX);for(let o=e;o<=i;o+=l){const e=Math.min(o+l-1,i);Ta(t,o,e,a,this.compareMinY);for(let i=o;i<=e;i+=a){const o=Math.min(i+a-1,e);r.children.push(this._build(t,i,o,n-1))}}return ca(r,this.toBBox),r}_chooseSubtree(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){let i,n=1/0,s=1/0;for(let a=0;a<e.children.length;a++){const l=e.children[a],h=_a(l),u=(o=t,r=l,(Math.max(r.maxX,o.maxX)-Math.min(r.minX,o.minX))*(Math.max(r.maxY,o.maxY)-Math.min(r.minY,o.minY))-h);u<s?(s=u,n=h<n?h:n,i=l):u===s&&h<n&&(n=h,i=l)}e=i||e.children[0]}var o,r;return e}_insert(t,e,i){const n=i?t:this.toBBox(t),o=[],r=this._chooseSubtree(n,this.data,e,o);for(r.children.push(t),fa(r,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)}_split(t,e){const i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);const r=this._chooseSplitIndex(i,o,n),s=Ea(i.children.splice(r,i.children.length-r));s.height=i.height,s.leaf=i.leaf,ca(i,this.toBBox),ca(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)}_splitRoot(t,e){this.data=Ea([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ca(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,o=1/0,r=1/0;for(let s=e;s<=i-e;s++){const e=pa(t,0,s,this.toBBox),a=pa(t,s,i,this.toBBox),l=ya(e,a),h=_a(e)+_a(a);l<o?(o=l,n=s,r=h<r?h:r):l===o&&h<r&&(r=h,n=s)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:da,o=t.leaf?this.compareMinY:ga;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,o)&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const o=this.toBBox,r=pa(t,0,e,o),s=pa(t,i-e,i,o);let a=va(r)+va(s);for(let n=e;n<i-e;n++){const e=t.children[n];fa(r,t.leaf?o(e):e),a+=va(r)}for(let n=i-e-1;n>=e;n--){const e=t.children[n];fa(s,t.leaf?o(e):e),a+=va(s)}return a}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)fa(e[n],t)}_condense(t){for(let e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():ca(t[i],this.toBBox)}}function ua(t,e,i){if(!i)return e.indexOf(t);for(let n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function ca(t,e){pa(t,0,t.children.length,e,t)}function pa(t,e,i,n,o){o||(o=Ea(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let r=e;r<i;r++){const e=t.children[r];fa(o,t.leaf?n(e):e)}return o}function fa(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function da(t,e){return t.minX-e.minX}function ga(t,e){return t.minY-e.minY}function _a(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function va(t){return t.maxX-t.minX+(t.maxY-t.minY)}function ya(t,e){const i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),o=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,o-i)*Math.max(0,r-n)}function ma(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function xa(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Ea(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ta(t,e,i,n,o){const r=[e,i];for(;r.length;){if((i=r.pop())-(e=r.pop())<=n)continue;const s=e+Math.ceil((i-e)/n/2)*n;sa(t,s,e,i,o),r.push(e,s,s,i)}}var wa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ca=[1/0,1/0,-1/0,-1/0],Sa=[1,0,0,1,0,0],Oa=[],ba=[],Pa=[],Ia=[],Ra=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.overlaps=n,r.pixelRatio=i,r.resolution=e,r.alignFill_,r.declutterItems=[],r.instructions=o.instructions,r.coordinates=o.coordinates,r.coordinateCache_={},r.renderedTransform_=[1,0,0,1,0,0],r.hitDetectionInstructions=o.hitDetectionInstructions,r.pixelCoordinates_=null,r.viewRotation_=0,r.fillStates=o.fillStates||{},r.strokeStates=o.strokeStates||{},r.textStates=o.textStates||{},r.widths_={},r}return wa(e,t),e.prototype.disposeInternal=function(){Mo.release(this),t.prototype.disposeInternal.call(this)},e.prototype.getTextImage=function(t,e,i,n){var o,r=n+e+t+i+this.pixelRatio;if(!Mo.containsKey(r)){var s=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],h=this.pixelRatio,u=l.scale*h,c=ia[l.textAlign||"center"],p=n&&s.lineWidth?s.lineWidth:0,f=t.split("\n"),d=f.length,g=[],_=function(t,e,i){for(var n=e.length,o=0,r=0;r<n;++r){var s=Yo(t,e[r]);o=Math.max(o,s),i.push(s)}return o}(l.font,f,g),v=Xo(l.font),y=v*d,m=_+p,x=k(Math.ceil((m+2)*u),Math.ceil((y+p)*u));o=x.canvas,Mo.set(r,o),1!=u&&x.scale(u,u),x.font=l.font,n&&(x.strokeStyle=s.strokeStyle,x.lineWidth=p,x.lineCap=s.lineCap,x.lineJoin=s.lineJoin,x.miterLimit=s.miterLimit,x.setLineDash&&s.lineDash.length&&(x.setLineDash(s.lineDash),x.lineDashOffset=s.lineDashOffset)),i&&(x.fillStyle=a.fillStyle),x.textBaseline="middle",x.textAlign="center";var E=.5-c,T=c*m+E*p,w=void 0;if(n)for(w=0;w<d;++w)x.strokeText(f[w],T+E*g[w],.5*(p+v)+w*v);if(i)for(w=0;w<d;++w)x.fillText(f[w],T+E*g[w],.5*(p+v)+w*v)}return Mo.get(r,this)},e.prototype.replayTextBackground_=function(t,e,i,n,o,r,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,o),t.lineTo.apply(t,e),r&&(this.alignFill_=r[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},e.prototype.replayImage_=function(t,e,i,n,o,r,s,a,l,h,u,c,p,f,d,g,_,v){var y=_||v;e-=o*=p,i-=r*=p;var m=d+h>n.width?n.width-h:d,x=a+u>n.height?n.height-u:a,E=g[3]+m*p+g[1],T=g[0]+x*p+g[2],w=e-g[3],C=i-g[0];(y||0!==c)&&(Oa[0]=Ia[0]=w,Oa[1]=ba[1]=C,ba[0]=Pa[0]=w+E,Pa[1]=Ia[1]=C+T);var S=null;if(0!==c){var O=e+o,b=i+r;S=Vi(Sa,O,b,1,1,c,-O,-b),Wi(Sa,Oa),Wi(Sa,ba),Wi(Sa,Pa),Wi(Sa,Ia),_t(Math.min(Oa[0],ba[0],Pa[0],Ia[0]),Math.min(Oa[1],ba[1],Pa[1],Ia[1]),Math.max(Oa[0],ba[0],Pa[0],Ia[0]),Math.max(Oa[1],ba[1],Pa[1],Ia[1]),Ca)}else _t(w,C,w+E,C+T,Ca);var P=t.canvas,I=v?v[2]*p/2:0,R=Ca[0]-I<=P.width&&Ca[2]+I>=0&&Ca[1]-I<=P.height&&Ca[3]+I>=0;if(f&&(e=Math.round(e),i=Math.round(i)),s){if(!R&&1==s[4])return;Tt(s,Ca);var L=R?[t,S?S.slice(0):null,l,n,h,u,m,x,e,i,p]:null;L&&(y&&L.push(_,v,Oa,ba,Pa,Ia),s.push(L))}else R&&(y&&this.replayTextBackground_(t,Oa,ba,Pa,Ia,_,v),Wo(t,S,l,n,h,u,m,x,e,i,p))},e.prototype.fill_=function(t){if(this.alignFill_){var e=Wi(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},e.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},e.prototype.renderDeclutter=function(t,e,i,n){if(t&&t.length>5){var o=t[4];if(1==o||o==t.length-5){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(n||(n=new ha(9)),!n.collides(r)){n.insert(r);for(var s=5,a=t.length;s<a;++s){var l=t[s],h=l[0],u=h.globalAlpha;u!==i&&(h.globalAlpha=i),l.length>11&&this.replayTextBackground_(l[0],l[13],l[14],l[15],l[16],l[11],l[12]),Wo.apply(void 0,l),u!==i&&(h.globalAlpha=u)}}t.length=5,vt(t)}}return n},e.prototype.drawTextImageWithPointPlacement_=function(t,e,i,n){var o=this.textStates[e],r=this.getTextImage(t,e,n,i),s=this.strokeStates[i],a=this.pixelRatio,l=ia[o.textAlign||"center"],h=ia[o.textBaseline||"middle"],u=s&&s.lineWidth?s.lineWidth:0;return{label:r,anchorX:l*(r.width/a-2*o.scale)+2*(.5-l)*u,anchorY:h*r.height/a+2*(.5-h)*u}},e.prototype.execute_=function(t,e,i,n,o,s){var a,l,h;this.declutterItems.length=0,this.pixelCoordinates_&&r(e,this.renderedTransform_)?a=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),a=Xi(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),l=this.renderedTransform_,h=e,l[0]=h[0],l[1]=h[1],l[2]=h[2],l[3]=h[3],l[4]=h[4],l[5]=h[5]);for(var u,c,p,f,d,g,_,v,y,m,x,E,T,w,C,S,O,b=0,P=i.length,I=0,R=0,L=0,M=null,F=null,A=this.coordinateCache_,D=this.viewRotation_,k={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:D},N=this.instructions!=i||this.overlaps?0:200;b<P;){var G=i[b];switch(G[0]){case Ps:(C=G[1]).getGeometry()?void 0===s||Nt(s,G[3])?++b:b=G[2]+1:b=G[2];break;case Is:R>N&&(this.fill_(t),R=0),L>N&&(t.stroke(),L=0),R||L||(t.beginPath(),f=d=NaN),++b;break;case Rs:var j=a[I=G[1]],X=a[I+1],Y=a[I+2]-j,z=a[I+3]-X,B=Math.sqrt(Y*Y+z*z);t.moveTo(j+B,X),t.arc(j,X,B,0,2*Math.PI,!0),++b;break;case Ls:t.closePath(),++b;break;case Ms:I=G[1],u=G[2];var K=G[3],W=G[4],Z=6==G.length?G[5]:void 0;k.geometry=K,k.feature=C,b in A||(A[b]=[]);var V=A[b];Z?Z(a,I,u,2,V):(V[0]=a[I],V[1]=a[I+1],V.length=2),W(V,k),++b;break;case As:I=G[1],u=G[2],m=G[3],c=G[4],p=G[5],y=o?null:G[6];var U=G[7],H=G[8],q=G[9],J=G[10],Q=G[11],$=G[12],tt=G[13],et=G[14];if(!m&&G.length>=19){x=G[18],E=G[19],T=G[20],w=G[21];var it=this.drawTextImageWithPointPlacement_(x,E,T,w);m=G[3]=it.label;var nt=G[22];c=G[4]=(it.anchorX-nt)*this.pixelRatio;var ot=G[23];p=G[5]=(it.anchorY-ot)*this.pixelRatio,U=G[7]=m.height,et=G[14]=m.width}var rt=void 0;G.length>24&&(rt=G[24]);var st=void 0,at=void 0,lt=void 0;G.length>16?(st=G[15],at=G[16],lt=G[17]):(st=Lo,at=lt=!1),Q&&($+=D);for(var ht=0,ut=0;I<u;I+=2)if(!(rt&&rt[ht++]<et/this.pixelRatio)){if(y){var ct=Math.floor(ut);y.length<ct+1&&((v=[1/0,1/0,-1/0,-1/0]).push(y[0][4]),y.push(v)),v=y[ct]}this.replayImage_(t,a[I],a[I+1],m,c,p,v,U,H,q,J,$,tt,n,et,st,at?M:null,lt?F:null),v&&(ut===Math.floor(ut)&&this.declutterItems.push(this,v,C),ut+=1/v[4])}++b;break;case Fs:var pt=G[1],ft=G[2],dt=G[3];v=o?null:G[4];var gt=G[5];w=G[6];var _t=G[7],vt=G[8],yt=G[9];T=G[10];var mt=G[11];x=G[12],E=G[13];var xt=G[14],Et=this.textStates[E],Tt=Et.font,wt=Et.scale*vt,Ct=void 0;Ct=Tt in this.widths_?this.widths_[Tt]:this.widths_[Tt]={};var St=os(a,pt,ft,2),Ot=wt*zo(Tt,x,Ct);if(gt||Ot<=St){var bt=this.textStates[E].textAlign,Pt=ra(a,pt,ft,2,x,(St-Ot)*ia[bt],_t,wt,zo,Tt,Ct);if(Pt){var It=void 0,Rt=void 0,Lt=void 0,Mt=void 0,Ft=void 0;if(T)for(It=0,Rt=Pt.length;It<Rt;++It)Lt=(Ft=Pt[It])[4],Mt=this.getTextImage(Lt,E,"",T),c=Ft[2]+mt,p=dt*Mt.height+2*(.5-dt)*mt-yt,this.replayImage_(t,Ft[0],Ft[1],Mt,c,p,v,Mt.height,1,0,0,Ft[3],xt,!1,Mt.width,Lo,null,null);if(w)for(It=0,Rt=Pt.length;It<Rt;++It)Lt=(Ft=Pt[It])[4],Mt=this.getTextImage(Lt,E,w,""),c=Ft[2],p=dt*Mt.height-yt,this.replayImage_(t,Ft[0],Ft[1],Mt,c,p,v,Mt.height,1,0,0,Ft[3],xt,!1,Mt.width,Lo,null,null)}}this.declutterItems.push(this,v,C),++b;break;case Ds:if(void 0!==o){var At=o(C=G[1]);if(At)return At}++b;break;case ks:N?R++:this.fill_(t),++b;break;case Ns:for(I=G[1],u=G[2],S=a[I],_=(O=a[I+1])+.5|0,(g=S+.5|0)===f&&_===d||(t.moveTo(S,O),f=g,d=_),I+=2;I<u;I+=2)g=(S=a[I])+.5|0,_=(O=a[I+1])+.5|0,I!=u-2&&g===f&&_===d||(t.lineTo(S,O),f=g,d=_);++b;break;case Gs:M=G,this.alignFill_=G[2],R&&(this.fill_(t),R=0,L&&(t.stroke(),L=0)),t.fillStyle=G[1],++b;break;case js:F=G,L&&(t.stroke(),L=0),this.setStrokeStyle_(t,G),++b;break;case Xs:N?L++:t.stroke(),++b;break;default:++b}}R&&this.fill_(t),L&&t.stroke()},e.prototype.execute=function(t,e,i,n){this.viewRotation_=i,this.execute_(t,e,this.instructions,n,void 0,void 0)},e.prototype.executeHitDetection=function(t,e,i,n,o){return this.viewRotation_=i,this.execute_(t,e,this.hitDetectionInstructions,!0,n,o)},e}(C),La=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ma=[Ho.POLYGON,Ho.CIRCLE,Ho.LINE_STRING,Ho.IMAGE,Ho.TEXT,Ho.DEFAULT],Fa=function(t){function i(e,i,n,o,r,s){var a=t.call(this)||this;return a.maxExtent_=e,a.overlaps_=o,a.pixelRatio_=n,a.resolution_=i,a.renderBuffer_=s,a.executorsByZIndex_={},a.hitDetectionContext_=null,a.hitDetectionTransform_=[1,0,0,1,0,0],a.createExecutors_(r),a}return La(i,t),i.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},i.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];void 0===i&&(this.executorsByZIndex_[e]=i={});var n=t[e];for(var o in n){var r=n[o];i[o]=new Ra(this.resolution_,this.pixelRatio_,this.overlaps_,r)}}},i.prototype.disposeInternal=function(){for(var e in this.executorsByZIndex_){var i=this.executorsByZIndex_[e];for(var n in i)i[n].disposeInternal()}if(this.hitDetectionContext_){var o=this.hitDetectionContext_.canvas;o.width=o.height=0}t.prototype.disposeInternal.call(this)},i.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[e],n=0,o=t.length;n<o;++n)if(t[n]in i)return!0;return!1},i.prototype.forEachFeatureAtCoordinate=function(t,i,n,o,r,s){var a=2*(o=Math.round(o))+1,l=Vi(this.hitDetectionTransform_,o+.5,o+.5,1/i,-1/i,-n,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=k(a,a));var h,u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):u.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(wt(h=[1/0,1/0,-1/0,-1/0],t),lt(h,i*(this.renderBuffer_+o),h));var c,p=function(t){if(void 0!==Aa[t])return Aa[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);var o=t,r=0,s=0;for(;o>=r;)Da(i,t+o,t+r),Da(i,t+r,t+o),Da(i,t-r,t+o),Da(i,t-o,t+r),Da(i,t-o,t-r),Da(i,t-r,t-o),Da(i,t+r,t-o),Da(i,t+o,t-r),2*((s+=1+2*++r)-o)+1>0&&(s+=1-2*(o-=1));return Aa[t]=i,i}(o);function f(t){for(var e=u.getImageData(0,0,a,a).data,i=0;i<a;i++)for(var n=0;n<a;n++)if(p[i][n]&&e[4*(n*a+i)+3]>0){var o=void 0;return(!s||c!=Ho.IMAGE&&c!=Ho.TEXT||-1!==s.indexOf(t))&&(o=r(t)),o||void u.clearRect(0,0,a,a)}}var d,g,_,v,y,m=Object.keys(this.executorsByZIndex_).map(Number);for(m.sort(e),d=m.length-1;d>=0;--d){var x=m[d].toString();for(_=this.executorsByZIndex_[x],g=Ma.length-1;g>=0;--g)if(void 0!==(v=_[c=Ma[g]])&&(y=v.executeHitDetection(u,l,n,f,h)))return y}},i.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var i=e[0],n=e[1],o=e[2],r=e[3],s=[i,n,i,r,o,r,o,n];return Xi(s,0,8,2,t,s),s},i.prototype.isEmpty=function(){return function(t){var e;for(e in t)return!1;return!e}(this.executorsByZIndex_)},i.prototype.execute=function(t,i,n,o,r,s){var a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(e),this.maxExtent_&&(t.save(),this.clip(t,i));var l,h,u,c,p,f,d=r||Ma;for(l=0,h=a.length;l<h;++l){var g=a[l].toString();for(p=this.executorsByZIndex_[g],u=0,c=d.length;u<c;++u){var _=d[u];if(void 0!==(f=p[_]))if(!s||_!=Ho.IMAGE&&_!=Ho.TEXT)f.execute(t,i,n,o);else{var v=s[g];v?v.push(f,i.slice(0)):s[g]=[f,i.slice(0)]}}}this.maxExtent_&&t.restore()},i}(C),Aa={0:[[!0]]};function Da(t,e,i){var n,o=Math.floor(t.length/2);if(e>=o)for(n=o;n<e;n++)t[n][i]=!0;else if(e<o)for(n=e+1;n<o;n++)t[n][i]=!0}var ka=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Na=function(t){function e(e){var i=t.call(this)||this;return i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=e,i}return ka(e,t),e.prototype.getFeatures=function(t){return p()},e.prototype.prepareFrame=function(t){return p()},e.prototype.renderFrame=function(t,e){return p()},e.prototype.loadedTileCallback=function(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,o){var r=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,o,r)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){},e.prototype.getDataAtPixel=function(t,e,i){return p()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===Uo.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=Uo.LOADED&&e!=Uo.ERROR&&t.addEventListener(P.CHANGE,this.boundHandleImageChange_),e==Uo.IDLE&&(t.load(),e=t.getState()),e==Uo.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Vn.READY&&t.changed()},e}(R),Ga=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ja=function(t){function e(e){var i=t.call(this,e)||this;return i.container=null,i.renderedResolution,i.tempTransform_=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i}return Ga(e,t),e.prototype.useContainer=function(t,e,i){var n,o,r=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===r&&((a=t.firstElementChild)instanceof HTMLCanvasElement&&(o=a.getContext("2d")));if(o&&o.canvas.style.transform===Hi(e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(n=document.createElement("div")).className=r;var s=n.style;s.position="absolute",s.width="100%",s.height="100%";var a=(o=k()).canvas;n.appendChild(a),(s=a.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=n,this.context=o}},e.prototype.clip=function(t,e,i){var n=e.pixelRatio,o=e.size[0]*n/2,r=e.size[1]*n/2,s=e.viewState.rotation,a=At(i),l=Dt(i),h=Pt(i),u=bt(i);Wi(e.coordinateToPixelTransform,a),Wi(e.coordinateToPixelTransform,l),Wi(e.coordinateToPixelTransform,h),Wi(e.coordinateToPixelTransform,u),t.save(),Bo(t,-s,o,r),t.beginPath(),t.moveTo(a[0]*n,a[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(h[0]*n,h[1]*n),t.lineTo(u[0]*n,u[1]*n),t.clip(),Bo(t,s,o,r)},e.prototype.clipUnrotated=function(t,e,i){var n=At(i),o=Dt(i),r=Pt(i),s=bt(i);Wi(e.coordinateToPixelTransform,n),Wi(e.coordinateToPixelTransform,o),Wi(e.coordinateToPixelTransform,r),Wi(e.coordinateToPixelTransform,s);var a=this.inversePixelTransform;Wi(a,n),Wi(a,o),Wi(a,r),Wi(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var o=new fo(t,this.inversePixelTransform,i,e);n.dispatchEvent(o)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(hi,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(ui,t,e)},e.prototype.getRenderTransform=function(t,e,i,n,o,r,s){var a=o/2,l=r/2,h=n/e,u=-h,c=-t[0]+s,p=-t[1];return Vi(this.tempTransform_,a,l,h,u,-i,c,p)},e.prototype.getDataAtPixel=function(t,e,i){var n,o=Wi(this.inversePixelTransform,t.slice()),r=this.context;try{n=r.getImageData(Math.round(o[0]),Math.round(o[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:n}return 0===n[3]?null:n},e}(Na),Xa={FRACTION:"fraction",PIXELS:"pixels"},Ya=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),za=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.extent=e,r.pixelRatio_=n,r.resolution=i,r.state=o,r}return Ya(e,t),e.prototype.changed=function(){this.dispatchEvent(P.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return p()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){p()},e}(b),Ba=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,n,Uo.IDLE)||this;return a.src_=o,a.image_=new Image,null!==r&&(a.image_.crossOrigin=r),a.unlisten_=null,a.state=Uo.IDLE,a.imageLoadFunction_=s,a}Ba(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Uo.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Mt(this.extent)/this.image_.height),this.state=Uo.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=Uo.IDLE&&this.state!=Uo.ERROR||(this.state=Uo.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=Ka(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}(za);function Ka(t,e,i){var n=t;if(n.src&&ei){var o=n.decode(),r=!0;return o.then((function(){r&&e()})).catch((function(t){r&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():i())})),function(){r=!1}}var s=[E(n,P.LOAD,e),E(n,P.ERROR,i)];return function(){s.forEach(T)}}var Wa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Za=function(t){function e(e,i,n,o,r,s){var a=t.call(this)||this;return a.hitDetectionImage_=null,a.image_=e||new Image,null!==o&&(a.image_.crossOrigin=o),a.canvas_=s?document.createElement("canvas"):null,a.color_=s,a.unlisten_=null,a.imageState_=r,a.size_=n,a.src_=i,a.tainted_,a}return Wa(e,t),e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===Uo.LOADED){this.tainted_=!1;var t=k(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(P.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=Uo.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=Uo.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],n=k(e,i);n.fillRect(0,0,e,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==Uo.IDLE){this.imageState_=Uo.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=Ka(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(){if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),i=e.data,n=this.color_[0]/255,o=this.color_[1]/255,r=this.color_[2]/255,s=0,a=i.length;s<a;s+=4)i[s]*=n,i[s+1]*=o,i[s+2]*=r;t.putImageData(e,0,0)}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(b);var Va={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Ua=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ha=function(t){function e(e){var i=this,n=e||{},o=void 0!==n.opacity?n.opacity:1,r=void 0!==n.rotation?n.rotation:0,s=void 0!==n.scale?n.scale:1,a=void 0!==n.rotateWithView&&n.rotateWithView;(i=t.call(this,{opacity:o,rotation:r,scale:s,rotateWithView:a})||this).anchor_=void 0!==n.anchor?n.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==n.anchorOrigin?n.anchorOrigin:Va.TOP_LEFT,i.anchorXUnits_=void 0!==n.anchorXUnits?n.anchorXUnits:Xa.FRACTION,i.anchorYUnits_=void 0!==n.anchorYUnits?n.anchorYUnits:Xa.FRACTION,i.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null;var l=void 0!==n.img?n.img:null,h=void 0!==n.imgSize?n.imgSize:null,u=n.src;ot(!(void 0!==u&&l),4),ot(!l||l&&h,5),void 0!==u&&0!==u.length||!l||(u=l.src||d(l)),ot(void 0!==u&&u.length>0,6);var c=void 0!==n.src?Uo.IDLE:Uo.LOADED;return i.color_=void 0!==n.color?yo(n.color):null,i.iconImage_=function(t,e,i,n,o,r){var s=To.get(e,n,r);return s||(s=new Za(t,e,i,n,o,r),To.set(e,n,r,s)),s}(l,u,h,i.crossOrigin_,c,i.color_),i.offset_=void 0!==n.offset?n.offset:[0,0],i.offsetOrigin_=void 0!==n.offsetOrigin?n.offsetOrigin:Va.TOP_LEFT,i.origin_=null,i.size_=void 0!==n.size?n.size:null,i}return Ua(e,t),e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==Xa.FRACTION||this.anchorYUnits_==Xa.FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==Xa.FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==Xa.FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=Va.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Va.TOP_RIGHT&&this.anchorOrigin_!=Va.BOTTOM_RIGHT||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=Va.BOTTOM_LEFT&&this.anchorOrigin_!=Va.BOTTOM_RIGHT||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Va.TOP_LEFT){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),this.offsetOrigin_!=Va.TOP_RIGHT&&this.offsetOrigin_!=Va.BOTTOM_RIGHT||(t[0]=i[0]-e[0]-t[0]),this.offsetOrigin_!=Va.BOTTOM_LEFT&&this.offsetOrigin_!=Va.BOTTOM_RIGHT||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(P.CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(P.CHANGE,t)},e}(ds);function qa(t,e,i){var n=[];if(i){var o=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*i.width),r=i.data[o],s=i.data[o+1],a=i.data[o+2];if(255===i.data[o+3]){var l=a+256*(s+256*r),h=Math.ceil(16777216/e.length);l%h==0&&n.push(e[l/h])}}return n}var Ja={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},Qa=!1;var $a=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),tl=function(t){function e(e){var i=t.call(this)||this;return i.projection_=he(e.projection),i.attributions_=el(e.attributions),i.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,i.loading=!1,i.state_=void 0!==e.state?e.state:Vn.READY,i.wrapX_=void 0!==e.wrapX&&e.wrapX,i}return $a(e,t),e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return p()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=el(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(F);function el(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var il=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),nl=function(t){function e(e){return(e=v({},e)).controls||(e.controls=function(t){var e=t||{},i=new We;return(void 0===e.zoom||e.zoom)&&i.push(new co(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new lo(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new ro(e.attributionOptions)),i}()),e.interactions||(e.interactions=function(t){var e=t||{},i=new We,n=new rr(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new Ir),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new cr({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new Or({condition:e.onFocusOnly?dr:void 0,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new $r),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new es({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new Br),i.push(new Zr({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new Jr({condition:e.onFocusOnly?dr:void 0,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new jr({duration:e.zoomDuration})),i}()),t.call(this,e)||this}return il(e,t),e.prototype.createRenderer=function(){return new or(this)},e}(to),rl=function(t,e,i,n,o){var r,s,a=8*o-n-1,l=(1<<a)-1,h=l>>1,u=-7,c=i?o-1:0,p=i?-1:1,f=t[e+c];for(c+=p,r=f&(1<<-u)-1,f>>=-u,u+=a;u>0;r=256*r+t[e+c],c+=p,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=n;u>0;s=256*s+t[e+c],c+=p,u-=8);if(0===r)r=1-h;else{if(r===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),r-=h}return(f?-1:1)*s*Math.pow(2,r-n)},sl=function(t,e,i,n,o,r){var s,a,l,h=8*r-o-1,u=(1<<h)-1,c=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:r-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+c>=1?p/l:p*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=u?(a=0,s=u):s+c>=1?(a=(e*l-1)*Math.pow(2,o),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,o),s=0));o>=8;t[i+f]=255&a,f+=d,a/=256,o-=8);for(s=s<<o|a,h+=o;h>0;t[i+f]=255&s,f+=d,s/=256,h-=8);t[i+f-d]|=128*g},al=ll;function ll(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}ll.Varint=0,ll.Fixed64=1,ll.Bytes=2,ll.Fixed32=5;var hl="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function ul(t){return t.type===ll.Bytes?t.readVarint()+t.pos:t.pos+1}function cl(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function pl(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var o=i.pos-1;o>=t;o--)i.buf[o+n]=i.buf[o]}function fl(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function dl(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function gl(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function _l(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function vl(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function yl(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function ml(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function xl(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function El(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Tl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function wl(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function Cl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}ll.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),o=n>>3,r=this.pos;this.type=7&n,t(o,e,this),this.pos===r&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Tl(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Cl(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Tl(this.buf,this.pos)+4294967296*Tl(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Tl(this.buf,this.pos)+4294967296*Cl(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=rl(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=rl(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,o,r=i.buf;if(o=r[i.pos++],n=(112&o)>>4,o<128)return cl(t,n,e);if(o=r[i.pos++],n|=(127&o)<<3,o<128)return cl(t,n,e);if(o=r[i.pos++],n|=(127&o)<<10,o<128)return cl(t,n,e);if(o=r[i.pos++],n|=(127&o)<<17,o<128)return cl(t,n,e);if(o=r[i.pos++],n|=(127&o)<<24,o<128)return cl(t,n,e);if(o=r[i.pos++],n|=(1&o)<<31,o<128)return cl(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&hl?function(t,e,i){return hl.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var n="",o=e;for(;o<i;){var r,s,a,l=t[o],h=null,u=l>239?4:l>223?3:l>191?2:1;if(o+u>i)break;1===u?l<128&&(h=l):2===u?128==(192&(r=t[o+1]))&&(h=(31&l)<<6|63&r)<=127&&(h=null):3===u?(r=t[o+1],s=t[o+2],128==(192&r)&&128==(192&s)&&((h=(15&l)<<12|(63&r)<<6|63&s)<=2047||h>=55296&&h<=57343)&&(h=null)):4===u&&(r=t[o+1],s=t[o+2],a=t[o+3],128==(192&r)&&128==(192&s)&&128==(192&a)&&((h=(15&l)<<18|(63&r)<<12|(63&s)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,u=1):h>65535&&(h-=65536,n+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),n+=String.fromCharCode(h),o+=u}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==ll.Bytes)return t.push(this.readVarint(e));var i=ul(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==ll.Bytes)return t.push(this.readSVarint());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==ll.Bytes)return t.push(this.readBoolean());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==ll.Bytes)return t.push(this.readFloat());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==ll.Bytes)return t.push(this.readDouble());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==ll.Bytes)return t.push(this.readFixed32());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==ll.Bytes)return t.push(this.readSFixed32());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==ll.Bytes)return t.push(this.readFixed64());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==ll.Bytes)return t.push(this.readSFixed64());var e=ul(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===ll.Varint)for(;this.buf[this.pos++]>127;);else if(e===ll.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ll.Fixed32)this.pos+=4;else{if(e!==ll.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),wl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),wl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),wl(this.buf,-1&t,this.pos),wl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),wl(this.buf,-1&t,this.pos),wl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,o,r=0;r<e.length;r++){if((n=e.charCodeAt(r))>55295&&n<57344){if(!o){n>56319||r+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):o=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,o=n;continue}n=o-55296<<10|n-56320|65536,o=null}else o&&(t[i++]=239,t[i++]=191,t[i++]=189,o=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&pl(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),sl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),sl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&pl(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,ll.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,fl,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,dl,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,vl,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,gl,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,_l,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,yl,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ml,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,xl,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,El,e)},writeBytesField:function(t,e){this.writeTag(t,ll.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ll.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ll.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ll.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ll.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ll.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ll.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ll.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ll.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ll.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Sl=function(){function t(){this.dataProjection=null,this.defaultFeatureProjection=null}return t.prototype.getReadOptions=function(t,e){var i;if(e){var n=e.dataProjection?he(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()===Xt.TILE_PIXELS&&(n=he(n)).setWorldExtent(e.extent),i={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(i)},t.prototype.adaptOptions=function(t){return v({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return p()},t.prototype.readFeature=function(t,e){return p()},t.prototype.readFeatures=function(t,e){return p()},t.prototype.readGeometry=function(t,e){return p()},t.prototype.readProjection=function(t){return p()},t.prototype.writeFeature=function(t,e){return p()},t.prototype.writeFeatures=function(t,e){return p()},t.prototype.writeGeometry=function(t,e){return p()},t}();var Ol=[1,0,0,1,0,0],bl=function(){function t(t,e,i,n,o){this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=n}return t.prototype.get=function(t){return this.properties_[t]},t.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===$.POINT?yt(this.flatCoordinates_):xt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},t.prototype.getFlatInteriorPoint=function(){if(!this.flatInteriorPoints_){var t=It(this.getExtent());this.flatInteriorPoints_=On(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_},t.prototype.getFlatInteriorPoints=function(){if(!this.flatInteriorPoints_){var t=cs(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=bn(this.flatCoordinates_,0,this.ends_,2,t)}return this.flatInteriorPoints_},t.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=is(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},t.prototype.getFlatMidpoints=function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,i=this.ends_,n=0,r=i.length;n<r;++n){var s=i[n],a=is(t,e,s,2,.5);o(this.flatMidpoints_,a),e=s}}return this.flatMidpoints_},t.prototype.getId=function(){return this.id_},t.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},t.prototype.getGeometry=function(){return this},t.prototype.getSimplifiedGeometry=function(t){return this},t.prototype.simplifyTransformed=function(t,e){return this},t.prototype.getProperties=function(){return this.properties_},t.prototype.getStride=function(){return 2},t.prototype.getStyleFunction=function(){},t.prototype.getType=function(){return this.type_},t.prototype.transform=function(t,e){var i=(t=he(t)).getExtent(),n=t.getWorldExtent(),o=Mt(n)/Mt(i);Vi(Ol,n[0],n[3],o,-o,0,0,0),Xi(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Ol,this.flatCoordinates_)},t}();bl.prototype.getEnds=bl.prototype.getEndss=function(){return this.ends_},bl.prototype.getFlatCoordinates=bl.prototype.getOrientedFlatCoordinates;var Pl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Il=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.dataProjection=new zt({code:"",units:Xt.TILE_PIXELS}),i.featureClass_=n.featureClass?n.featureClass:bl,i.geometryName_=n.geometryName,i.layerName_=n.layerName?n.layerName:"layer",i.layers_=n.layers?n.layers:null,i.idProperty_=n.idProperty,i}return Pl(e,t),e.prototype.readRawGeometry_=function(t,e,i,n){t.pos=e.geometry;for(var o=t.readVarint()+t.pos,r=1,s=0,a=0,l=0,h=0,u=0;t.pos<o;){if(!s){var c=t.readVarint();r=7&c,s=c>>3}s--,1===r||2===r?(a+=t.readSVarint(),l+=t.readSVarint(),1===r&&h>u&&(n.push(h),u=h),i.push(a,l),h+=2):7===r?h>u&&(i.push(i[u],i[u+1]),h+=2):ot(!1,59)}h>u&&(n.push(h),u=h)},e.prototype.createFeature_=function(t,e,i){var n,o=e.type;if(0===o)return null;var r,s=e.properties;this.idProperty_?(r=s[this.idProperty_],delete s[this.idProperty_]):r=e.id,s[this.layerName_]=e.layer.name;var a=[],l=[];this.readRawGeometry_(t,e,a,l);var h=function(t,e){var i;1===t?i=1===e?$.POINT:$.MULTI_POINT:2===t?i=1===e?$.LINE_STRING:$.MULTI_LINE_STRING:3===t&&(i=$.POLYGON);return i}(o,l.length);if(this.featureClass_===bl)(n=new this.featureClass_(h,a,l,s,r)).transform(i.dataProjection,i.featureProjection);else{var u=void 0;if(h==$.POLYGON){for(var c=[],p=0,f=0,d=0,g=l.length;d<g;++d){var _=l[d];Mn(a,p,_,2)||(c.push(l.slice(f,d)),f=d),p=_}u=c.length>1?new fs(a,ji.XY,c):new Nn(a,ji.XY,l)}else u=h===$.POINT?new Tn(a,ji.XY):h===$.LINE_STRING?new ss(a,ji.XY):h===$.POLYGON?new Nn(a,ji.XY,l):h===$.MULTI_POINT?new us(a,ji.XY):h===$.MULTI_LINE_STRING?new ls(a,ji.XY,l):null;n=new(0,this.featureClass_),this.geometryName_&&n.setGeometryName(this.geometryName_);var v=function(t,e,i){var n,o=i?he(i.featureProjection):null,r=i?he(i.dataProjection):null;if(n=o&&r&&!de(o,r)?(e?t.clone():t).transform(e?o:r,e?r:o):t,e&&i&&void 0!==i.decimals){var s=Math.pow(10,i.decimals);n===t&&(n=t.clone()),n.applyTransform((function(t){for(var e=0,i=t.length;e<i;++e)t[e]=Math.round(t[e]*s)/s;return t}))}return n}(u,!1,i);n.setGeometry(v),n.setId(r),n.setProperties(s,!0)}return n},e.prototype.getType=function(){return Ja.ARRAY_BUFFER},e.prototype.readFeatures=function(t,e){var i=this.layers_,n=this.adaptOptions(e),o=he(n.dataProjection);o.setWorldExtent(n.extent),n.dataProjection=o;var r=new al(t),s=r.readFields(Rl,{}),a=[];for(var l in s)if(!i||-1!=i.indexOf(l)){var h=s[l],u=h?[0,0,h.extent,h.extent]:null;o.setExtent(u);for(var c=0,p=h.length;c<p;++c){var f=Fl(r,h,c);a.push(this.createFeature_(r,f,n))}}return a},e.prototype.readProjection=function(t){return this.dataProjection},e.prototype.setLayers=function(t){this.layers_=t},e}(Sl);function Rl(t,e,i){if(3===t){var n={keys:[],values:[],features:[]},o=i.readVarint()+i.pos;i.readFields(Ll,n,o),n.length=n.features.length,n.length&&(e[n.name]=n)}}function Ll(t,e,i){if(15===t)e.version=i.readVarint();else if(1===t)e.name=i.readString();else if(5===t)e.extent=i.readVarint();else if(2===t)e.features.push(i.pos);else if(3===t)e.keys.push(i.readString());else if(4===t){for(var n=null,o=i.readVarint()+i.pos;i.pos<o;)n=1===(t=i.readVarint()>>3)?i.readString():2===t?i.readFloat():3===t?i.readDouble():4===t?i.readVarint64():5===t?i.readVarint():6===t?i.readSVarint():7===t?i.readBoolean():null;e.values.push(n)}}function Ml(t,e,i){if(1==t)e.id=i.readVarint();else if(2==t)for(var n=i.readVarint()+i.pos;i.pos<n;){var o=e.layer.keys[i.readVarint()],r=e.layer.values[i.readVarint()];e.properties[o]=r}else 3==t?e.type=i.readVarint():4==t&&(e.geometry=i.pos)}function Fl(t,e,i){t.pos=e.features[i];var n=t.readVarint()+t.pos,o={layer:e,type:0,properties:{}};return t.readFields(Ml,o,n),o}var Al="preload",Dl="useInterimTilesOnError",kl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Nl=function(t){function e(e){var i=this,n=e||{},o=v({},n);return delete o.preload,delete o.useInterimTilesOnError,(i=t.call(this,o)||this).setPreload(void 0!==n.preload?n.preload:0),i.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),i}return kl(e,t),e.prototype.getPreload=function(){return this.get(Al)},e.prototype.setPreload=function(t){this.set(Al,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Dl)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Dl,t)},e}(io),Gl=function(){function t(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function jl(t,e,i,n,o){return void 0!==o?(o.minX=t,o.maxX=e,o.minY=i,o.maxY=n,o):new Gl(t,e,i,n)}var Xl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Yl=function(t){function i(e){var i=t.call(this,e)||this;return i.extentChanged=!0,i.renderedExtent_=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.newTiles_=!1,i.tmpExtent=[1/0,1/0,-1/0,-1/0],i.tmpTileRange_=new Gl(0,0,0,0),i}return Xl(i,t),i.prototype.isDrawableTile=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==di.LOADED||i==di.EMPTY||i==di.ERROR&&!n},i.prototype.getTile=function(t,e,i,n){var o=n.pixelRatio,r=n.viewState.projection,s=this.getLayer(),a=s.getSource().getTile(t,e,i,o,r);return a.getState()==di.ERROR&&(s.getUseInterimTilesOnError()?s.getPreload()>0&&(this.newTiles_=!0):a.setState(di.LOADED)),this.isDrawableTile(a)||(a=a.getInterimTile()),a},i.prototype.loadedTileCallback=function(e,i,n){return!!this.isDrawableTile(n)&&t.prototype.loadedTileCallback.call(this,e,i,n)},i.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},i.prototype.renderFrame=function(t,i){var n=t.layerStatesArray[t.layerIndex],o=t.viewState,r=o.projection,s=o.resolution,a=o.center,l=o.rotation,h=t.pixelRatio,u=this.getLayer(),c=u.getSource(),p=c.getRevision(),f=c.getTileGridForProjection(r),g=f.getZForResolution(s,c.zDirection),_=f.getResolution(g),v=t.extent,y=n.extent&&Oe(n.extent,r);y&&(v=Ft(v,Oe(n.extent,r)));var m=c.getTilePixelRatio(h),x=Math.round(t.size[0]*m),E=Math.round(t.size[1]*m);l&&(x=E=Math.round(Math.sqrt(x*x+E*E)));var T=_*x/2/m,w=_*E/2/m,C=[a[0]-T,a[1]-w,a[0]+T,a[1]+w],S=f.getTileRangeForExtentAndZ(v,g),O={};O[g]={};var b=this.createLoadedTileFinder(c,r,O),P=this.tmpExtent,I=this.tmpTileRange_;this.newTiles_=!1;for(var R=S.minX;R<=S.maxX;++R)for(var L=S.minY;L<=S.maxY;++L){var M=this.getTile(g,R,L,t);if(this.isDrawableTile(M)){var F=d(this);if(M.getState()==di.LOADED){O[g][M.tileCoord.toString()]=M;var A=M.inTransition(F);this.newTiles_||!A&&-1!==this.renderedTiles.indexOf(M)||(this.newTiles_=!0)}if(1===M.getAlpha(F,t.time))continue}var D=f.getTileCoordChildTileRange(M.tileCoord,I,P),k=!1;D&&(k=b(g+1,D)),k||f.forEachTileCoordParentTileRange(M.tileCoord,b,I,P)}var N=_/s;Vi(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/m,1/m,l,-x/2,-E/2),this.useContainer(i,this.pixelTransform,n.opacity);var G=this.context,j=G.canvas;Ui(this.inversePixelTransform,this.pixelTransform),Vi(this.tempTransform_,x/2,E/2,N,N,0,-x/2,-E/2),j.width!=x||j.height!=E?(j.width=x,j.height=E):this.containerReused||G.clearRect(0,0,x,E),y&&this.clipUnrotated(G,t,y),this.preRender(G,t),this.renderedTiles.length=0;var X,Y,z,B=Object.keys(O).map(Number);B.sort(e),1!==n.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(X=[],Y=[]):B=B.reverse();for(var K=B.length-1;K>=0;--K){var W=B[K],Z=c.getTilePixelSize(W,h,r),V=f.getResolution(W)/_,U=Z[0]*V*N,H=Z[1]*V*N,q=f.getTileCoordForCoordAndZ(At(C),W),J=f.getTileCoordExtent(q),Q=Wi(this.tempTransform_,[m*(J[0]-C[0])/_,m*(C[3]-J[3])/_]),$=m*c.getGutterForProjection(r),tt=O[W];for(var et in tt){var it=(M=tt[et]).tileCoord,nt=Q[0]-(q[1]-it[1])*U,ot=Math.round(nt+U),rt=Q[1]-(q[2]-it[2])*H,st=Math.round(rt+H),at=ot-(R=Math.round(nt)),lt=st-(L=Math.round(rt)),ht=g===W;if(!(A=ht&&1!==M.getAlpha(d(this),t.time)))if(X){G.save(),z=[R,L,R+at,L,R+at,L+lt,R,L+lt];for(var ut=0,ct=X.length;ut<ct;++ut)if(g!==W&&W<Y[ut]){var pt=X[ut];G.beginPath(),G.moveTo(z[0],z[1]),G.lineTo(z[2],z[3]),G.lineTo(z[4],z[5]),G.lineTo(z[6],z[7]),G.moveTo(pt[6],pt[7]),G.lineTo(pt[4],pt[5]),G.lineTo(pt[2],pt[3]),G.lineTo(pt[0],pt[1]),G.clip()}X.push(z),Y.push(W)}else G.clearRect(R,L,at,lt);this.drawTileImage(M,t,R,L,at,lt,$,ht,n.opacity),X&&!A&&G.restore(),this.renderedTiles.push(M),this.updateUsedTiles(t.usedTiles,c,M)}}this.renderedRevision=p,this.renderedResolution=_,this.extentChanged=!this.renderedExtent_||!Et(this.renderedExtent_,C),this.renderedExtent_=C,this.renderedPixelRatio=h,this.renderedProjection=r,this.manageTilePyramid(t,c,f,h,r,v,g,u.getPreload()),this.updateCacheSize_(t,c),this.scheduleExpireCache(t,c),this.postRender(G,t),n.extent&&G.restore();var ft=Hi(this.pixelTransform);return ft!==j.style.transform&&(j.style.transform=ft),this.container},i.prototype.drawTileImage=function(t,e,i,n,o,r,s,a,l){var h=this.getTileImage(t);if(h){var u=d(this),c=a?t.getAlpha(u,e.time):1,p=l*c,f=p!==this.context.globalAlpha;f&&(this.context.save(),this.context.globalAlpha=p),this.context.drawImage(h,s,s,h.width-2*s,h.height-2*s,i,n,o,r),f&&this.context.restore(),1!==c?e.animate=!0:a&&t.endTransition(u)}},i.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},i.prototype.getTileImage=function(t){return t.getImage()},i.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var n=d(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}},i.prototype.updateUsedTiles=function(t,e,i){var n=d(e);n in t||(t[n]={}),t[n][i.getKey()]=!0},i.prototype.updateCacheSize_=function(t,e){var i=d(e),n=0;i in t.usedTiles&&(n+=Object.keys(t.usedTiles[i]).length),i in t.wantedTiles&&(n+=Object.keys(t.wantedTiles[i]).length);var o=e.tileCache;o.highWaterMark<n&&(o.highWaterMark=n)},i.prototype.manageTilePyramid=function(t,e,i,n,o,r,s,a,l){var h=d(e);h in t.wantedTiles||(t.wantedTiles[h]={});var u,c,p,f,g,_,v=t.wantedTiles[h],y=t.tileQueue;for(_=i.getMinZoom();_<=s;++_)for(c=i.getTileRangeForExtentAndZ(r,_,c),p=i.getResolution(_),f=c.minX;f<=c.maxX;++f)for(g=c.minY;g<=c.maxY;++g)s-_<=a?((u=e.getTile(_,f,g,n,o)).getState()==di.IDLE&&(v[u.getKey()]=!0,y.isKeyQueued(u.getKey())||y.enqueue([u,h,i.getTileCoordCenter(u.tileCoord),p])),void 0!==l&&l(u)):e.useTile(_,f,g,o)},i}(ja);Yl.prototype.getLayer;var zl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bl=function(t){function e(e){return t.call(this,e)||this}return zl(e,t),e.prototype.createRenderer=function(){return new Yl(this)},e}(Nl),Kl={IMAGE:"image",HYBRID:"hybrid"},Wl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zl={image:[Ho.POLYGON,Ho.CIRCLE,Ho.LINE_STRING,Ho.IMAGE,Ho.TEXT],hybrid:[Ho.POLYGON,Ho.LINE_STRING]},Vl={image:[Ho.DEFAULT],hybrid:[Ho.IMAGE,Ho.TEXT,Ho.DEFAULT]},Ul=function(t){function i(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.overlayContext_=null,i.overlayContextUid_,i.overlayPixelTransform_=[1,0,0,1,0,0],i.inverseOverlayPixelTransform_=[1,0,0,1,0,0],i.dirty_=!1,i.renderedLayerRevision_,i.renderedPixelToCoordinateTransform_=null,i.renderedRotation_,i.renderTileImageQueue_={},i.tileListenerKeys_={},i.tmpTransform_=[1,0,0,1,0,0],i}return Wl(i,t),i.prototype.useContainer=function(e,i,n){var o;e&&2===e.childElementCount&&((o=e.lastElementChild.getContext("2d"))||(e=null));var r=this.containerReused;if(t.prototype.useContainer.call(this,e,i,n),r&&(this.overlayContext_=o||null,this.overlayContextUid_=o?d(o):void 0),!this.overlayContext_){var s=k(),a=s.canvas.style;a.position="absolute",a.left="0",a.transformOrigin="top left",this.overlayContext_=s,this.overlayContextUid_=d(s)}1===this.container.childElementCount&&this.container.appendChild(this.overlayContext_.canvas)},i.prototype.prepareTile=function(t,e,i,n){var o,r=d(t),s=t.getState();return(s===di.LOADED&&t.hifi||s===di.ERROR||s===di.ABORT)&&r in this.tileListenerKeys_&&(T(this.tileListenerKeys_[r]),delete this.tileListenerKeys_[r]),s!==di.LOADED&&s!==di.ERROR||(this.updateExecutorGroup_(t,e,i),this.tileImageNeedsRender_(t,e,i)&&(o=!0,n&&(this.renderTileImageQueue_[r]=t))),o},i.prototype.getTile=function(e,i,n,o){var r=t.prototype.getTile.call(this,e,i,n,o),s=o.pixelRatio,a=o.viewState,l=a.resolution,h=a.projection;if(r.getState()<di.LOADED){r.wantedResolution=l;var u=d(r);if(!(u in this.tileListenerKeys_)){var c=x(r,P.CHANGE,this.prepareTile.bind(this,r,s,h,!0));this.tileListenerKeys_[u]=c}}else{var p=o.viewHints;!!(p[bi]||p[Pi])&&r.wantedResolution||(r.wantedResolution=l),this.prepareTile(r,s,h,!1)&&this.renderTileImage_(r,o)}return r},i.prototype.isDrawableTile=function(e){return t.prototype.isDrawableTile.call(this,e)&&e.hasContext(this.getLayer())},i.prototype.getTileImage=function(t){return t.getImage(this.getLayer())},i.prototype.prepareFrame=function(e){e.layerStatesArray[e.layerIndex].hasOverlay=!0;var i=this.getLayer().getRevision();return this.renderedLayerRevision_!=i&&(this.renderedTiles.length=0),this.renderedLayerRevision_=i,t.prototype.prepareFrame.call(this,e)},i.prototype.updateExecutorGroup_=function(t,e,i){var n=this.getLayer(),o=n.getRevision(),r=n.getRenderOrder()||null,s=t.wantedResolution,a=t.getReplayState(n);if(a.dirty||a.renderedResolution!==s||a.renderedRevision!=o||a.renderedRenderOrder!=r||a.renderedZ!==t.sourceZ){var l=n.getSource(),h=l.getTileGrid(),u=l.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),c=l.getSourceTiles(e,i,t),p=d(n),f=t.executorGroups[p];if(f)for(var g=0,_=f.length;g<_;++g)f[g].dispose();t.executorGroups[p]=[];for(var v=function(i,o){var f=c[i];if(f.getState()!=di.LOADED)return"continue";var d=f.tileCoord,g=h.getTileCoordExtent(d),_=Ft(u,g),v=Et(g,_)?null:lt(_,n.getRenderBuffer()*s,y.tmpExtent);a.dirty=!1;var m=new oa(0,_,s,e,n.getDeclutter()),x=Qo(s,e),E=function(t){var e,i=t.getStyleFunction()||n.getStyleFunction();if(i&&(e=i(t,s)),e){var o=this.renderFeature(t,x,e,m);this.dirty_=this.dirty_||o,a.dirty=a.dirty||o}},T=f.getFeatures();r&&r!==a.renderedRenderOrder&&T.sort(r),f.hitDetectionImageData=null;for(var w=0,C=T.length;w<C;++w){var S=T[w];v&&!Nt(v,S.getGeometry().getExtent())||E.call(y,S)}var O=m.finish(),b=n.getDeclutter()&&1===c.length?null:_,P=new Fa(b,s,e,l.getOverlaps(),O,n.getRenderBuffer());t.executorGroups[p].push(P)},y=this,m=0,x=c.length;m<x;++m)v(m);a.renderedRevision=o,a.renderedZ=t.sourceZ,a.renderedRenderOrder=r,a.renderedResolution=s}},i.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){var r=e.viewState.resolution,s=e.viewState.rotation;i=null==i?0:i;var a,l,h,u=this.getLayer(),c=u.getDeclutter(),p=u.getSource().getTileGridForProjection(e.viewState.projection),f={},g=this.renderedTiles,_=function(){var e=g[l],h=ct(p.getTileCoordExtent(e.wrappedTileCoord),t);if(!c&&!h)return"continue";for(var _=e.executorGroups[d(u)],v=0,y=_.length;v<y;++v){var m=_[v];a=a||m.forEachFeatureAtCoordinate(t,r,s,i,(function(t){if(h||o&&-1!==o.indexOf(t)){var e=t.getId();if(void 0===e&&(e=d(t)),!(e in f))return f[e]=!0,n(t,u)}}),u.getDeclutter()?o:null)}};for(l=0,h=g.length;l<h;++l)_();return a},i.prototype.getFeatures=function(t){return new Promise(function(i,n){for(var o,r=this.getLayer(),s=r.getSource(),a=this.renderedProjection,l=a.getExtent(),h=this.renderedResolution,u=this.renderedPixelRatio,c=s.getTileGridForProjection(a),p=s.getTileGrid(),f=Wi(this.renderedPixelToCoordinateTransform_,t.slice()),d=c.getTileCoordForCoordAndResolution(f,h),g=0,_=this.renderedTiles.length;g<_;++g)if(d.toString()===this.renderedTiles[g].tileCoord.toString()){var v=this.renderedTiles[g];if(v.getState()===di.LOADED&&v.hifi){var y=c.getTileCoordExtent(d);if(s.getWrapX()&&a.canWrapX()&&!pt(l,y)){var m=kt(l),x=Math.floor((f[0]-l[0])/m);f[0]-=x*m}for(var E=s.getSourceTiles(u,a,v),T=p.getTileCoordForCoordAndResolution(f,h),w=0,C=E.length;w<C;++w)if(T.toString()===E[w].tileCoord.toString()){o=E[w];break}}break}if(o){var S=At(c.getTileCoordExtent(o.tileCoord)),O=[(f[0]-S[0])/h,(S[1]-f[1])/h];if(o.hitDetectionImageData)i(qa(O,o.getFeatures(),o.hitDetectionImageData));else{var b=Jn(p.getTileSize(p.getZForResolution(h))),P=[b[0]/2,b[1]/2],I=this.renderedRotation_,R=[this.getRenderTransform(c.getTileCoordCenter(o.tileCoord),h,0,.5,P[0],P[1],0)];requestAnimationFrame((function(){o.hitDetectionImageData=function(t,i,n,o,r,s,a){var l=k(t[0]/2,t[1]/2);l.imageSmoothingEnabled=!1;for(var h=l.canvas,u=new Vo(l,.5,r,null,a),c=n.length,p=Math.ceil(16777216/c),f={},d=0;d<c;++d){var g=n[d],_=g.getStyleFunction()||o;if(o){var v=_(g,s);Array.isArray(v)||(v=[v]);for(var y="#"+("000000"+(d*p).toString(16)).slice(-6),m=0,x=v.length;m<x;++m){var E=v[m],T=E.clone(),w=T.getFill();w&&w.setColor(y);var C=T.getStroke();C&&C.setColor(y),T.setText(void 0);var S=E.getImage();if(S){var O=S.getImageSize(),b=k(O[0],O[1]);b.fillStyle=y;var P=b.canvas;b.fillRect(0,0,P.width,P.height),k(O?O[0]:P.width,O?O[1]:P.height).drawImage(P,0,0),T.setImage(new Ha({img:P,imgSize:O,anchor:S.getAnchor(),anchorXUnits:Xa.PIXELS,anchorYUnits:Xa.PIXELS,offset:S.getOrigin(),size:S.getSize(),opacity:S.getOpacity(),scale:S.getScale(),rotation:S.getRotation(),rotateWithView:S.getRotateWithView()}))}var I=Number(T.getZIndex());(F=f[I])||((F=f[I]={})[$.POLYGON]=[],F[$.CIRCLE]=[],F[$.LINE_STRING]=[],F[$.POINT]=[]);var R=T.getGeometryFunction()(g);R&&Nt(r,R.getExtent())&&F[R.getType().replace("Multi","")].push(R,T)}}}for(var L=Object.keys(f).map(Number).sort(e),M=(d=0,L.length);d<M;++d){var F=f[L[d]];for(var A in F){var D=F[A];for(m=0,x=D.length;m<x;m+=2){u.setStyle(D[m+1]);for(var N=0,G=i.length;N<G;++N)u.setTransform(i[N]),u.drawGeometry(D[m])}}}return l.getImageData(0,0,h.width,h.height)}(b,R,o.getFeatures(),r.getStyleFunction(),c.getTileCoordExtent(o.tileCoord),h,I),i(qa(O,o.getFeatures(),o.hitDetectionImageData))}))}}else i([])}.bind(this))},i.prototype.handleFontsChanged=function(){y(this.renderTileImageQueue_);var t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},i.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},i.prototype.renderFrame=function(i,n){var o=i.viewHints,r=!(o[bi]||o[Pi]);this.renderQueuedTileImages_(r,i),t.prototype.renderFrame.call(this,i,n),this.renderedPixelToCoordinateTransform_=i.pixelToCoordinateTransform.slice(),this.renderedRotation_=i.viewState.rotation;var s=this.getLayer(),a=s.getRenderMode();if(a===Kl.IMAGE)return this.container;var l=s.getSource(),h=i.usedTiles[d(l)];for(var u in this.renderTileImageQueue_)h&&u in h||delete this.renderTileImageQueue_[u];var c=this.overlayContext_,p=s.getDeclutter()?{}:null,f=Vl[a],g=i.pixelRatio,_=i.viewState,v=_.center,y=_.resolution,m=_.rotation,x=i.size;!function(t,e,i){Ki(t,e,0,0,i,0,0)}(this.overlayPixelTransform_,1/g,1/g),Ui(this.inverseOverlayPixelTransform_,this.overlayPixelTransform_);var E=c.canvas,T=Math.round(x[0]*g),w=Math.round(x[1]*g);if(E.width!=T||E.height!=w){E.width=T,E.height=w;var C=Hi(this.overlayPixelTransform_);E.style.transform!==C&&(E.style.transform=C)}else d(c)===this.overlayContextUid_&&c.clearRect(0,0,T,w);for(var S=this.renderedTiles,O=l.getTileGridForProjection(i.viewState.projection),b=[],P=[],I=S.length-1;I>=0;--I){var R=S[I];if(R.getState()!=di.ABORT)for(var L=R.tileCoord,M=O.getTileCoordExtent(R.wrappedTileCoord),F=O.getTileCoordExtent(L,this.tmpExtent)[0]-M[0],A=this.getRenderTransform(v,y,m,g,T,w,F),D=R.executorGroups[d(s)],k=!1,N=0,G=D.length;N<G;++N){var j=D[N];if(j.hasExecutors(f)){var X=R.tileCoord[0],Y=void 0;if(!p&&!k){Y=j.getClipCoords(A),c.save();for(var z=0,B=b.length;z<B;++z){var K=b[z];X<P[z]&&(c.beginPath(),c.moveTo(Y[0],Y[1]),c.lineTo(Y[2],Y[3]),c.lineTo(Y[4],Y[5]),c.lineTo(Y[6],Y[7]),c.moveTo(K[6],K[7]),c.lineTo(K[4],K[5]),c.lineTo(K[2],K[3]),c.lineTo(K[0],K[1]),c.clip())}}j.execute(c,A,m,r,f,p),p||k||(c.restore(),b.push(Y),P.push(X),k=!0)}}}p&&function(t,i,n,o,r,s){for(var a=Object.keys(t).map(Number).sort(e),l=0,h=a.length;l<h;++l)for(var u=t[a[l].toString()],c=void 0,p=0,f=u.length;p<f;){var d=u[p++];d!==c&&(c=d,s.push({items:d.declutterItems,opacity:o}));var g=u[p++];d.execute(i,g,n,r)}}(p,c,m,i.layerStatesArray[i.layerIndex].opacity,r,i.declutterItems);return this.container},i.prototype.renderQueuedTileImages_=function(t,e){for(var i in this.renderTileImageQueue_){if(!t&&Date.now()-e.time>8){e.animate=!0;break}var n=this.renderTileImageQueue_[i];delete this.renderTileImageQueue_[i],this.renderTileImage_(n,e)}},i.prototype.renderFeature=function(t,e,i,n){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var r=0,s=i.length;r<s;++r)o=$o(n,t,i[r],e,this.boundHandleStyleImageChange_)||o;else o=$o(n,t,i,e,this.boundHandleStyleImageChange_);return o},i.prototype.tileImageNeedsRender_=function(t,e,i){var n=this.getLayer(),o=t.getReplayState(n),r=n.getRevision(),s=t.sourceZ,a=t.wantedResolution;return o.renderedTileResolution!==a||o.renderedTileRevision!==r||o.renderedTileZ!==s},i.prototype.renderTileImage_=function(t,e){var i=this.getLayer(),n=t.getReplayState(i),o=i.getRevision(),r=t.executorGroups[d(i)];n.renderedTileRevision=o,n.renderedTileZ=t.sourceZ;var s=t.wrappedTileCoord,a=s[0],l=i.getSource(),h=e.pixelRatio,u=e.viewState.projection,c=l.getTileGridForProjection(u),p=c.getResolution(t.tileCoord[0]),f=e.pixelRatio/t.wantedResolution*p,g=c.getResolution(a),_=t.getContext(i);h=Math.max(h,f/h);var v=l.getTilePixelSize(a,h,u);_.canvas.width=v[0],_.canvas.height=v[1];var y=h/f;if(1!==y){var m=zi(this.tmpTransform_);Zi(m,y,y),_.setTransform.apply(_,m)}var x=c.getTileCoordExtent(s,this.tmpExtent),E=f/g,T=zi(this.tmpTransform_);Zi(T,E,-E),function(t,e,i){Bi(t,Ki(Yi,1,0,0,1,e,i))}(T,-x[0],-x[3]);for(var w=0,C=r.length;w<C;++w){r[w].execute(_,T,0,!0,Zl[i.getRenderMode()])}n.renderedTileResolution=t.wantedResolution},i.prototype.getDataAtPixel=function(e,i,n){var o=t.prototype.getDataAtPixel.call(this,e,i,n);if(o)return o;var r=Wi(this.inverseOverlayPixelTransform_,e.slice()),s=this.overlayContext_;try{o=s.getImageData(Math.round(r[0]),Math.round(r[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:o}return 0===o[3]?null:o},i}(Yl),Hl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ql=function(t){function e(e){var i=this,n=e||{},o=v({},n);delete o.preload,delete o.useInterimTilesOnError,i=t.call(this,o)||this;var r=n.renderMode||Kl.HYBRID;return ot(null==r||r==Kl.IMAGE||r==Kl.HYBRID,28),i.renderMode_=r,i.setPreload(n.preload?n.preload:0),i.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),i}return Hl(e,t),e.prototype.createRenderer=function(){return new Ul(this)},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderMode=function(){return this.renderMode_},e.prototype.getPreload=function(){return this.get(Al)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Dl)},e.prototype.setPreload=function(t){this.set(Al,t)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Dl,t)},e}(bs),Jl=.5,Ql=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$l=function(t){function e(e,i,n){var o=t.call(this)||this,r=n||{};return o.hitDetectionImageData=null,o.tileCoord=e,o.state=i,o.interimTile=null,o.hifi=!0,o.key="",o.transition_=void 0===r.transition?250:r.transition,o.transitionStarts_={},o}return Ql(e,t),e.prototype.changed=function(){this.dispatchEvent(P.CHANGE)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==di.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==di.LOADED){t.interimTile=null;break}t.getState()==di.LOADING?e=t:t.getState()==di.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==di.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){p()},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Di(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(b),th=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),eh=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,s)||this;return a.crossOrigin_=o,a.src_=n,a.image_=new Image,null!==o&&(a.image_.crossOrigin=o),a.unlisten_=null,a.tileLoadFunction_=r,a}return th(e,t),e.prototype.disposeInternal=function(){this.state==di.LOADING&&(this.unlistenImage_(),this.image_=ih()),this.interimTile&&this.interimTile.dispose(),this.state=di.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=di.ERROR,this.unlistenImage_(),this.image_=ih(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=di.LOADED:this.state=di.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==di.ERROR&&(this.state=di.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==di.IDLE&&(this.state=di.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Ka(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}($l);function ih(){var t=k(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}function nh(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function oh(t,e,i){return t+"/"+e+"/"+i}function rh(t){return oh(t[0],t[1],t[2])}var sh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ah=function(t){function e(e){return t.call(this,e)||this}return sh(e,t),e.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(rh(e.tileCoord)),e.dispose())}.bind(this))}},e}(bo);function lh(t,e,i,n){var o=i-t,r=n-e,s=Math.sqrt(o*o+r*r);return[Math.round(i+o/s),Math.round(n+r/s)]}function hh(t,e,i,n,o,r,s,a,l,h,u){var c=k(Math.round(i*t),Math.round(i*e));if(0===l.length)return c.canvas;c.scale(i,i);var p=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,i){Tt(p,t.extent)}));var f=kt(p),d=Mt(p),g=k(Math.round(i*f/n),Math.round(i*d/n)),_=i/n;l.forEach((function(t,e,i){var n=t.extent[0]-p[0],o=-(t.extent[3]-p[3]),r=kt(t.extent),s=Mt(t.extent);g.drawImage(t.image,h,h,t.image.width-2*h,t.image.height-2*h,n*_,o*_,r*_,s*_)}));var v=At(s);return a.getTriangles().forEach((function(t,e,o){var s=t.source,a=t.target,l=s[0][0],h=s[0][1],u=s[1][0],f=s[1][1],d=s[2][0],_=s[2][1],y=(a[0][0]-v[0])/r,m=-(a[0][1]-v[1])/r,x=(a[1][0]-v[0])/r,E=-(a[1][1]-v[1])/r,T=(a[2][0]-v[0])/r,w=-(a[2][1]-v[1])/r,C=l,S=h;l=0,h=0;var O=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,o=Math.abs(t[i][i]),r=i+1;r<e;r++){var s=Math.abs(t[r][i]);s>o&&(o=s,n=r)}if(0===o)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var l=i+1;l<e;l++)for(var h=-t[l][i]/t[i][i],u=i;u<e+1;u++)i==u?t[l][u]=0:t[l][u]+=h*t[i][u]}for(var c=new Array(e),p=e-1;p>=0;p--){c[p]=t[p][e]/t[p][p];for(var f=p-1;f>=0;f--)t[f][e]-=t[f][p]*c[p]}return c}([[u-=C,f-=S,0,0,x-y],[d-=C,_-=S,0,0,T-y],[0,0,u,f,E-m],[0,0,d,_,w-m]]);if(O){c.save(),c.beginPath();var b=(y+x+T)/3,P=(m+E+w)/3,I=lh(b,P,y,m),R=lh(b,P,x,E),L=lh(b,P,T,w);c.moveTo(R[0],R[1]),c.lineTo(I[0],I[1]),c.lineTo(L[0],L[1]),c.clip(),c.transform(O[0],O[2],O[1],O[3],y,m),c.translate(p[0]-C,p[3]-S),c.scale(n/i,-n/i),c.drawImage(g.canvas,0,0),c.restore()}})),u&&(c.save(),c.strokeStyle="black",c.lineWidth=1,a.getTriangles().forEach((function(t,e,i){var n=t.target,o=(n[0][0]-v[0])/r,s=-(n[0][1]-v[1])/r,a=(n[1][0]-v[0])/r,l=-(n[1][1]-v[1])/r,h=(n[2][0]-v[0])/r,u=-(n[2][1]-v[1])/r;c.beginPath(),c.moveTo(a,l),c.lineTo(o,s),c.lineTo(h,u),c.closePath(),c.stroke()})),c.restore()),c.canvas}var uh=10,ch=function(){function t(t,e,i,n,o){this.sourceProj_=t,this.targetProj_=e;var r={},s=_e(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return r[e]||(r[e]=s(t)),r[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&kt(n)==kt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?kt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?kt(this.targetProj_.getExtent()):null;var a=At(i),l=Dt(i),h=Pt(i),u=bt(i),c=this.transformInv_(a),p=this.transformInv_(l),f=this.transformInv_(h),d=this.transformInv_(u);if(this.addQuad_(a,l,h,u,c,p,f,d,uh),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach((function(t,e,i){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-g>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-g>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-g>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}r={}}return t.prototype.addTriangle_=function(t,e,i,n,o,r){this.triangles_.push({source:[n,o,r],target:[t,e,i]})},t.prototype.addQuad_=function(t,e,i,n,o,r,s,a,l){var h=at([o,r,s,a]),u=this.sourceWorldWidth_?kt(h)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&u>.5&&u<1,f=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)f=kt(at([t,e,i,n]))/this.targetWorldWidth_>.25||f;!p&&this.sourceProj_.isGlobal()&&u&&(f=u>.25||f)}if(f||!this.maxSourceExtent_||Nt(h,this.maxSourceExtent_)){if(!(f||isFinite(o[0])&&isFinite(o[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(l>0))return;f=!0}if(l>0){if(!f){var d=[(t[0]+i[0])/2,(t[1]+i[1])/2],g=this.transformInv_(d),_=void 0;if(p)_=(J(o[0],c)+J(s[0],c))/2-J(g[0],c);else _=(o[0]+s[0])/2-g[0];var v=(o[1]+s[1])/2-g[1];f=_*_+v*v>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var y=[(e[0]+i[0])/2,(e[1]+i[1])/2],m=this.transformInv_(y),x=[(n[0]+t[0])/2,(n[1]+t[1])/2],E=this.transformInv_(x);this.addQuad_(t,e,y,x,o,r,m,E,l-1),this.addQuad_(x,y,i,n,E,m,s,a,l-1)}else{var T=[(t[0]+e[0])/2,(t[1]+e[1])/2],w=this.transformInv_(T),C=[(i[0]+n[0])/2,(i[1]+n[1])/2],S=this.transformInv_(C);this.addQuad_(t,T,C,n,o,w,S,a,l-1),this.addQuad_(T,e,i,C,w,r,s,S,l-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,o,s,a),this.addTriangle_(t,e,i,o,r,s)}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){var o=e.source;wt(t,o[0]),wt(t,o[1]),wt(t,o[2])})),t},t.prototype.getTriangles=function(){return this.triangles_},t}(),ph=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fh=function(t){function e(e,i,n,o,r,s,a,l,h,u,c){var p=t.call(this,r,di.IDLE)||this;p.renderEdges_=void 0!==c&&c,p.pixelRatio_=a,p.gutter_=l,p.canvas_=null,p.sourceTileGrid_=i,p.targetTileGrid_=o,p.wrappedTileCoord_=s||r,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0;var f=o.getTileCoordExtent(p.wrappedTileCoord_),d=p.targetTileGrid_.getExtent(),g=p.sourceTileGrid_.getExtent(),_=d?Ft(f,d):f;if(0===Ot(_))return p.state=di.EMPTY,p;var v=e.getExtent();v&&(g=g?Ft(g,v):v);var y=o.getResolution(p.wrappedTileCoord_[0]),m=function(t,e,i,n){var o=ve(i,e,t),r=ue(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(r*=s);var a=t.getMetersPerUnit();void 0!==a&&(r/=a);var l=t.getExtent();if(!l||ct(l,o)){var h=ue(t,r,o)/r;isFinite(h)&&h>0&&(r/=h)}return r}(e,n,It(_),y);if(!isFinite(m)||m<=0)return p.state=di.EMPTY,p;var x=void 0!==u?u:Jl;if(p.triangulation_=new ch(e,n,_,g,m*x),0===p.triangulation_.getTriangles().length)return p.state=di.EMPTY,p;p.sourceZ_=i.getZForResolution(m);var E=p.triangulation_.calculateSourceExtent();if(g&&(e.canWrapX()?(E[1]=Z(E[1],g[1],g[3]),E[3]=Z(E[3],g[1],g[3])):E=Ft(E,g)),Ot(E)){for(var T=i.getTileRangeForExtentAndZ(E,p.sourceZ_),w=T.minX;w<=T.maxX;w++)for(var C=T.minY;C<=T.maxY;C++){var S=h(p.sourceZ_,w,C,a);S&&p.sourceTiles_.push(S)}0===p.sourceTiles_.length&&(p.state=di.EMPTY)}else p.state=di.EMPTY;return p}return ph(e,t),e.prototype.disposeInternal=function(){this.state==di.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==di.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=di.ERROR;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],o="number"==typeof i?i:i[1],r=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=hh(n,o,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),r,a,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=di.LOADED}this.changed()},e.prototype.load=function(){if(this.state==di.IDLE){this.state=di.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var o=e.getState();if(o==di.IDLE||o==di.LOADING){t++;var r=x(e,P.CHANGE,(function(i){var n=e.getState();n!=di.LOADED&&n!=di.ERROR&&n!=di.EMPTY||(T(r),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(r)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,i){t.getState()==di.IDLE&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(T),this.sourcesListenerKeys_=null},e}($l);function dh(t,e){var i=/\{z\}/g,n=/\{x\}/g,o=/\{y\}/g,r=/\{-y\}/g;return function(s,a,l){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(o,s[2].toString()).replace(r,(function(){var t=s[0],i=e.getFullTileRange(t);return ot(i,55),(i.getHeight()-s[2]-1).toString()})):void 0}}function gh(t,e){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=dh(t[o],e);return function(t){if(1===t.length)return t[0];return(function(e,i,n){if(e){var o=J(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[o](e,i,n)}})}(n)}function _h(t,e,i){}var vh=[0,0,0],yh=function(){function t(t){var i,n,o,r;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,ot((i=this.resolutions_,n=!0,o=function(t,e){return e-t}||e,i.every((function(t,e){if(0===e)return!0;var r=o(i[e-1],t);return!(r>0||n&&0===r)}))),17),!t.origins)for(var s=0,a=this.resolutions_.length-1;s<a;++s)if(r){if(this.resolutions_[s]/this.resolutions_[s+1]!==r){r=void 0;break}}else r=this.resolutions_[s]/this.resolutions_[s+1];this.zoomFactor_=r,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,ot(this.origins_.length==this.resolutions_.length,20));var l=t.extent;void 0===l||this.origin_||this.origins_||(this.origin_=At(l)),ot(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,ot(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:mi,ot(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==l?l:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new Gl(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):l&&this.calculateTileRanges_(l)}return t.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),o=n.minX,r=n.maxX;o<=r;++o)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,o,s])},t.prototype.forEachTileCoordParentTileRange=function(t,e,i,n){var o,r,s=null,a=t[0]-1;for(2===this.zoomFactor_?(o=t[1],r=t[2]):s=this.getTileCoordExtent(t,n);a>=this.minZoom;){if(e(a,2===this.zoomFactor_?jl(o=Math.floor(o/2),o,r=Math.floor(r/2),r,i):this.getTileRangeForExtentAndZ(s,a,i)))return!0;--a}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],o=2*t[2];return jl(n,n+1,o,o+1,e)}var r=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null},t.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),o=this.getResolution(t),r=Jn(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*r[0]*o,a=n[0]+(e.maxX+1)*r[0]*o;return _t(s,n[1]+e.minY*r[1]*o,a,n[1]+(e.maxY+1)*r[1]*o,i)},t.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=vh;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var o=n[1],r=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),jl(o,n[1],r,n[2],i)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Jn(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]},t.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),o=Jn(this.getTileSize(t[0]),this.tmpSize_),r=i[0]+t[1]*o[0]*n,s=i[1]-(t[2]+1)*o[1]*n;return _t(r,s,r+o[0]*n,s+o[1]*n,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,o){var r=this.getZForResolution(i),s=i/this.getResolution(r),a=this.getOrigin(r),l=Jn(this.getTileSize(r),this.tmpSize_),h=n?.5:0,u=n?.5:0,c=Math.floor((t-a[0])/i+h),p=Math.floor((a[1]-e)/i+u),f=s*c/l[0],d=s*p/l[1];return n?(f=Math.ceil(f)-1,d=Math.ceil(d)-1):(f=Math.floor(f),d=Math.floor(d)),nh(r,f,d,o)},t.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,o){var r=this.getOrigin(i),s=this.getResolution(i),a=Jn(this.getTileSize(i),this.tmpSize_),l=n?.5:0,h=n?.5:0,u=Math.floor((t-r[0])/s+l),c=Math.floor((r[1]-e)/s+h),p=u/a[0],f=c/a[1];return n?(p=Math.ceil(p)-1,f=Math.ceil(f)-1):(p=Math.floor(p),f=Math.floor(f)),nh(i,p,f,o)},t.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},t.prototype.getZForResolution=function(t,e){return Z(i(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i},t}();function mh(t){var e=t.getDefaultTileGrid();return e||(e=Th(t),t.setDefaultTileGrid(e)),e}function xh(t){var e=t||{},i=e.extent||he("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Eh(i,e.maxZoom,e.tileSize)};return new yh(n)}function Eh(t,e,i){for(var n=void 0!==e?e:yi,o=Mt(t),r=kt(t),s=Jn(void 0!==i?i:mi),a=Math.max(r/s[0],o/s[1]),l=n+1,h=new Array(l),u=0;u<l;++u)h[u]=a/Math.pow(2,u);return h}function Th(t,e,i,n){return function(t,e,i,n){var o=void 0!==n?n:rt.TOP_LEFT,r=Eh(t,e,i);return new yh({extent:t,origin:Rt(t,o),resolutions:r,tileSize:i})}(wh(t),e,i,n)}function wh(t){var e=(t=he(t)).getExtent();if(!e){var i=180*Yt[Xt.DEGREES]/t.getMetersPerUnit();e=_t(-i,-i,i,i)}return e}var Ch=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sh=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;i.opaque_=void 0!==e.opaque&&e.opaque,i.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,i.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;var n=e.cacheSize;if(void 0===n){var o=[256,256],r=e.tileGrid;r&&Jn(r.getTileSize(r.getMinZoom()),o);var s="undefined"!=typeof screen,a=s?screen.availWidth||screen.width:1920,l=s?screen.availHeight||screen.height:1080;n=4*Math.ceil(a/o[0])*Math.ceil(l/o[1])}return i.tileCache=new ah(n),i.tmpSize=[0,0],i.key_=e.key||"",i.tileOptions={transition:e.transition},i.zDirection=e.zDirection?e.zDirection:0,i}return Ch(e,t),e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var o=this.getTileCacheForProjection(t);if(!o)return!1;for(var r,s,a,l=!0,h=i.minX;h<=i.maxX;++h)for(var u=i.minY;u<=i.maxY;++u)s=oh(e,h,u),a=!1,o.containsKey(s)&&(a=(r=o.get(s)).getState()===di.LOADED)&&(a=!1!==n(r)),a||(l=!1);return l},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,o){return p()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:mh(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!de(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n,o,r,s=this.getTileGridForProjection(i),a=this.getTilePixelRatio(e),l=Jn(s.getTileSize(t),this.tmpSize);return 1==a?l:(n=l,o=a,void 0===(r=this.tmpSize)&&(r=[0,0]),r[0]=n[0]*o+.5|0,r[1]=n[1]*o+.5|0,r)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],o=t.getTileCoordCenter(e),r=wh(i);if(ct(r,o))return e;var s=kt(r),a=Math.ceil((r[0]-o[0])/s);return o[0]+=s*a,t.getTileCoordForCoordAndZ(o,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],o=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var r,s=e.getExtent();return!(r=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||r.containsXY(n,o)}(t,n)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},e.prototype.useTile=function(t,e,i,n){},e}(tl),Oh=function(t){function e(e,i){var n=t.call(this,e)||this;return n.tile=i,n}return Ch(e,t),e}(S),bh="tileloadstart",Ph="tileloadend",Ih="tileloaderror",Rh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Lh=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.generateTileUrlFunction_=!e.tileUrlFunction,i.tileLoadFunction=e.tileLoadFunction,i.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(i):_h,i.urls=null,e.urls?i.setUrls(e.urls):e.url&&i.setUrl(e.url),i.tileLoadingKeys_={},i}return Rh(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=d(i),o=i.getState();o==di.LOADING?(this.tileLoadingKeys_[n]=!0,e=bh):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=o==di.ERROR?Ih:o==di.LOADED||o==di.ABORT?Ph:void 0),null!=e&&this.dispatchEvent(new Oh(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=function(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n=i[1].charCodeAt(0),o=i[2].charCodeAt(0),r=void 0;for(r=n;r<=o;++r)e.push(t.replace(i[0],String.fromCharCode(r)));return e}if(i=i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}(t);this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(gh(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var n=oh(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(Sh),Mh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Fh=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Ah,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,i.tileClass=void 0!==e.tileClass?e.tileClass:eh,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i}return Mh(e,t),e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var o=this.tileCacheForProjection[n];o.expireCache(o==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!de(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!de(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!de(e,t)){var i=d(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=mh(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||de(e,t))return this.tileCache;var i=d(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new ah(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,n,o,r){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,o),l=a?this.tileUrlFunction(a,n,o):void 0,h=new this.tileClass(s,void 0!==l?di.IDLE:di.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=r,h.addEventListener(P.CHANGE,this.handleTileChange.bind(this)),h},e.prototype.getTile=function(t,e,i,n,o){var r=this.getProjection();if(r&&o&&!de(r,o)){var s=this.getTileCacheForProjection(o),a=[t,e,i],l=void 0,h=rh(a);s.containsKey(h)&&(l=s.get(h));var u=this.getKey();if(l&&l.key==u)return l;var c=this.getTileGridForProjection(r),p=this.getTileGridForProjection(o),f=this.getTileCoordForTileUrlFunction(a,o),d=new fh(r,c,o,p,a,f,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,r)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return d.key=u,l?(d.interimTile=l,d.refreshInterimChain(),s.replace(h,d)):s.set(h,d),d}return this.getTileInternal(t,e,i,n,r||o)},e.prototype.getTileInternal=function(t,e,i,n,o){var r=null,s=oh(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if((r=this.tileCache.get(s)).key!=a){var l=r;r=this.createTile_(t,e,i,n,o,a),l.getState()==di.IDLE?r.interimTile=l.interimTile:r.interimTile=l,r.refreshInterimChain(),this.tileCache.replace(s,r)}}else r=this.createTile_(t,e,i,n,o,a),this.tileCache.set(s,r);return r},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=he(t);if(i){var n=d(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(Lh);function Ah(t,e){t.getImage().src=e}var Dh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),kh=function(t){function e(e){var i=e||{},n=void 0!==i.projection?i.projection:"EPSG:3857",o=void 0!==i.tileGrid?i.tileGrid:xh({extent:wh(n),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});return t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:n,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this}return Dh(e,t),e}(Fh),Nh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Gh='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',jh=function(t){function e(e){var i,n=e||{};i=void 0!==n.attributions?n.attributions:[Gh];var o=void 0!==n.crossOrigin?n.crossOrigin:"anonymous",r=void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:i,cacheSize:n.cacheSize,crossOrigin:o,opaque:void 0===n.opaque||n.opaque,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:r,wrapX:n.wrapX,attributionsCollapsible:!1})||this}return Nh(e,t),e}(kh),Xh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Yh=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,{transition:0})||this;return a.context_={},a.executorGroups={},a.loadingSourceTiles=0,a.errorSourceTileKeys={},a.replayState_={},a.wantedResolution,a.getSourceTiles_=r,a.removeSourceTiles_=s,a.sourceTileGrid_=o,a.sourceTileListenerKeys=[],a.sourceZ=-1,a.hifi=!1,a.wrappedTileCoord=n,a}return Xh(e,t),e.prototype.disposeInternal=function(){for(var e in this.sourceTileListenerKeys.forEach(T),this.sourceTileListenerKeys.length=0,this.removeSourceTiles_(this),this.context_){var i=this.context_[e].canvas;i.width=i.height=0}for(var e in this.executorGroups)for(var n=this.executorGroups[e],o=0,r=n.length;o<r;++o)n[o].disposeInternal();this.setState(di.ABORT),t.prototype.disposeInternal.call(this)},e.prototype.getContext=function(t){var e=d(t);return e in this.context_||(this.context_[e]=k()),this.context_[e]},e.prototype.hasContext=function(t){return d(t)in this.context_},e.prototype.getImage=function(t){return this.hasContext(t)?this.getContext(t).canvas:null},e.prototype.getReplayState=function(t){var e=d(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedZ:-1,renderedTileZ:-1}),this.replayState_[e]},e.prototype.load=function(){this.getSourceTiles_(this)},e}($l),zh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bh=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,s)||this;return a.consumers=0,a.extent=null,a.format_=o,a.features_=null,a.loader_,a.projection=null,a.resolution,a.tileLoadFunction_=r,a.url_=n,a}return zh(e,t),e.prototype.disposeInternal=function(){this.setState(di.ABORT),t.prototype.disposeInternal.call(this)},e.prototype.getFormat=function(){return this.format_},e.prototype.getFeatures=function(){return this.features_},e.prototype.getKey=function(){return this.url_},e.prototype.load=function(){this.state==di.IDLE&&(this.setState(di.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_(this.extent,this.resolution,this.projection))},e.prototype.onLoad=function(t,e){this.setFeatures(t)},e.prototype.onError=function(){this.setState(di.ERROR)},e.prototype.setFeatures=function(t){this.features_=t,this.setState(di.LOADED)},e.prototype.setLoader=function(t){this.loader_=t},e}($l),Kh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wh=function(t){function e(e){var i=this,n=e.projection||"EPSG:3857",o=e.extent||wh(n),r=e.tileGrid||xh({extent:o,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});return(i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,opaque:!1,projection:n,state:e.state,tileGrid:r,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Zh,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection})||this).format_=e.format?e.format:null,i.loadingTiles_={},i.sourceTileByCoordKey_={},i.sourceTilesByTileKey_={},i.overlaps_=null==e.overlaps||e.overlaps,i.tileClass=e.tileClass?e.tileClass:Bh,i.tileGrids_={},i}return Kh(e,t),e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.clear=function(){this.tileCache.clear(),this.sourceTileByCoordKey_={},this.sourceTilesByTileKey_={}},e.prototype.getSourceTiles=function(t,e,i){var n=i.wrappedTileCoord,o=this.getTileGridForProjection(e),s=o.getTileCoordExtent(n),a=n[0],l=o.getResolution(a);lt(s,-l,s);var h=this.tileGrid,u=h.getExtent();u&&Ft(s,u,s);var c,p,f,d=h.getZForResolution(l,1),g=h.getMinZoom(),_=this.sourceTilesByTileKey_[i.getKey()];if(_&&_.length>0&&_[0].tileCoord[0]===d)c=_,p=!0,f=d;else{c=[],f=d+1;do{--f,p=!0,h.forEachTileCoord(s,f,function(n){var o,r=rh(n);if(r in this.sourceTileByCoordKey_){var s=(o=this.sourceTileByCoordKey_[r]).getState();if(s===di.LOADED||s===di.ERROR||s===di.EMPTY)return void c.push(o)}else if(f===d){var a=this.tileUrlFunction(n,t,e);void 0!==a&&((o=new this.tileClass(n,di.IDLE,a,this.format_,this.tileLoadFunction)).extent=h.getTileCoordExtent(n),o.projection=e,o.resolution=h.getResolution(n[0]),this.sourceTileByCoordKey_[r]=o,o.addEventListener(P.CHANGE,this.handleTileChange.bind(this)),o.load())}if(p=!1,o&&o.getState()!==di.EMPTY&&i.getState()===di.IDLE){i.loadingSourceTiles++;var l=x(o,P.CHANGE,(function(){var t,e,n,r=o.getState(),s=o.getKey();if(r===di.LOADED||r===di.ERROR){r===di.LOADED?(t=i.sourceTileListenerKeys,e=l,n=t.indexOf(e),n>-1&&t.splice(n,1),T(l),i.loadingSourceTiles--,delete i.errorSourceTileKeys[s]):r===di.ERROR&&(i.errorSourceTileKeys[s]=!0);var a=Object.keys(i.errorSourceTileKeys).length;i.loadingSourceTiles-a==0&&(i.hifi=0===a,i.sourceZ=d,i.setState(di.LOADED))}}));i.sourceTileListenerKeys.push(l)}}.bind(this)),p||(c.length=0)}while(!p&&f>g)}return i.getState()===di.IDLE&&i.setState(di.LOADING),p&&(i.hifi=d===f,i.sourceZ=f,i.getState()<di.LOADED?i.setState(di.LOADED):_&&r(c,_)||(this.removeSourceTiles(i),this.addSourceTiles(i,c))),c},e.prototype.addSourceTiles=function(t,e){this.sourceTilesByTileKey_[t.getKey()]=e;for(var i=0,n=e.length;i<n;++i)e[i].consumers++},e.prototype.removeSourceTiles=function(t){var e=t.getKey();if(e in this.sourceTilesByTileKey_)for(var i=this.sourceTilesByTileKey_[e],n=0,o=i.length;n<o;++n){var r=i[n];r.consumers--,0===r.consumers&&(r.dispose(),delete this.sourceTileByCoordKey_[rh(r.tileCoord)])}delete this.sourceTilesByTileKey_[e]},e.prototype.getTile=function(t,e,i,n,o){var r,s=oh(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)&&(r=this.tileCache.get(s)).key===a)return r;var l=[t,e,i],h=this.getTileCoordForTileUrlFunction(l,o),u=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(o);if(h&&u){var p=c.getTileCoordExtent(h);lt(p,-c.getResolution(t),p),Nt(u,p)||(h=null)}var f=!0;if(null!==h){var d=this.tileGrid,g=c.getResolution(t),_=d.getZForResolution(g,1),v=c.getTileCoordExtent(h);lt(v,-g,v),d.forEachTileCoord(v,_,function(t){f=f&&!this.tileUrlFunction(t,n,o)}.bind(this))}var y=new Yh(l,f?di.EMPTY:di.IDLE,h,this.tileGrid,this.getSourceTiles.bind(this,n,o),this.removeSourceTiles.bind(this));return y.key=a,r?(y.interimTile=r,y.refreshInterimChain(),this.tileCache.replace(s,y)):this.tileCache.set(s,y),y},e.prototype.getTileGridForProjection=function(t){var e=t.getCode(),i=this.tileGrids_[e];if(!i){var n=this.tileGrid;i=this.tileGrids_[e]=Th(t,void 0,n?n.getTileSize(n.getMinZoom()):void 0)}return i},e.prototype.getTilePixelRatio=function(t){return t},e.prototype.getTilePixelSize=function(t,e,i){var n=Jn(this.getTileGridForProjection(i).getTileSize(t),this.tmpSize);return[Math.round(n[0]*e),Math.round(n[1]*e)]},e}(Lh);function Zh(t,e){var i=function(t,e,i,n){return function(o,r,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(o,r,s):t,!0),e.getType()==Ja.ARRAY_BUFFER&&(a.responseType="arraybuffer"),a.withCredentials=Qa,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r=e.getType(),l=void 0;r==Ja.JSON||r==Ja.TEXT?l=a.responseText:r==Ja.XML?(l=a.responseXML)||(l=(new DOMParser).parseFromString(a.responseText,"application/xml")):r==Ja.ARRAY_BUFFER&&(l=a.response),l?i.call(this,e.readFeatures(l,{extent:o,featureProjection:s}),e.readProjection(l)):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}(e,t.getFormat(),t.onLoad.bind(t),t.onError.bind(t));t.setLoader(i)}const Vh=new Xe({popupClass:"default",closeBox:!0,positioning:"auto"}),Uh=(new class{constructor(){const t=new ms({color:"rgba(255,255,255,0.4)"}),e=new xs({color:"#FF6200",width:1.25});this.defaultStyle=[new Es({image:new ys({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}setFilter(t){this.text=t,this.invert=!1,t&&"!"===t[0]&&(t=t.substring(1),this.invert=!0),this.regex=new RegExp(t,"i")}setFromLocation(){if(URLSearchParams){const t=new URLSearchParams(location.search);t.has("filter")&&this.setFilter(t.get("filter"))}return this}updateLocation(){return history&&history.replaceState&&history.replaceState(void 0,document.title,(this.text?"?filter="+encodeURIComponent(this.text):"/")+location.hash),this}style(t){const e=t.getProperties();if(!(!!this.invert==!(!(e.title||"").match(this.regex)&&!(e.description||"").match(this.regex))))return this.defaultStyle}}).setFromLocation();let Hh;const qh=new nl({target:"map",view:function(){let t=8,e=[12.694,47.075];if(window.location.hash){const i=window.location.hash.replace("#map=","").split("/");3===i.length&&(t=parseInt(i[0],10),e=[parseFloat(i[1]),parseFloat(i[2])])}return new Yn({zoom:t,center:(i=e,ve(i,"EPSG:4326",void 0!==n?n:"EPSG:3857"))});var i,n}(),layers:[new Bl({source:new jh}),new ql({style:Uh.style.bind(Uh),source:Hh=new Wh({attributions:['<a href="https://github.com/simon04/bldrwnsch/" target="_blank">@simon04/bldrwnsch</a>','(<a href="https://github.com/simon04/bldrwnsch/blob/master/LICENSE" target="_blank">GPL v3</a>)'],format:new Il,maxZoom:10,url:"https://tools.wmflabs.org/bldrwnsch/Bilderwuensche.tiles/{z}/{x}/{y}.pbf"})})],overlays:[Vh]});qh.on("click",Qh.bind(void 0,!0)),qh.on("pointermove",Qh.bind(void 0,!1)),qh.on("moveend",function(t){const e=t.getView(),i=fe(e.getCenter()),n=e.getZoom()+"/"+Mi(i,"{x}/{y}",4);window.location.hash="#map="+n}.bind(void 0,qh));const Jh=document.getElementById("info");function Qh(t,e){const i=qh.getFeaturesAtPixel(e.pixel,{hitTolerance:13});if(!i||!i.length)return Jh.innerText="",void(Jh.style.opacity=0);const n=i[0].getProperties(),o="geo:"+Mi(fe(i[0].getGeometry().getFlatInteriorPoint()),"{y},{x}",6),r=[n.title,n.description,n.location,'<a href="'+o+'">'+o+"</a>"].filter((function(t,e,i){return t&&(0===e||t!==i[e-1])})).map((function(t,e){return 0===e?'<a href="https://de.wikipedia.org/wiki/'+t.replace(/ /g,"_")+'" target="_blank">'+t+"</a>":t})).join("<br>").replace(/_/g," ");Jh.innerHTML=r,Jh.style.opacity=1,t&&Vh.show(e.coordinate,r)}const $h=new Ie({label:"Auf der Karte suchen",placeholder:"Auf der Karte suchen",url:"https://tools.wmflabs.org/nominatim/search",position:!0});qh.addControl($h),$h.on("select",(function(t){qh.getView().animate({center:t.coordinate,zoom:Math.max(qh.getView().getZoom(),16)})}));const tu=new W({label:"Bilderwnsche filtern",placeholder:"Bilderwnsche filtern",className:"filter"});qh.addControl(tu),tu._input.value=Uh.text||"",tu.on("change:input",(function(t){Uh.setFilter(t.value),Hh.changed(),Uh.updateLocation()}))}();
//# sourceMappingURL=bldrwnsch.js.map
